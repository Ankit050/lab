(function(){var e,t,n;(function(r){function c(e,t){var n=t&&t.split("/"),r=o.map,i=r&&r["*"]||{},s,u,a,f,l,c,h,p,d,v;if(e&&e.charAt(0)==="."&&t){n=n.slice(0,n.length-1),e=n.concat(e.split("/"));for(p=0;v=e[p];p++)if(v===".")e.splice(p,1),p-=1;else if(v===".."){if(p===1&&(e[2]===".."||e[0]===".."))return!0;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}if((n||i)&&r){s=e.split("/");for(p=s.length;p>0;p-=1){u=s.slice(0,p).join("/");if(n)for(d=n.length;d>0;d-=1){a=r[n.slice(0,d).join("/")];if(a){a=a[u];if(a){f=a,l=p;break}}}if(f)break;!c&&i&&i[u]&&(c=i[u],h=p)}!f&&c&&(f=c,l=h),f&&(s.splice(0,l,f),e=s.join("/"))}return e}function h(e,t){return function(){return l.apply(r,a.call(arguments,0).concat([e,t]))}}function p(e){return function(t){return c(t,e)}}function d(e){return function(t){i[e]=t}}function v(e){if(s.hasOwnProperty(e)){var t=s[e];delete s[e],u[e]=!0,f.apply(r,t)}if(!i.hasOwnProperty(e))throw new Error("No "+e);return i[e]}function m(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=c(e.slice(0,i),t),e=e.slice(i+1),r=v(n),r&&r.normalize?e=r.normalize(e,p(t)):e=c(e,t)):e=c(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function g(e){return function(){return o&&o.config&&o.config[e]||{}}}var i={},s={},o={},u={},a=[].slice,f,l;f=function(e,t,n,o){var a=[],f,l,c,p,y,b;o=o||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(b=0;b<t.length;b++){y=m(t[b],o),c=y.f;if(c==="require")a[b]=h(e);else if(c==="exports")a[b]=i[e]={},f=!0;else if(c==="module")l=a[b]={id:e,uri:"",exports:i[e],config:g(e)};else if(i.hasOwnProperty(c)||s.hasOwnProperty(c))a[b]=v(c);else if(y.p)y.p.load(y.n,h(o,!0),d(c),{}),a[b]=i[c];else if(!u[c])throw new Error(e+" missing "+c)}p=n.apply(i[e],a);if(e)if(l&&l.exports!==r&&l.exports!==i[e])i[e]=l.exports;else if(p!==r||!f)i[e]=p}else e&&(i[e]=n)},e=t=l=function(e,t,n,i){return typeof e=="string"?v(m(e,t).f):(e.splice||(o=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},i?f(r,e,t,n):setTimeout(function(){f(r,e,t,n)},15),l)},l.config=function(e){return o=e,l},n=function(e,t,n){t.splice||(n=t,t=[]),s[e]=[e,t,n]},n.amd={jQuery:!0}})(),n("../vendor/almond/almond",function(){}),n("common/console",["require"],function(e){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){})}),n("arrays/index",["require","exports","module"],function(e,t,n){var r={},i=function(){var e=/ AppleWebKit\/([0123456789.+]+) \(KHTML, like Gecko\) Version\/([0123456789.]+) (Safari)\/([0123456789.]+)/,t=navigator.userAgent.match(e);return t&&t[3]?!1:!0}();r.version="0.0.1",r.webgl=typeof window!="undefined"&&!!window.WebGLRenderingContext,r.typed=function(){try{return new Float64Array(0),!0}catch(e){return!1}}(),r.create=function(e,t,n){n||(r.webgl||r.typed?n="Float32Array":n="regular"),t===undefined&&(t=0);var i,s;if(n==="regular")i=new Array(e);else switch(n){case"Float64Array":i=new Float64Array(e);break;case"Float32Array":i=new Float32Array(e);break;case"Int32Array":i=new Int32Array(e);break;case"Int16Array":i=new Int16Array(e);break;case"Int8Array":i=new Int8Array(e);break;case"Uint32Array":i=new Uint32Array(e);break;case"Uint16Array":i=new Uint16Array(e);break;case"Uint8Array":i=new Uint8Array(e);break;case"Uint8ClampedArray":i=new Uint8ClampedArray(e);break;default:throw new Error("arrays: couldn't understand array type \""+n+'".')}s=-1;while(++s<e)i[s]=t;return i},r.constructor_function=function(e){if(e.buffer&&e.buffer.__proto__&&e.buffer.__proto__.constructor)return e.__proto__.constructor;switch(e.constructor){case Array:return Array;case Float32Array:return Float32Array;case Uint8Array:return Uint8Array;case Float64Array:return Float64Array;case Int32Array:return Int32Array;case Int16Array:return Int16Array;case Int8Array:return Int8Array;case Uint32Array:return Uint32Array;case Uint16Array:return Uint16Array;case Uint8ClampedArray:return Uint8ClampedArray;default:throw new Error("arrays.constructor_function: must be an Array or Typed Array:   source: "+e)}},r.copy=function(e,t){var n=e.length,i=-1;while(++i<n)t[i]=e[i];return r.constructor_function(t)===Array&&(t.length=n),t},r.clone=function(e){var t,n=e.length,i,s;s=r.constructor_function(e);if(s===Array){i=new s(n);for(t=0;t<n;t++)i[t]=e[t];return i}if(e.buffer.slice)return i=new s(e.buffer.slice(0)),i;i=new s(n);for(t=0;t<n;t++)i[t]=e[t];return i},r.between=function(e,t,n){return n<Math.max(e,t)&&n>Math.min(e,t)},r.max=function(e){return Math.max.apply(Math,e)},r.min=function(e){return Math.min.apply(Math,e)},r.maxTypedArray=function(e){var t,n,r=Number.MIN_VALUE,i=e.length;for(n=0;n<i;n++)t=e[n],r=t>r?t:r;return r},r.minTypedArray=function(e){var t,n,r=Number.MAX_VALUE,i=e.length;for(n=0;n<i;n++)t=e[n],r=t<r?t:r;return r},r.maxAnyArray=function(e){try{return Math.max.apply(Math,e)}catch(t){if(t instanceof TypeError){var n,r,i=Number.MIN_VALUE,s=e.length;for(r=0;r<s;r++)n=e[r],i=n>i?n:i;return i}}},r.minAnyArray=function(e){try{return Math.min.apply(Math,e)}catch(t){if(t instanceof TypeError){var n,r,i=Number.MAX_VALUE,s=e.length;for(r=0;r<s;r++)n=e[r],i=n<i?n:i;return i}}},r.average=function(e){var t,n=0,r=e.length;for(t=0;t<r;t++)n+=e[t];return n/r},r.extend=function(e,t){var n,i,s,o;return o=r.constructor_function(e),o===Array?(e.length=t,e):(s=new o(t),s.set(e.subarray(0,t)),s)};for(var s in r)r.hasOwnProperty(s)&&(t[s]=r[s])}),n("arrays",["arrays/index"],function(e){return e}),n("md2d/models/engine/constants/units",["require","exports","module"],function(e,t,n){var r=1.66054e-27,i=1.602177e-19,s=i,o=1e-15,u=1e-9,a=10,f=1e3,l={TIME:"time",LENGTH:"length",MASS:"mass",ENERGY:"energy",ENTROPY:"entropy",CHARGE:"charge",INVERSE_QUANTITY:"inverse quantity",FARADS_PER_METER:"farads per meter",METERS_PER_FARAD:"meters per farad",FORCE:"force",VELOCITY:"velocity",AREA:"area",PRESSURE:"pressure"},c,h,p;t.unit=c={FEMTOSECOND:{name:"femtosecond",value:1,type:l.TIME},SECOND:{name:"second",value:o,type:l.TIME},NANOMETER:{name:"nanometer",value:1,type:l.LENGTH},ANGSTROM:{name:"Angstrom",value:1*a,type:l.LENGTH},METER:{name:"meter",value:1*u,type:l.LENGTH},DALTON:{name:"Dalton",value:1,type:l.MASS},GRAM:{name:"gram",value:1*r*f,type:l.MASS},KILOGRAM:{name:"kilogram",value:1*r,type:l.MASS},MW_ENERGY_UNIT:{name:"MW Energy Unit (Dalton * nm^2 / fs^2)",value:1,type:l.ENERGY},JOULE:{name:"Joule",value:r*u*u*(1/o)*(1/o),type:l.ENERGY},EV:{name:"electron volt",value:r*u*u*(1/o)*(1/o)*(1/s),type:l.ENERGY},EV_PER_KELVIN:{name:"electron volts per Kelvin",value:1,type:l.ENTROPY},JOULES_PER_KELVIN:{name:"Joules per Kelvin",value:1*s,type:l.ENTROPY},ELEMENTARY_CHARGE:{name:"elementary charge",value:1,type:l.CHARGE},COULOMB:{name:"Coulomb",value:i,type:l.CHARGE},INVERSE_MOLE:{name:"inverse moles",value:1,type:l.INVERSE_QUANTITY},FARADS_PER_METER:{name:"Farads per meter",value:1,type:l.FARADS_PER_METER},METERS_PER_FARAD:{name:"meters per Farad",value:1,type:l.METERS_PER_FARAD},MW_FORCE_UNIT:{name:"MW force units (Dalton * nm / fs^2)",value:1,type:l.FORCE},NEWTON:{name:"Newton",value:1*r*u*(1/o)*(1/o),type:l.FORCE},EV_PER_NM:{name:"electron volts per nanometer",value:1*r*u*u*(1/o)*(1/o)*(1/s),type:l.FORCE},MW_VELOCITY_UNIT:{name:"MW velocity units (nm / fs)",value:1,type:l.VELOCITY},METERS_PER_SECOND:{name:"meters per second",value:1*u*(1/o),type:l.VELOCITY}},t.ratio=h=function(e,t){var n=function(e,t){if(e.type!==t.type)throw new Error("Attempt to convert incompatible type '"+e.name+"'' to '"+t.name+"'")};if(t.per)return n(e,t.per),e.value/t.per.value;if(t.as)return n(e,t.as),t.as.value/e.value;throw new Error("units.ratio() received arguments it couldn't understand.")},t.convert=p=function(e,t){var n=t&&t.from,r=t&&t.to;if(!n)throw new Error('units.convert() did not receive a "from" argument');if(!r)throw new Error('units.convert() did not receive a "to" argument');return e*h(r,{per:n})}}),n("md2d/models/engine/constants/index",["require","exports","module","./units"],function(e,t,n){var r=e("./units"),i=r.unit,s=r.ratio,o=r.convert,u={ELEMENTARY_CHARGE:{value:1,unit:i.ELEMENTARY_CHARGE},ATOMIC_MASS:{value:1,unit:i.DALTON},BOLTZMANN_CONSTANT:{value:1.380658e-23,unit:i.JOULES_PER_KELVIN},AVAGADRO_CONSTANT:{value:s(i.DALTON,{per:i.GRAM}),unit:i.INVERSE_MOLE},PERMITTIVITY_OF_FREE_SPACE:{value:8.854187e-12,unit:i.FARADS_PER_METER}},a,f;u.COULOMB_CONSTANT={value:1/(4*Math.PI*u.PERMITTIVITY_OF_FREE_SPACE.value),unit:i.METERS_PER_FARAD},t.unit=i,t.ratio=s,t.convert=o;for(a in u)u.hasOwnProperty(a)&&(f=u[a],t[a]=function(e){return{as:function(t){return r.convert(e.value,{from:e.unit,to:t})}}}(f))}),n("md2d/models/engine/math/distributions",["require","exports","module"],function(e,t,n){t.normal=function(){var e=null;return function(t,n){t==null&&(t=0),n==null&&(n=1);var r,i,s,o,u;return e?(i=e,e=null,i):(o=Math.random(),u=Math.random(),s=2*Math.PI*o,r=Math.sqrt(-2*Math.log(u)),e=t+n*r*Math.sin(s),t+n*r*Math.cos(s))}}()}),n("md2d/models/engine/math/utils",["require","exports","module"],function(e,t,n){t.getWindowedAverager=function(e){e==null&&(e=1e3);var t=0,n=[],r=0;return function(s){return r-=n[t]||0,r+=s,n[t]=s,++t===e&&(t=0),n.length===e?r/e:NaN}}}),n("md2d/models/engine/math/minimizer",["require","exports","module"],function(e,t,n){t.minimize=function(e,t,n){n=n||{},n.precision==null&&(n.precision=.01);var r=n.precision,i=n.bounds,s=n.maxiter||1e3,o=n.stopval||-Infinity,u=n.maxstep||.01,a=n.eps||.01,f=t.length,l,c,h,p,d,v,m,g,y,b;v=u*u,l=[];for(y=0;y<f;y++)l[y]=t[y];c=e.apply(null,l),h=c[0],d=c[1],g=0;do{if(h<=o)break;if(g>s)return console.log("maxiter reached"),{error:"maxiter reached",f:h,iter:s,x:l};m=0;for(y=0;y<f;y++)m+=d[y]*d[y];if(a*a*m>v){b=Math.sqrt(v/m)/a;for(y=0;y<f;y++)d[y]=b*d[y]}for(y=0;y<f;y++)l[y]-=a*d[y],i&&l[y]<i[y][0]&&(l[y]=i[y][0]),i&&l[y]>i[y][1]&&(l[y]=i[y][1]);p=h,c=e.apply(null,l),h=c[0],d=c[1],g++}while(Math.abs(h-p)>r);return[h,l]}}),n("md2d/models/engine/math/index",["require","exports","module","./distributions","./utils","./minimizer"],function(e,t,n){t.normal=e("./distributions").normal,t.getWindowedAverager=e("./utils").getWindowedAverager,t.minimize=e("./minimizer").minimize}),n("md2d/models/engine/potentials/coulomb",["require","exports","module","../constants/index"],function(e,t,n){var r=e("../constants/index"),i=r.unit,s=.346,o=r.COULOMB_CONSTANT.as(r.unit.METERS_PER_FARAD),u=r.ratio(i.NANOMETER,{per:i.METER}),a=Math.pow(r.ratio(i.COULOMB,{per:i.ELEMENTARY_CHARGE}),2),f=r.ratio(i.EV,{per:i.JOULE}),l=r.ratio(i.MW_FORCE_UNIT,{per:i.NEWTON}),c=s*o*a*u*f,h=s*o*a*u*u*l,p=t.potential=function(e,t,n){return c*(t*n/e)},d=t.forceFromSquaredDistance=function(e,t,n){return-h*(t*n/e)},v=t.forceOverDistanceFromSquaredDistance=function(e,t,n){return d(e,t,n)/Math.sqrt(e)},m=t.force=function(e,t,n){return d(e*e,t,n)}}),n("md2d/models/engine/potentials/lennard-jones",["require","exports","module","../constants/index"],function(e,t,n){var r=e("../constants/index"),i=r.unit,s=r.ratio(i.NANOMETER,{per:i.METER}),o=r.ratio(i.MW_FORCE_UNIT,{per:i.NEWTON});t.pairwiseEpsilon=function(e,t){return.5*(e+t)},t.pairwiseSigma=function(e,t){return Math.sqrt(e*t)},t.rmin=function(e){return Math.pow(2,1/6)*e},t.radius=function(e){return.5*e},t.newLJCalculator=function(e,n){var u,a,f,l,c,h,p,d=!1,v=function(e,v){u=e,a=v,f=t.rmin(a),u!=null&&a!=null&&(l=4*u*Math.pow(a,12),c=4*u*Math.pow(a,6),h=12*r.convert(l,{from:i.EV,to:i.JOULE})*s*o,p=6*r.convert(c,{from:i.EV,to:i.JOULE})*s*o),d&&typeof n=="function"&&n(m(),this)},m=function(){return{epsilon:u,sigma:a,rmin:f}},g=function(e){if(e==null||parseFloat(e)!==e)throw new Error("lennardJones: epsilon value "+e+" is invalid")},y=function(e){if(e==null||parseFloat(e)!==e||e<=0)throw new Error("lennardJones: sigma value "+e+" is invalid")},b;return g(e.epsilon),y(e.sigma),v(e.epsilon,e.sigma),d=!0,b={getCoefficients:m,setEpsilon:function(e){g(e),v(e,a)},setSigma:function(e){y(e),v(u,e)},potentialFromSquaredDistance:function(e){return e?l*Math.pow(e,-6)-c*Math.pow(e,-3):-Infinity},potential:function(e){return b.potentialFromSquaredDistance(e*e)},forceOverDistanceFromSquaredDistance:function(e){var t=1/e,n=t*t*t,r=n*t,i=r*n;return h*i-p*r},force:function(e){return e*b.forceOverDistanceFromSquaredDistance(e*e)}}}}),n("md2d/models/engine/potentials/index",["require","exports","module","./coulomb","./lennard-jones"],function(e,t,n){var r=t.potentials={};t.coulomb=e("./coulomb"),t.lennardJones=e("./lennard-jones")}),n("md2d/models/engine/md2d",["require","exports","module","common/console","arrays","./constants/index","./math/index","./potentials/index","./potentials/index"],function(e,t,n){e("common/console");var r=e("arrays"),i=e("./constants/index"),s=i.unit,o=e("./math/index"),u=e("./potentials/index").coulomb,a=e("./potentials/index").lennardJones,f=function(){var e=/ AppleWebKit\/([0123456789.+]+) \(KHTML, like Gecko\) Version\/([0123456789.]+) (Safari)\/([0123456789.]+)/,t=navigator.userAgent.match(e);return!t||!t[3]}(),l=r.typed&&f?"Float32Array":"regular",c=r.typed&&f?"Uint16Array":"regular",h=r.typed&&f?"Uint8Array":"regular",p=1,d=1e3,v=-120*i.BOLTZMANN_CONSTANT.as(s.EV_PER_KELVIN),m=.34,g=39.95,y=i.convert(g,{from:s.DALTON,to:s.KILOGRAM}),b=i.BOLTZMANN_CONSTANT.as(s.JOULES_PER_KELVIN),w,E,S,x,T,N,C,k,L,A,O,M=function(e,t,n,r){return e*r-t*n},_=function(e,t){return e*e+t*t},D=function(e,t){var n=2*t,r=2/n*e,o=i.convert(r,{from:s.MW_ENERGY_UNIT,to:s.JOULE});return o/b},P=function(e,t){var n=2*t,r=e*b,o=i.convert(r,{from:s.JOULE,to:s.MW_ENERGY_UNIT}),u=o*n/2;return u},H=function(e){var t=parseFloat(e);if(isNaN(t))throw new Error("md2d: requested temperature "+e+" could not be understood.");if(t<0)throw new Error("md2d: requested temperature "+t+" was less than zero");if(t===Infinity)throw new Error("md2d: requested temperature was Infinity!")};t.ATOM_PROPERTY_LIST=E=["RADIUS","PX","PY","X","Y","VX","VY","SPEED","AX","AY","CHARGE","ELEMENT","PINNED","FRICTION","MASS"],t.ATOM_INDICES=S={},function(){for(var e=0;e<E.length;e++)t.ATOM_INDICES[E[e]]=e}(),t.RADIAL_BOND_PROPERTY_LIST=N=["ATOM1","ATOM2","LENGTH","STRENGTH","STYLE"],t.RADIAL_BOND_INDICES=C={},function(){for(var e=0;e<N.length;e++)t.RADIAL_BOND_INDICES[N[e]]=e}(),t.ANGULAR_BOND_PROPERTY_LIST=k=["ATOM1","ATOM2","ATOM3","ANGLE","STRENGTH"],t.ANGULAR_BOND_INDICES=L={},function(){for(var e=0;e<k.length;e++)t.ANGULAR_BOND_INDICES[k[e]]=e}(),t.RADIAL_BOND_STYLES=RADIAL_BOND_STYLES={RADIAL_BOND_STANDARD_STICK_STYLE:101,RADIAL_BOND_LONG_SPRING_STYLE:102,RADIAL_BOND_SOLID_LINE_STYLE:103,RADIAL_BOND_GHOST_STYLE:104,RADIAL_BOND_UNICOLOR_STICK_STYLE:105,RADIAL_BOND_SHORT_SPRING_STYLE:106,RADIAL_BOND_DOUBLE_BOND_STYLE:107,RADIAL_BOND_TRIPLE_BOND_STYLE:108},t.ELEMENT_PROPERTY_LIST=x=["MASS","EPSILON","SIGMA","RADIUS"],t.ELEMENT_INDICES=T={},function(){for(var e=0;e<x.length;e++)t.ELEMENT_INDICES[x[e]]=e}(),t.OBSTACLE_INDICES=A={X:0,Y:1,WIDTH:2,HEIGHT:3,MASS:4,VX:5,VY:6,X_PREV:7,Y_PREV:8,COLOR_R:9,COLOR_G:10,COLOR_B:11,VISIBLE:12},t.VDW_INDICES=O={COUNT:0,ATOM1:1,ATOM2:2},t.DEFAULT_VALUES=w={CHARGE:0,FRICTION:0,PINNED:0,RADIAL_BOND_STYLE:RADIAL_BOND_STYLES.RADIAL_BOND_STANDARD_STICK_STYLE},t.createEngine=function(){var e,t=!1,n=!1,f=!1,v=!1,m=!1,g=!0,y=!1,b=!1,x=!1,N,k=.001,P=[10,10],B,j=50,F=0,I=1,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct=function(){var e=0,t;for(t in C)C.hasOwnProperty(t)&&e++;return e}(),ht,pt,dt,vt=0,mt,gt,yt,bt,wt,Et=function(){var e=0,t;for(t in L)L.hasOwnProperty(t)&&e++;return e}(),St,xt=0,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt=0,Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt=0,Kt,Qt,Gt,Yt,Zt,en,tn,nn,rn,sn,on=[],un=[],an=5,fn=[],ln=[],cn=function(){throw new Error("md2d: Don't change the epsilon or sigma parameters of the LJ calculator being used by MD2D. Use the setElementProperties method instead.")},hn=function(e,t){var n=z[e][T.EPSILON],r=z[t][T.EPSILON],i=z[e][T.SIGMA],s=z[t][T.SIGMA],o,u;o=on[e][t]=on[t][e]=a.pairwiseEpsilon(n,r),u=un[e][t]=un[t][e]=a.pairwiseSigma(i,s),fn[e][t]=fn[t][e]=an*u*an*u,ln[e][t]=ln[t][e]=a.newLJCalculator({epsilon:o,sigma:u},cn)},pn=function(e,t){for(var n=0,i=e.length;n<i;n++)e[n]=r.extend(e[n],t)},dn={atoms:function(){W=e.radius=st[S.RADIUS],X=e.px=st[S.PX],V=e.py=st[S.PY],$=e.x=st[S.X],J=e.y=st[S.Y],K=e.vx=st[S.VX],Q=e.vy=st[S.VY],G=e.speed=st[S.SPEED],Y=e.ax=st[S.AX],Z=e.ay=st[S.AY],et=e.charge=st[S.CHARGE],nt=e.friction=st[S.FRICTION],tt=e.element=st[S.ELEMENT],rt=e.pinned=st[S.PINNED],it=e.mass=st[S.MASS]},radialBonds:function(){ot=pt[C.ATOM1],ut=pt[C.ATOM2],at=pt[C.LENGTH],ft=pt[C.STRENGTH],lt=pt[C.STYLE]},angularBonds:function(){mt=St[L.ATOM1],gt=St[L.ATOM2],yt=St[L.ATOM3],bt=St[L.ANGLE],wt=St[L.STRENGTH]},springForces:function(){Lt=_t[0],At=_t[1],Ot=_t[2],Mt=_t[3]}},vn=function(t){var n;pt=e.radialBonds=[],pt[C.ATOM1]=r.create(t,0,c),pt[C.ATOM2]=r.create(t,0,c),pt[C.LENGTH]=r.create(t,0,l),pt[C.STRENGTH]=r.create(t,0,l),pt[C.STYLE]=r.create(t,0,h),dn.radialBonds(),ht=e.radialBondResults=[];for(n=0;n<t;n++)ht[n]=r.create(ct+5,0,l),ht[n][0]=n},mn=function(t){var n;St=e.angularBonds=[],St[L.ATOM1]=r.create(t,0,c),St[L.ATOM2]=r.create(t,0,c),St[L.ATOM3]=r.create(t,0,c),St[L.ANGLE]=r.create(t,0,l),St[L.STRENGTH]=r.create(t,0,l),dn.angularBonds()},gn=function(t){_t=e.springForces=[],_t[0]=r.create(t,0,c),_t[1]=r.create(t,0,l),_t[2]=r.create(t,0,l),_t[3]=r.create(t,0,l),dn.springForces()},yn=function(t){var n=A;$t=e.obstacles=[],$t[n.X]=Pt=r.create(t,0,l),$t[n.Y]=Ht=r.create(t,0,l),$t[n.WIDTH]=Bt=r.create(t,0,l),$t[n.HEIGHT]=jt=r.create(t,0,l),$t[n.MASS]=qt=r.create(t,0,l),$t[n.VX]=Ft=r.create(t,0,l),$t[n.VY]=It=r.create(t,0,l),$t[n.X_PREV]=Rt=r.create(t,0,l),$t[n.Y_PREV]=Ut=r.create(t,0,l),$t[n.COLOR_R]=zt=r.create(t,0,l),$t[n.COLOR_G]=Wt=r.create(t,0,l),$t[n.COLOR_B]=Xt=r.create(t,0,l),$t[n.VISIBLE]=Vt=r.create(t,0,h)},bn,wn=function(){return v&&m?1e3:1e3},En=function(){x=!0,bn=o.getWindowedAverager(wn())},Sn=function(){var e=0,t;for(t=0;t<R;t++)e+=it[t]*(K[t]*K[t]+Q[t]*Q[t]);for(t=0;t<Jt;t++)qt[t]!==Infinity&&(e+=qt[t]*(Ft[t]*Ft[t]+It[t]*It[t]));return D(e/2,R)},xn=function(e,t){K[e]*=t,Q[e]*=t,X[e]*=t,V[e]*=t},Tn=function(e,t){Ft[e]*=t,It[e]*=t},Nn=function(e,t,n){K[e]+=t,Q[e]+=n,X[e]=K[e]*it[e],V[e]=Q[e]*it[e]},Cn=function(e,t){K[e]-=t*(J[e]-Qt),Q[e]+=t*($[e]-Kt),X[e]=K[e]*it[e],V[e]=Q[e]*it[e]},kn=function(){for(var e=0;e<R;e++)Nn(e,-Zt,-en),Cn(e,-rn)},Ln=function(){var e=0,t=0,n=0,r=0,i;for(i=0;i<R;i++)e+=$[i],t+=J[i],n+=X[i],r+=V[i];Kt=e/R,Qt=t/R,Gt=n,Yt=r,Zt=n/U,en=r/U},An=function(){var e=0,t=0,n,r;for(r=0;r<R;r++)n=it[r],e+=n*M($[r]-Kt,J[r]-Qt,K[r]-Zt,Q[r]-en),t+=n*_($[r]-Kt,J[r]-Qt);tn=e,nn=t,rn=tn/nn},On=function(){Ln(),An()},Mn=function(e){$[e]+=K[e]*I+.5*Y[e]*q,J[e]+=Q[e]*I+.5*Z[e]*q},_n=function(e){var t=Ft[e],n=It[e];if(t||n)Rt[e]=Pt[e],Ut[e]=Ht[e],Pt[e]+=t*I,Ht[e]+=n*I},Dn=function(e){var t=W[e],n=t,r=t,i=P[0],s=P[1],o=i-t,u=s-t;if($[e]<n){while($[e]<n-i)$[e]+=i;$[e]=n+(n-$[e]),K[e]*=-1,X[e]*=-1}else if($[e]>o){while($[e]>o+i)$[e]-=i;$[e]=o-($[e]-o),K[e]*=-1,X[e]*=-1}if(J[e]<r){while(J[e]<r-s)J[e]+=s;J[e]=r+(r-J[e]),Q[e]*=-1,V[e]*=-1}else if(J[e]>u){while(J[e]>u+i)J[e]-=i;J[e]=u-(J[e]-u),Q[e]*=-1,V[e]*=-1}},Pn=function(e,t,n){if(Jt<1)return;var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S=0;r=W[e],i=$[e],s=J[e];for(o=0;o<Jt;o++)u=Pt[o]-r,a=Pt[o]+Bt[o]+r,f=Ht[o]+jt[o]+r,l=Ht[o]-r,c=Rt[o]-r,h=Rt[o]+Bt[o]+r,p=Ut[o]+jt[o]+r,d=Ut[o]-r,i>u&&i<a&&s>l&&s<f&&(t<=c?($[e]=u-(i-u),S=1):t>=h?($[e]=a+(a-i),S=1):n<=p?(J[e]=l-(s-l),S=-1):n>=d&&(J[e]=f+(f-s),S=-1)),w=qt[o],S&&(w!==Infinity?(b=it[e],E=w+b,S===1?(v=K[e],g=Ft[o],K[e]=(v*(b-w)+2*w*g)/E,Ft[o]=(g*(w-b)+2*X[e])/E):(m=Q[e],y=It[o],Q[e]=(m*(b-w)+2*w*y)/E,It[o]=(y*(w-b)+2*V[e])/E)):S===1?K[e]*=-1:Q[e]*=-1)},Hn=function(e){var t=it[e];K[e]+=.5*Y[e]*I,X[e]=t*K[e],Q[e]+=.5*Z[e]*I,V[e]=t*Q[e]},Bn=function(e){K[e]=Q[e]=Y[e]=Z[e]=0},jn=function(e){var t,n,r,i,s,o,a,f=tt[e],l,c=et[e],h=dt&&dt[e];for(t=0;t<e;t++){if(h&&h[t])continue;l=tt[t],n=$[t]-$[e],r=J[t]-J[e],i=n*n+r*r,s=0,g&&i<fn[f][l]&&(s+=ln[f][l].forceOverDistanceFromSquaredDistance(i)),v&&m&&(s+=u.forceOverDistanceFromSquaredDistance(i,c,et[t])),s&&(o=s*n,a=s*r,Y[e]+=o,Z[e]+=a,Y[t]-=o,Z[t]-=a)}},Fn=function(){if(!b)return;var e;for(e=0;e<R;e++)Z[e]-=b},In=function(){if(!B)return;var e,t;for(e=0;e<R;e++)t=B*nt[e],Y[e]+=-K[e]*t,Z[e]+=-Q[e]*t},qn=function(){if(vt<1)return;var e,t,n,r,o,u,a,f,l,c,h,p,d;for(e=0,t=pt[0].length;e<t;e++)n=ot[e],r=ut[e],o=$[r]-$[n],u=J[r]-J[n],a=o*o+u*u,f=Math.sqrt(a),l=ft[e],c=at[e],h=i.convert(l*(f-c),{from:s.EV_PER_NM,to:s.MW_FORCE_UNIT})/f,p=h*o,d=h*u,Y[n]+=p,Z[n]+=d,Y[r]-=p,Z[r]-=d},Rn=function(){if(xt<1)return;var e,t,n,r,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;for(e=0,t=St[0].length;e<t;e++)n=mt[e],r=gt[e],o=yt[e],m=bt[e],v=wt[e],u=$[n]-$[o],f=$[r]-$[o],a=J[n]-J[o],l=J[r]-J[o],c=u*u+a*a,h=f*f+l*l,p=Math.sqrt(c),d=Math.sqrt(h),y=(u*f+a*l)/(p*d),y>1?y=1:y<-1&&(y=-1),b=Math.sqrt(1-y*y),g=Math.acos(y),b<1e-4&&(b=1e-4),T=i.convert(v*(g-m)/(b*p),{from:s.EV_PER_NM,to:s.MW_FORCE_UNIT})/d,N=u*f+a*l,w=T*(f-N*u/c),E=T*(l-N*a/c),S=T*(u-N*f/h),x=T*(a-N*l/h),Y[n]+=w,Z[n]+=E,Y[r]+=S,Z[r]+=x,Y[o]-=w+S,Z[o]-=E+x},Un=function(){if(Dt<1)return;var e,t,n,r,o,u,a,f,l,c;for(e=0;e<Dt;e++){c=Lt[e],t=At[e]-$[c],n=Ot[e]-J[c];if(t===0&&n===0)continue;o=t*t+n*n,r=Math.sqrt(o),u=Mt[e],a=i.convert(u*r,{from:s.EV_PER_NM,to:s.MW_FORCE_UNIT})/r,f=a*t,l=a*n,Y[c]+=f,Z[c]+=l}},zn=function(e,t){var n,r;e==null&&(e=N),sn=Sn(),x&&Math.abs(bn(sn)-e)<=e*k&&(x=!1);if(t||y||x&&sn>0){n=Math.sqrt(e/sn);for(r=0;r<R;r++)xn(r,n);for(r=0;r<Jt;r++)Tn(r,n);sn=e}};return e={useCoulombInteraction:function(e){v=!!e},useLennardJonesInteraction:function(e){g=!!e},useThermostat:function(e){y=!!e},setGravitationalField:function(e){typeof e=="number"&&e!==0?b=e:b=!1},setIntegrationDuration:function(e){if(!(typeof e=="number"&&e>=0))throw new Error("The integrationDuration must be a number greater than or equal to 1");j=e},setTimeStep:function(e){if(!(typeof e=="number"&&e>=0))throw new Error("The timeStep must be a time in fs greater than 0");I=e},setTargetTemperature:function(e){H(e),N=e},setTime:function(e){F=e},setSize:function(e){if(t)throw new Error("The molecular model's size has already been set, and cannot be reset.");var n=e[0]&&e[0]>0?e[0]:10,r=e[1]&&e[1]>0?e[1]:10;P=[n,r]},getSize:function(){return[P[0],P[1]]},getLJCalculator:function(){return ln},setElements:function(t){var r,i;if(n)throw new Error("md2d: setElements cannot be called after atoms have been created");z=t;for(r=0;r<z.length;r++)on[r]=[],un[r]=[],ln[r]=[],fn[r]=[];for(r=0;r<z.length;r++){z[r][T.RADIUS]=a.radius(z[r][T.SIGMA]);for(i=r;i<z.length;i++)hn(r,i)}f=!0,e.elements=z},setElementProperties:function(e,t){var n,r;if(t.mass!=null&&t.mass!==z[e][T.MASS]){z[e][T.MASS]=t.mass;for(n=0;n<R;n++)tt[n]===e&&(it[n]=t.mass)}if(t.sigma!=null){z[e][T.SIGMA]=t.sigma,r=a.radius(t.sigma);if(z[e][T.RADIUS]!==r){z[e][T.RADIUS]=r;for(n=0;n<R;n++)tt[n]===e&&(W[n]=r)}}t.epsilon!=null&&(z[e][T.EPSILON]=t.epsilon);for(n=0;n<z.length;n++)hn(e,n)},createAtoms:function(i){var s;if(!f)throw new Error("md2d: createAtoms was called before setElements.");if(n)throw new Error("md2d: createAtoms was called even though the particles have already been created for this model instance.");n=!0,t=!0;if(typeof i=="undefined")throw new Error("md2d: createAtoms was called without options specifying the atoms to create.");s=i.num;if(typeof s=="undefined")throw new Error("md2d: createAtoms was called without the required 'num' option specifying the number of atoms to create.");if(s!==Math.floor(s))throw new Error("md2d: createAtoms was passed a non-integral 'num' option.");if(s<p)throw new Error("md2d: create Atoms was passed an 'num' option equal to: "+s+" which is less than the minimum allowable value: N_MIN = "+p+".");if(s>d)throw new Error("md2d: create Atoms was passed an 'N' option equal to: "+s+" which is greater than the minimum allowable value: N_MAX = "+d+".");st=e.atoms=r.create(E.length,null,"regular"),st[S.RADIUS]=r.create(s,0,l),st[S.PX]=r.create(s,0,l),st[S.PY]=r.create(s,0,l),st[S.X]=r.create(s,0,l),st[S.Y]=r.create(s,0,l),st[S.VX]=r.create(s,0,l),st[S.VY]=r.create(s,0,l),st[S.SPEED]=r.create(s,0,l),st[S.AX]=r.create(s,0,l),st[S.AY]=r.create(s,0,l),st[S.CHARGE]=r.create(s,0,l),st[S.FRICTION]=r.create(s,0,l),st[S.ELEMENT]=r.create(s,0,h),st[S.PINNED]=r.create(s,0,h),st[S.MASS]=r.create(s,0,l),dn.atoms(),R=0,U=0},addAtom:function(e,t,n,r,i,s,o,u){var a,f;return R+1>st[0].length&&(pn(st,R+10),dn.atoms()),s==null&&(s=w.CHARGE),o==null&&(o=w.FRICTION),u==null&&(u=w.PINNED),a=z[e],f=a[T.MASS],tt[R]=e,W[R]=z[e][T.RADIUS],$[R]=t,J[R]=n,K[R]=r,Q[R]=i,X[R]=r*f,V[R]=i*f,Y[R]=0,Z[R]=0,G[R]=Math.sqrt(r*r+i*i),et[R]=s,nt[R]=o,rt[R]=u,it[R]=f,s&&(m=!0),U+=f,R++},addRadialBond:function(e,t,n,r,i){i==null&&(i=w.RADIAL_BOND_STYLE),vt+1>pt[0].length&&(pn(pt,vt+10),dn.radialBonds()),ht[vt][1]=ot[vt]=e,ht[vt][2]=ut[vt]=t,ht[vt][3]=at[vt]=n,ht[vt][4]=ft[vt]=r,ht[vt][5]=lt[vt]=i,dt[e]||(dt[e]=[]),dt[e][t]=!0,dt[t]||(dt[t]=[]),dt[t][e]=!0,vt++},addAngularBond:function(e,t,n,r,i){xt+1>St[0].length&&(pn(St,xt+10),dn.angularBonds()),mt[xt]=e,gt[xt]=t,yt[xt]=n,bt[xt]=r,wt[xt]=i,xt++},addSpringForce:function(e,t,n,r){return _t||gn(1),Dt>_t[0].length&&(pn(_t,Dt+1),dn.springForces()),Lt[Dt]=e,At[Dt]=t,Ot[Dt]=n,Mt[Dt]=r,Dt++},updateSpringForce:function(e,t,n){At[e]=t,Ot[e]=n},removeSpringForce:function(e){if(e>=Dt)return;Dt--},springForceAtomIndex:function(e){return Lt[e]},addObstacle:function(e,t,n,r,i,s,o,u,a){var f;Jt+1>$t[0].length&&pn($t,Jt+10),Pt[Jt]=e,Ht[Jt]=t,Rt[Jt]=e,Ut[Jt]=t,Bt[Jt]=i,jt[Jt]=s,Ft[Jt]=n,It[Jt]=r,o=parseFloat(o),f=o*i*s,qt[Jt]=f,zt[Jt]=u[0],Wt[Jt]=u[1],Xt[Jt]=u[2],Vt[Jt]=a,Jt++},atomInBounds:function(e,t,n){var r=W[n],i;if(e<r||e>P[0]-r||t<r||t>P[1]-r)return!1;for(i=0;i<Jt;i++)if(e>Pt[i]-r&&e<Pt[i]+Bt[i]+r&&t>Ht[i]-r&&t<Ht[i]+jt[i]+r)return!1;return!0},canPlaceAtom:function(t,n,r,i){var s,o,u;return e.atomInBounds(n,r,i)?(typeof i=="number"&&(s=$[i],o=J[i],$[i]=J[i]=Infinity),u=e.newPotentialCalculator(t,0,!1)(n,r),typeof i=="number"&&($[i]=s,J[i]=o),u<=0):!1},initializeAtomsFromProperties:function(t){var n,r,i,s,o,u,a,f,l,c;if(!t.X||!t.Y)throw new Error("md2d: initializeAtomsFromProperties must specify at minimum X and Y locations.");if(!t.VX||!t.VY)throw new Error("md2d: For now, velocities must be set when locations are set.");for(l=0,c=t.X.length;l<c;l++)u=t.ELEMENT?t.ELEMENT[l]:0,n=t.X[l],r=t.Y[l],i=t.VX[l],s=t.VY[l],o=t.CHARGE?t.CHARGE[l]:0,f=t.PINNED?t.PINNED[l]:0,a=t.FRICTION?t.FRICTION[l]:0,e.addAtom(u,n,r,i,s,o,a,f);sn=Sn()},initializeAtomsRandomly:function(t){var n=t.temperature||100,r=t.num||st[0].length,i=Math.floor(Math.sqrt(r)),s=Math.ceil(r/i),u,a,f,l,c,h,p,d,v,m,g,y,b;H(n),c=P[0]/(1+s),l=P[1]/(1+i),u=-1;for(a=1;a<=i;a++)for(f=1;f<=s;f++){u++;if(u===r)break;b=Math.floor(Math.random()*z.length),h=o.normal(1,.25),p=2*Math.random()*Math.PI,d=f*c,v=a*l,m=h*Math.cos(p),g=h*Math.sin(p),y=2*(u%2)-1,e.addAtom(b,d,v,m,g,y,0,0,1,0)}On(),kn(),zn(n,!0),sn=Sn()},initializeObstacles:function(t){var n=t.x.length,r;yn(n);for(r=0;r<n;r++)e.addObstacle(t.x[r],t.y[r],t.vx[r],t.vy[r],t.width[r],t.height[r],t.density[r],t.color[r],t.visible[r])},initializeRadialBonds:function(t){var n=t.atom1Index.length,r;dt=[],vn(n);for(r=0;r<n;r++)e.addRadialBond(t.atom1Index[r],t.atom2Index[r],t.bondLength[r],t.bondStrength[r],t.bondStyle[r])},initializeAngularBonds:function(t){var n=t.atom1Index.length,r;mn(n);for(r=0;r<n;r++)e.addAngularBond(t.atom1Index[r],t.atom2Index[r],t.atom3Index[r],t.bondAngle[r],t.bondStrength[r])},createVdwPairsArray:function(){var t=R*(R-1)/2;Tt=e.vdwPairs=[],Tt[O.COUNT]=Nt,Tt[O.ATOM1]=Ct=r.create(t,0,c),Tt[O.ATOM2]=kt=r.create(t,0,c),e.updateVdwPairsArray()},updateVdwPairsArray:function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v=4;Nt=0;for(e=0;e<R;e++){u=z[tt[e]],f=u[T.SIGMA],l=u[T.EPSILON],s=$[e],o=J[e];for(t=e+1;t<R;t++){if(vt!==0&&dt[e]&&dt[e][t])continue;a=z[tt[t]],et[e]*et[t]<=0&&(n=$[t]-s,r=J[t]-o,i=n*n+r*r,c=a[T.SIGMA],h=a[T.EPSILON],p=.5*(f+c),p*=p,d=l*h,i<p*v&&d>0&&(Ct[Nt]=e,kt[Nt]=t,Nt++))}}Tt[O.COUNT]=Nt},relaxToTemperature:function(t){t!=null&&(N=t),H(N),En();while(x)e.integrate()},integrate:function(e){var t,r;if(!n)throw new Error("md2d: integrate called before atoms created.");e==null&&(e=j),q=I*I,t=z[tt[0]][T.RADIUS];var i=F,s=Math.floor(e/I),o,u,a,f;for(o=1;o<=s;o++){F=i+o*I;for(u=0;u<R;u++)a=$[u],f=J[u],Mn(u),Dn(u),Pn(u,a,f),Hn(u),Y[u]=Z[u]=0,jn(u);for(u=0;u<Jt;u++)_n(u);qn(),Rn(),Un(),In();for(u=0;u<R;u++)r=1/it[u],Y[u]*=r,Z[u]*=r;Fn();for(u=0;u<R;u++)rt[u]&&Bn(u),Hn(u),G[u]=Math.sqrt(K[u]*K[u]+Q[u]*Q[u]);zn()}},getTotalMass:function(){return U},getRadiusOfElement:function(e){return z[e][T.RADIUS]},getNumberOfAtoms:function(){return R},computeOutputState:function(e){var t,n,r,o,a,f,l,c,h,p,d,y,w,E,S,x,T,N,C,k,L,A,O,M;M=0,O=0;for(t=0;t<R;t++){b&&(A=it[t]*b*J[t],M+=i.convert(A,{from:s.MW_ENERGY_UNIT,to:s.EV})),O+=.5*it[t]*(K[t]*K[t]+Q[t]*Q[t]);for(n=t+1;n<R;n++)c=$[n]-$[t],h=J[n]-J[t],x=c*c+h*h,g&&(M-=ln[tt[t]][tt[n]].potentialFromSquaredDistance(x)),v&&m&&(M+=u.potential(Math.sqrt(x),et[t],et[n]))}for(t=0;t<vt;t++)r=ot[t],o=ut[t],f=tt[r],l=tt[o],c=$[o]-$[r],h=J[o]-J[r],x=c*c+h*h,C=ft[t],k=Math.sqrt(x)-at[t],M+=.5*C*k*k,g&&(M+=ln[f][l].potentialFromSquaredDistance(x)),v&&et[r]&&et[o]&&(M-=u.potential(Math.sqrt(x),et[r],et[o])),ht[t][6]=$[r],ht[t][7]=J[r],ht[t][8]=$[o],ht[t][9]=J[o];for(t=0;t<xt;t++)r=mt[t],o=gt[t],a=yt[t],p=$[r]-$[a],y=$[o]-$[a],d=J[r]-J[a],w=J[o]-J[a],T=Math.sqrt(p*p+d*d),N=Math.sqrt(y*y+w*w),E=(p*y+d*w)/(T*N),E>1?E=1:E<-1&&(E=-1),S=Math.acos(E),L=S-bt[t],M+=.5*wt[t]*L*L;for(t=0;t<Jt;t++)qt[t]!==Infinity&&(O+=.5*qt[t]*(Ft[t]*Ft[t]+It[t]*It[t]));e.time=F,e.pressure=0,e.PE=M,e.KE=i.convert(O,{from:s.MW_ENERGY_UNIT,to:s.EV}),e.temperature=sn,e.pCM=[Gt,Yt],e.CM=[Kt,Qt],e.vCM=[Zt,en],e.omega_CM=rn},newPotentialCalculator:function(e,t,n){return function(r,o){var a=0,f=0,l=0,c,h,p=ln[e],d,y,b,w,E,S,x;for(d=0;d<R;d++)y=r-$[d],b=o-J[d],w=y*y+b*b,S=0,g&&(x=p[tt[d]],a+=-x.potentialFromSquaredDistance(w,e,tt[d]),n&&(S+=x.forceOverDistanceFromSquaredDistance(w))),v&&m&&t&&(E=Math.sqrt(w),a+=-u.potential(E,t,et[d]),n&&(S+=u.forceOverDistanceFromSquaredDistance(w,t,et[d]))),S&&(f+=S*y,l+=S*b);return n?(c=i.convert(f,{from:s.MW_FORCE_UNIT,to:s.EV_PER_NM}),h=i.convert(l,{from:s.MW_FORCE_UNIT,to:s.EV_PER_NM}),[a,[c,h]]):a}},findMinimumPELocation:function(t,n,r,i){var s=e.newPotentialCalculator(t,i,!0),u=z[t][T.RADIUS],a=o.minimize(s,[n,r],{bounds:[[u,P[0]-u],[u,P[1]-u]]});return a.error?!1:a[1]},findMinimumPESquaredLocation:function(t,n,r,i){var s=e.newPotentialCalculator(t,i,!0),u=function(e,t){var n,r,i;return n=s(e,t),r=n[0],i=n[1],i[0]*=2*r,i[1]*=2*r,[r*r,i]},a=z[t][T.RADIUS],f=o.minimize(u,[n,r],{bounds:[[a,P[0]-a],[a,P[1]-a]],stopval:1e-4,precision:1e-6});return f.error?!1:f[1]},atomsInMolecule:[],depth:0,getMoleculeAtoms:function(e){this.atomsInMolecule.push(e);var t=[],n=this.getBondedAtoms(e),r=this.depth,i,s,o;this.depth++;for(i=0,s=n.length;i<s;i++)o=n[i],~this.atomsInMolecule.indexOf(o)||(t=t.concat(this.getMoleculeAtoms(o)));return r===0?(this.depth=0,this.atomsInMolecule=[]):t.push(e),t},getBondedAtoms:function(e){var t=[],n,r;if(pt)for(n=0,r=pt[0].length;n<r;n++)ot[n]===e&&t.push(ut[n]),ut[n]===e&&t.push(ot[n]);return t},getAtomKineticEnergy:function(e){var t=.5*it[e]*(K[e]*K[e]+Q[e]*Q[e]);return i.convert(t,{from:s.MW_ENERGY_UNIT,to:s.EV})},setViscosity:function(e){B=e}}}}),n("md2d/models/modeler",["require","common/console","arrays","md2d/models/engine/md2d"],function(e){e("common/console");var t=e("arrays"),n=e("md2d/models/engine/md2d"),r;return function(i){function et(){var e,t,r,i;s.INDICES={},s.ATOM_PROPERTY_LIST=[],s.ATOM_PROPERTY_SHORT_NAMES={},r=0;for(t=0;t<n.ATOM_PROPERTY_LIST.length;t++)e=n.ATOM_PROPERTY_LIST[t],s.ATOM_PROPERTY_LIST[t]=e,s.INDICES[e]=n.ATOM_INDICES[e]+r;s.RADIAL_BOND_INDICES={},s.RADIAL_BOND_PROPERTY_LIST=[],r=0;for(t=0;t<n.RADIAL_BOND_PROPERTY_LIST.length;t++)e=n.RADIAL_BOND_PROPERTY_LIST[t],s.RADIAL_BOND_PROPERTY_LIST[t]=e,s.RADIAL_BOND_INDICES[e]=n.RADIAL_BOND_INDICES[e]+r;s.ANGULAR_BOND_INDICES={},s.ANGULAR_BOND_PROPERTY_LIST=[],r=0;for(t=0;t<n.ANGULAR_BOND_PROPERTY_LIST.length;t++)e=n.ANGULAR_BOND_PROPERTY_LIST[t],s.ANGULAR_BOND_PROPERTY_LIST[t]=e,s.ANGULAR_BOND_INDICES[e]=n.ANGULAR_BOND_INDICES[e]+r;s.ELEMENT_INDICES={},s.ELEMENT_PROPERTY_LIST=[];for(t=0;t<n.ELEMENT_PROPERTY_LIST.length;t++)e=n.ELEMENT_PROPERTY_LIST[t],s.ELEMENT_PROPERTY_LIST[t]=e,s.ELEMENT_INDICES[e]=n.ELEMENT_INDICES[e];s.NON_ENGINE_PROPERTY_LIST=["VISIBLE","MARKED","DRAGGABLE"],s.NON_ENGINE_PROPERTY_SHORT_NAMES={VISIBLE:"visible",MARKED:"marked",DRAGGABLE:"draggable"},s.RADIAL_BOND_STYLES={RADIAL_BOND_STANDARD_STICK_STYLE:101,RADIAL_BOND_LONG_SPRING_STYLE:102,RADIAL_BOND_SOLID_LINE_STYLE:103,RADIAL_BOND_GHOST_STYLE:104,RADIAL_BOND_UNICOLOR_STICK_STYLE:105,RADIAL_BOND_SHORT_SPRING_STYLE:106,RADIAL_BOND_DOUBLE_BOND_STYLE
:107,RADIAL_BOND_TRIPLE_BOND_STYLE:108},s.NON_ENGINE_DEFAULT_VALUES={VISIBLE:1,MARKED:0,DRAGGABLE:0},r=s.ATOM_PROPERTY_LIST.length;for(t=0;t<s.NON_ENGINE_PROPERTY_LIST.length;t++)e=s.NON_ENGINE_PROPERTY_LIST[t],s.ATOM_PROPERTY_LIST.push(e),s.INDICES[e]=t+r,s.ATOM_PROPERTY_SHORT_NAMES[e]=s.NON_ENGINE_PROPERTY_SHORT_NAMES[e];s.ATOM_PROPERTY_LONG_NAMES={};for(e in s.ATOM_PROPERTY_SHORT_NAMES)s.ATOM_PROPERTY_SHORT_NAMES.hasOwnProperty(e)&&(i=s.ATOM_PROPERTY_SHORT_NAMES[e],s.ATOM_PROPERTY_LONG_NAMES[i]=e);s.SAVEABLE_PROPERTIES=["X","Y","VX","VY","CHARGE","ELEMENT","PINNED","FRICTION","VISIBLE","MARKED","DRAGGABLE"],s.OBSTACLE_INDICES={X:n.OBSTACLE_INDICES.X,Y:n.OBSTACLE_INDICES.Y,WIDTH:n.OBSTACLE_INDICES.WIDTH,HEIGHT:n.OBSTACLE_INDICES.HEIGHT,COLOR_R:n.OBSTACLE_INDICES.COLOR_R,COLOR_G:n.OBSTACLE_INDICES.COLOR_G,COLOR_B:n.OBSTACLE_INDICES.COLOR_B,VISIBLE:n.OBSTACLE_INDICES.VISIBLE},s.VDW_INDICES=n.VDW_INDICES}function tt(e){$.unique(e);for(var t=0,n=e.length;t<n;t++)e[t]()}function nt(e){var t,n,r=[],i,s;typeof e=="string"?n=[e]:n=e;for(i=0,s=n.length;i<s;i++)t=n[i],K[t]&&(r=r.concat(K[t]));K.all&&(r=r.concat(K.all)),tt(r)}function rt(){var e,t=0,n=s.get_num_atoms();e=-1;while(++e<n)t+=r.speed[e];return t/n}function it(e,t){var n,i,s;return b?s=!0:(n=Date.now(),k?(i=n-k,1e3/i<C?(s=!0,k=n,L.push(i),L.splice(0,L.length-128)):s=!1):(k=n,s=!0)),s&&(r.integrate(),vt(),N.push(T),N.splice(0,N.length-16),ot(),t||u.tick()),b}function st(){return E===0}function ot(){var e,n=[],r=j.length;e=-1;while(++e<r)n[e]=t.clone(j[e]);w.length=E,E++,S++,x=!0,w.push({atoms:n,pressure:D.pressure,pe:D.PE,ke:D.KE,time:D.time}),E>1e3&&(w.splice(1,1),E=1e3)}function ut(){E=0,S=0,w.length=1,lt(E)}function at(){w=[],E=0,S=0}function ft(){w.length=E+1}function lt(e){var n,i=j.length;if(e<0)throw new Error("modeler: request for tick_history_list["+e+"]");if(e>=w.length)throw new Error("modeler: request for tick_history_list["+e+"], tick_history_list.length="+w.length);n=-1;while(++n<i)t.copy(w[e].atoms[n],j[n]);_=w[e].ke,O=w[e].time,r.setTime(O)}function ct(){return N.reduce(function(e,t){return e+t})/N.length}function ht(){var e,t,n=0,r=L.length;e=-1;while(++e<r)n+=L[e];return t=n/r,t?1/t*1e3:0}function pt(e){A=e,r.setTargetTemperature(e)}function dt(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&e[t]!==undefined&&e[t]!==null&&(Q["set_"+t]?Q["set_"+t](e[t]):Q[t]=e[t],n.push(t));nt(n)}function vt(){var e,t,n,i;r.computeOutputState(D),mt();for(n=0,t=j.length;n<t;n++)for(e=0,i=s.get_num_atoms();e<i;e++)F[e][n+1]=j[n][e];T=D.pressure,M=D.PE,_=D.KE,O=D.time}function mt(){var e,n;F||(F=[]);for(e=F.length,n=s.get_num_atoms();e<n;e++)F[e]||(F[e]=t.create(1+s.ATOM_PROPERTY_LIST.length,0,Z),F[e][0]=e)}function gt(e){for(var t=0;t<s.get_num_atoms();t++)j[s.INDICES[e]][t]=s.NON_ENGINE_DEFAULT_VALUES[e]}function yt(e,t){for(var n=0;n<s.get_num_atoms();n++)j[s.INDICES[e]][n]=t[n]}function bt(e){var n,r;for(r=0;r<s.NON_ENGINE_PROPERTY_LIST.length;r++)n=s.NON_ENGINE_PROPERTY_LIST[r],j[s.INDICES[n]]=t.create(s.get_num_atoms(),0,Z),e[n]?yt(n,e[n]):gt(n)}function wt(){var e;for(var t=0;t<n.ATOM_PROPERTY_LIST.length;t++)e=n.ATOM_PROPERTY_LIST[t],j[s.INDICES[e]]=r.atoms[n.ATOM_INDICES[e]]}function Et(e){var t=[];for(var n=0,r=e.length;n<r;n++)t[n]=e[n];return t}function St(){var e={},t,n,r,i;for(r=0,i=s.SAVEABLE_PROPERTIES.length;r<i;r++)t=s.SAVEABLE_PROPERTIES[r],n=j[s.INDICES[t]],e[t]=n.slice?n.slice():Et(n);return e}var s={},o=i.elements||[{id:0,mass:39.95,epsilon:-0.1,sigma:.34}],u=d3.dispatch("tick","play","stop","reset","stepForward","stepBack","seek","addAtom"),a,f,l,c,h,p,d,v,m=!1,g=50,y=1,b=!0,w=[],E=0,S=0,x=!1,T,N=[0],C=60,k,L=[],A,O,M,_,D,P,H=i.width,B=i.height,j,F,I,q,R,U,z,W,X,V,J={vx:0,vy:0,density:Infinity,color:[128,128,128]},K={},Q={temperature:300,modelSampleRate:60,coulomb_forces:!0,lennard_jones_forces:!0,temperature_control:!0,gravitationalField:!1,keShading:!1,chargeShading:!1,showVDWLines:!1,showClock:!0,viewRefreshInterval:50,timeStep:1,VDWLinesRatio:1.99,viscosity:0,set_temperature:function(e){this.temperature=e,r&&r.setTargetTemperature(e)},set_temperature_control:function(e){this.temperature_control=e,r&&r.useThermostat(e)},set_coulomb_forces:function(e){this.coulomb_forces=e,r&&r.useCoulombInteraction(e)},set_epsilon:function(e){console.log("set_epsilon: This method is temporarily deprecated")},set_sigma:function(e){console.log("set_sigma: This method is temporarily deprecated")},set_gravitationalField:function(e){this.gravitationalField=e,r&&r.setGravitationalField(e)},set_viewRefreshInterval:function(e){this.viewRefreshInterval=e,r&&r.setIntegrationDuration(e)},set_timeStep:function(e){this.timeStep=e,r&&r.setTimeStep(e)},set_viscosity:function(e){this.viscosity=e,r&&r.setViscosity(e)}},G=function(){var e=/ AppleWebKit\/([0123456789.+]+) \(KHTML, like Gecko\) Version\/([0123456789.]+) (Safari)\/([0123456789.]+)/,t=navigator.userAgent.match(e);return t&&t[3]?!1:!0}(),Y=function(){try{new Float32Array}catch(e){return!1}return!0}(),Z=Y&&G?"Float32Array":"regular";return et(),s.LIVE_DRAG_FRICTION=10,P=i.model_listener,dt(i),s.getStats=function(){return{speed:rt(),ke:_,temperature:A,pressure:ct(),current_step:S,steps:w.length-1}},s.getStatsHistory=function(){var e,t,n,r=[];r.push("time (fs)	total PE (eV)	total KE (eV)	total energy (eV)");for(e=0,t=w.length;e<t;e++)n=w[e],r.push(n.time+"	"+n.pe+"	"+n.ke+"	"+(n.pe+n.ke));return r.join("\n")},s.stepCounter=function(){return S},s.steps=function(){return w.length-1},s.isNewStep=function(){return x},s.seek=function(e){return arguments.length||(e=0),b=!0,x=!1,E=e,S=e,lt(E),u.seek(),P&&P(),S},s.stepBack=function(e){arguments.length||(e=1);var t=-1;b=!0,x=!1;while(++t<e)E>1&&(E--,S--,lt(E-1),P&&P());return S},s.stepForward=function(e){arguments.length||(e=1);var t=-1;b=!0;while(++t<e)E<w.length?(lt(E),E++,S++,P&&P()):it();return S},s.createNewAtoms=function(e){var t,i,d,v,b;typeof e=="number"?b=e:e.num!=null?b=e.num:e.X&&(b=e.X.length),t=[];for(d=0,v=o.length;d<v;d++)i=o[d],t[i.id]=[i.mass,i.epsilon,i.sigma];return r=n.createEngine(),r.setSize([H,B]),r.setElements(t),r.createAtoms({num:b}),a=Q.temperature_control,A=Q.temperature,C=Q.modelSampleRate,f=Q.keShading,l=Q.chargeShading,c=Q.showVDWLines,h=Q.VDWLinesRatio,p=Q.showClock,g=Q.viewRefreshInterval,y=Q.timeStep,W=Q.viscosity,m=Q.gravitationalField,r.useLennardJonesInteraction(Q.lennard_jones_forces),r.useCoulombInteraction(Q.coulomb_forces),r.useThermostat(a),r.setViscosity(W),r.setGravitationalField(m),r.setIntegrationDuration(g*y),r.setTimeStep(y),r.setTargetTemperature(A),e.X&&e.Y?r.initializeAtomsFromProperties(e):(r.initializeAtomsRandomly({temperature:A}),e.relax&&r.relaxToTemperature()),j=[],wt(r.atoms),bt(e),window.state=D={},vt(),at(),ot(),S=0,x=!0,u.reset(),s},s.createRadialBonds=function(e){return r.initializeRadialBonds(e),R=r.radialBonds,I=r.radialBondResults,vt(),s},s.createAngularBonds=function(e){return r.initializeAngularBonds(e),U=r.angularBonds,vt(),s},s.createVdwPairs=function(e){return r.createVdwPairsArray(e),z=r.vdwPairs,vt(),s},s.createObstacles=function(e){var t=e.x.length,n,i;for(n=0;n<t;n++)for(i in J){if(!J.hasOwnProperty(i))continue;e[i]||(e[i]=[]),typeof e[i][n]=="undefined"&&(e[i][n]=J[i])}return r.initializeObstacles(e),q=r.obstacles,s},s.reset=function(){s.resetTime(),ut(),u.reset()},s.resetTime=function(){r.setTime(0)},s.getTime=function(){return D?D.time:undefined},s.getTotalMass=function(){return r.getTotalMass()},s.getAtomKineticEnergy=function(e){return r.getAtomKineticEnergy(e)},s.addRandomAtom=function(e,t){e==null&&(e=Math.floor(Math.random()*o.length)),t==null&&(t=0);var n=s.size(),i=r.getRadiusOfElement(e),u,a,f,l=0,c=10;do{u=Math.random()*n[0]-2*i,a=Math.random()*n[1]-2*i,f=r.findMinimumPELocation(e,u,a,0,0,t);if(f&&s.addAtom(e,f[0],f[1],0,0,t,0,0))return!0}while(++l<c);return!1},s.addAtom=function(e,n,i,o,a,f,l,c,h,p){var d=s.size(),v=r.getRadiusOfElement(e),m,g;return h==null&&(h=s.NON_ENGINE_DEFAULT_VALUES.VISIBLE),p==null&&(p=s.NON_ENGINE_DEFAULT_VALUES.DRAGGABLE),n<v&&(n=v),n>d[0]-v&&(n=d[0]-v),i<v&&(i=v),i>d[1]-v&&(i=d[1]-v),r.canPlaceAtom(e,n,i)?(g=r.addAtom(e,n,i,o,a,f,l,c),wt(),m=j[s.INDICES.ELEMENT].length,j[s.INDICES.VISIBLE].length<m&&(j[s.INDICES.VISIBLE]=t.extend(j[s.INDICES.VISIBLE],m),j[s.INDICES.DRAGGABLE]=t.extend(j[s.INDICES.DRAGGABLE],m)),j[s.INDICES.VISIBLE][g]=h,j[s.INDICES.DRAGGABLE][g]=p,vt(),u.addAtom(),!0):!1},s.getMoleculeBoundingBox=function(e){var t,n,i,o,u,a=-Infinity,f=Infinity,l=Infinity,c=-Infinity,h,p;t=r.getMoleculeAtoms(e),t.push(e);for(n=0;n<t.length;n++)i=j[s.INDICES.X][t[n]],o=j[s.INDICES.Y][t[n]],u=j[s.INDICES.RADIUS][t[n]],i-u<f&&(f=i-u),i+u>c&&(c=i+u),o-u<l&&(l=o-u),o+u>a&&(a=o+u);return h=j[s.INDICES.X][e],p=j[s.INDICES.Y][e],{top:a-p,left:f-h,bottom:l-p,right:c-h}},s.setAtomProperties=function(e,t,n,i){var o,u,a,f,l,c,h,p,d;if(i){o=r.getMoleculeAtoms(e);if(o.length>0){u=typeof t.x=="number"?t.x-j[s.INDICES.X][e]:0,a=typeof t.y=="number"?t.y-j[s.INDICES.Y][e]:0;for(c=0,h=o.length;c<h;c++){f=j[s.INDICES.X][o[c]]+u,l=j[s.INDICES.Y][o[c]]+a;if(!s.setAtomProperties(o[c],{x:f,y:l},n,!1))return!1}}}if(n){var v=typeof t.x=="number"?t.x:j[s.INDICES.X][e],m=typeof t.y=="number"?t.y:j[s.INDICES.Y][e],g=typeof t.element=="number"?t.y:j[s.INDICES.ELEMENT][e];if(!r.canPlaceAtom(g,v,m,e))return!1}for(p in t)t.hasOwnProperty(p)&&(d=p.toUpperCase(),d&&(j[s.INDICES[d]][e]=t[p]));return vt(),!0},s.getAtomProperties=function(e){var t,n={};for(t=0;t<s.ATOM_PROPERTY_LIST.length;t++)n[s.ATOM_PROPERTY_LIST[t].toLowerCase()]=j[t][e];return n},s.setElementProperties=function(e,t){r.setElementProperties(e,t),vt()},s.getElementProperties=function(e){var t,n={};for(t=0;t<s.ELEMENT_PROPERTY_LIST.length;t++)n[s.ELEMENT_PROPERTY_LIST[t].toLowerCase()]=r.elements[t][e];return n},s.setRadialBondProperties=function(e,t){var n,r;for(n in t)t.hasOwnProperty(n)&&(r=s.RADIAL_BOND_INDICES[n.toUpperCase()],R[r][e]=t[n]);vt()},s.getRadialBondProperties=function(e){var t,n={};for(t=0;t<s.RADIAL_BOND_PROPERTY_LIST.length;t++)n[s.RADIAL_BOND_PROPERTY_LIST[t].toLowerCase()]=R[t][e];return n},s.setAngularBondProperties=function(e,t){var n,r;for(n in t)t.hasOwnProperty(n)&&(r=s.ANGULAR_BOND_INDICES[n.toUpperCase()],U[r][e]=t[n]);vt()},s.getAngularBondProperties=function(e){var t,n={};for(t=0;t<s.ANGULAR_BOND_PROPERTY_LIST.length;t++)n[s.ANGULAR_BOND_PROPERTY_LIST[t].toLowerCase()]=U[t][e];return n},s.addSpringForce=function(e,t,n,i){return i==null&&(i=500),r.addSpringForce(e,t,n,i)},s.updateSpringForce=function(e,t,n){r.updateSpringForce(e,t,n)},s.removeSpringForce=function(e){r.removeSpringForce(e)},s.liveDragStart=function(e,t,n){t==null&&(t=j[s.INDICES.X][e]),n==null&&(n=j[s.INDICES.Y][e]),V=j[s.INDICES.FRICTION][e],j[s.INDICES.FRICTION][e]=s.LIVE_DRAG_FRICTION,X=s.addSpringForce(e,t,n,500)},s.liveDrag=function(e,t){s.updateSpringForce(X,e,t)},s.liveDragEnd=function(){var e=r.springForceAtomIndex(X);j[s.INDICES.FRICTION][e]=V,s.removeSpringForce(X)},s.get_speed=function(){return t.copy(r.speed,[])},s.get_rate=function(){return ht()},s.is_stopped=function(){return b},s.set_lennard_jones_forces=function(e){d=e,r.useLennardJonesInteraction(e)},s.set_coulomb_forces=function(e){v=e,r.useCoulombInteraction(e)},s.get_atoms=function(){return j},s.get_results=function(){return F},s.get_radial_bond_results=function(){return I},s.get_num_atoms=function(){return r.getNumberOfAtoms()},s.get_obstacles=function(){return q},s.get_radial_bonds=function(){return R},s.get_vdw_pairs=function(){return z&&r.updateVdwPairsArray(),z},s.on=function(e,t){return u.on(e,t),s},s.tickInPlace=function(){return u.tick(),s},s.tick=function(e,t){arguments.length||(e=1);var n=t&&t.dontDispatchTickEvent||!1,r=-1;while(++r<e)it(null,n);return s},s.relax=function(){return r.relaxToTemperature(),s},s.start=function(){return s.resume()},s.resume=function(){return b=!1,d3.timer(function(t){return b?!0:(it(t,!1),!1)}),u.play(),s},s.stop=function(){return b=!0,u.stop(),s},s.ke=function(){return D.KE},s.ave_ke=function(){return D.KE/s.get_num_atoms()},s.pe=function(){return D.PE},s.ave_pe=function(){return D.PE/s.get_num_atoms()},s.speed=function(){return rt()},s.pressure=function(){return ct()},s.temperature=function(e){return arguments.length?(pt(e),s):A},s.size=function(e){return arguments.length?(r.setSize(e),s):r.getSize()},s.set=function(e){dt(e)},s.get=function(e){return Q[e]},s.setModelListener=function(e){return P=e,s.on("tick",P),s},s.addPropertiesListener=function(e,t){var n,r,i;for(n=0,r=e.length;n<r;n++)i=e[n],K[i]||(K[i]=[]),K[i].push(t)},s.serialize=function(e){var t=$.extend({},Q);return e&&(t.atoms=St()),o&&(t.elements=o),t.width=H,t.height=B,t},s}}),n("cs",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),function(){n("cs!common/components/model_controller_component",["require","common/console"],function(e){var t;return e("common/console"),t=function(){function e(e,t,n,r,i){var s=this;this.svg_element=e,this.playable=t!=null?t:null,this.width=200,this.height=34,this.xpos=n,this.ypos=r,this.scale=i||1,this.unit_width=this.width/9,this.vertical_padding=(this.height-this.unit_width)/2,this.stroke_width=this.unit_width/10,this.init_view(),this.setup_buttons(),this.playable.isPlaying()?this.hide(this.play):this.hide(this.stop),model.on("play",function(){return s.update_ui()}),model.on("stop",function(){return s.update_ui()})}return e.prototype.offset=function(e){return e*this.unit_width*2+this.unit_width},e.prototype.setup_buttons=function(){},e.prototype.make_button=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=this;t=e.action,u=e.offset,h=e.type,f=e.point_set,h==null&&(h="svg:polyline"),f==null&&(f=this.icon_shapes[t]),u=this.offset(u),s=this.group.append("svg:g"),s.attr("class","component playbacksvgbutton").attr("x",u).attr("y",this.vertical_padding).attr("width",this.unit_width).attr("height",this.unit_width*2).attr("style","fill: #cccccc"),i=s.append("rect"),i.attr("class","bg").attr("x",u).attr("y",this.vertical_padding/3).attr("width",this.unit_width*2).attr("height",this.unit_width*1.5).attr("rx","0");for(v=0,g=f.length;v<g;v++){l=f[v],n=s.append(h),n.attr("class",""+t+" button-art"),c="";for(m=0,y=l.length;m<y;m++)a=l[m],p=u+10+a.x*this.unit_width,d=this.vertical_padding/.75+a.y*this.unit_width,c+=" "+p+","+d,n.attr("points",c);t==="stop"&&(r=s.append("rect"),r.attr("class","pause-center").attr("x",p+this.unit_width/3).attr("y",this.vertical_padding/.75-1).attr("width",this.unit_width/3).attr("height",this.unit_width+2))}return o=s.append("rect"),o.attr("class","highlight").attr("x",u+1).attr("y",this.vertical_padding/1.85).attr("width",this.unit_width*2-2).attr("height",this.unit_width/1.4).attr("rx","0"),s.on("click",function(){return b.action(t)}),s},e.prototype.action=function(e){console.log("running "+e+" ");if(this.playable)switch(e){case"play":this.playable.play();break;case"stop":this.playable.stop();break;case"forward":this.playable.forward();break;case"back":this.playable.back();break;case"seek":this.playable.seek(1);break;case"reset":this.playable.reset();break;default:console.log("cant find action for "+e)}else console.log("no @playable defined");return this.update_ui()},e.prototype.init_view=function(){return this.svg=this.svg_element.append("svg:svg").attr("class","component model-controller playbacksvg").attr("x",this.xpos).attr("y",this.ypos),this.group=this.svg.append("g").attr("transform","scale("+this.scale+","+this.scale+")").attr("width",this.width).attr("height",this.height)},e.prototype.position=function(e,t,n){return this.xpos=e,this.ypos=t,this.scale=n||1,this.svg.attr("x",this.xpos).attr("y",this.ypos),this.group.attr("transform","scale("+this.scale+","+this.scale+")").attr("width",this.width).attr("height",this.height)},e.prototype.update_ui=function(){if(this.playable)return this.playable.isPlaying()?(this.hide(this.play),this.show(this.stop)):(this.hide(this.stop),this.show(this.play))},e.prototype.hide=function(e){return e.style("visibility","hidden")},e.prototype.show=function(e){return e.style("visibility","visible")},e.prototype.icon_shapes={play:[[{x:0,y:0},{x:1,y:.5},{x:0,y:1}]],stop:[[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:0,y:0}]],reset:[[{x:1,y:0},{x:.3,y:.5},{x:1,y:1}],[{x:0,y:0},{x:.3,y:0},{x:.3,y:1},{x:0,y:1},{x:0,y:0}]],back:[[{x:.5,y:0},{x:0,y:.5},{x:.5,y:1}],[{x:1,y:0},{x:.5,y:.5},{x:1,y:1}]],forward:[[{x:.5,y:0},{x:1,y:.5},{x:.5,y:1}],[{x:0,y:0},{x:.5,y:.5},{x:0,y:1}]]},e}()})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("cs!common/components/play_reset_svg",["require","cs!common/components/model_controller_component"],function(e){var n,r;return n=e("cs!common/components/model_controller_component"),r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.setup_buttons=function(){return this.reset=this.make_button({action:"reset",offset:0}),this.play=this.make_button({action:"play",offset:1}),this.stop=this.make_button({action:"stop",offset:1})},n}(n)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("cs!common/components/play_only_svg",["require","cs!common/components/model_controller_component"],function(e){var n,r;return n=e("cs!common/components/model_controller_component"),r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.setup_buttons=function(){return this.play=this.make_button({action:"play",offset:0}),this.stop=this.make_button({action:"stop",offset:0})},n}(n)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("cs!common/components/playback_svg",["require","cs!common/components/model_controller_component"],function(e){var n,r;return n=e("cs!common/components/model_controller_component"),r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.setup_buttons=function(){return this.reset=this.make_button({action:"reset",offset:0}),this.back=this.make_button({action:"back",offset:1}),this.play=this.make_button({action:"play",offset:2}),this.stop=this.make_button({action:"stop",offset:2}),this.forward=this.make_button({action:"forward",offset:3})},n}(n)})}.call(this),n("common/layout/layout",["require"],function(e){var t={version:"0.0.1"};t.selection="",t.display={},t.canonical={width:1280,height:800},t.regular_display=!1,t.not_rendered=!0,t.fontsize=!1,t.cancelFullScreen=!1,t.screen_factor=1,t.checkbox_factor=1.1,t.checkbox_scale=1.1,t.fullScreenRender=!1,t.canonical.width=1280,t.canonical.height=800,t.getDisplayProperties=function(e){return arguments.length||(e={}),e.screen={width:screen.width,height:screen.height},e.client={width:document.body.clientWidth,height:document.body.clientHeight},e.window={width:$(window).width(),height:$(window).height()},e.page={width:t.getPageWidth(),height:t.getPageHeight()},e.screen_factor_width=e.window.width/t.canonical.width,e.screen_factor_height=e.window.height/t.canonical.height,e.emsize=Math.max(e.screen_factor_width*1.1,e.screen_factor_height),e},t.setBodyEmsize=function(){var e;t.display||(t.display=t.getDisplayProperties()),e=Math.min(t.display.screen_factor_width*1.2,t.display.screen_factor_height*1.2),$("body").css("font-size",e+"em")},t.getVizProperties=function(e){var n=$("#viz");return arguments.length||(e={}),e.width=n.width(),e.height=n.height(),e.screen_factor_width=e.width/t.canonical.width,e.screen_factor_height=e.height/t.canonical.height,e.emsize=Math.min(e.screen_factor_width*1.1,e.screen_factor_height),e},t.setVizEmsize=function(){var e,n=$("#viz");t.vis||(t.vis=t.getVizProperties()),e=Math.min(t.viz.screen_factor_width*1.2,t.viz.screen_factor_height*1.2),n.css("font-size",e+"em")},t.screenEqualsPage=function(){return t.display.screen.width===t.display.page.width||t.display.screen.height===t.display.page.height},t.checkForResize=function(){(t.display.screen.width!==screen.width||t.display.screen.height!==screen.height||t.display.window.width!==document.width||t.display.window.height!==document.height)&&t.setupScreen()},t.views={},t.addView=function(e,n){t.views[e]||(t.views[e]=[]),t.views[e].push(n)},t.setView=function(e,n){t.views[e]=n},t.setupScreen=function(e){function o(){var e,n,i,s,o,u,a,f,l,c=t.display.page.width,h=t.display.page.height;s=r.moleculeContainers[0].scale(),l=s[0]/s[1],f=s[0]/c,n=c*.4,i=n*1/l,i>h*.55&&(i=h*.55,n=i*l),e=-1;while(++e<r.moleculeContainers.length)r.moleculeContainers[e].resize(n,i);a=(c-n)*.35,o=i*.52,e=-1;while(++e<r.potentialCharts.length)r.potentialCharts[e].resize(a,o);e=-1;while(++e<r.speedDistributionCharts.length)r.speedDistributionCharts[e].resize(a,o);u=(c-n)*.72,o=i*.76,e=-1;while(++e<r.energyCharts.length)r.energyCharts[e].resize(u,o)}function u(){var e,n,i,s,o,u,a,f,l,c={},h=t.viz.width,p=t.viz.height;a=r.moleculeContainers[0].scale(),f=a[0]/a[1],l=.7,r.thermometers&&(l-=.1),r.energyGraphs&&(l-=.45),o=h*l,u=o/f,u>p*.6&&(u=p*.6,o=u*f),c.moleculeContainers=[o,u],r.energyGraphs&&(c.energyGraphs=[h*.4,u*1.25]);for(viewType in r)if(r.hasOwnProperty(viewType)&&r[viewType].length){e=-1;while(++e<r[viewType].length)c[viewType]?r[viewType][e].resize(c[viewType][0],c[viewType][1]):r[viewType][e].resize()}}function a(){var e,t,n,i,s,o,u,a=.85,f={},l=$(window).width(),c=$(window).height(),h=$("#molecule-container").width();i=r.moleculeContainers[0].scale(),s=i[2]/i[3],o=.85,modelWidthPaddingFactor=i[0]/i[2]-1.05,o-=modelWidthPaddingFactor,modelHeightPaddingFactor=i[1]/i[3]-1.05,a-=modelHeightPaddingFactor,r.thermometers&&(o-=.05),r.energyGraphs&&(o-=.35),r.bottomItems=$("#bottom").children().length,r.bottomItems&&(a-=$("#bottom").height()*.0025),t=l*o,n=t/s,n>c*a&&(n=c*a,t=n*s),f.moleculeContainers=[t,n],r.energyGraphs&&(f.energyGraphs=[l*.4,n*1.2]);for(viewType in r)if(r.hasOwnProperty(viewType)&&r[viewType].length){e=-1;while(++e<r[viewType].length)f[viewType]?r[viewType][e].resize(f[viewType][0],f[viewType][1]):r[viewType][e].resize()}}function f(){var e,n,i,s,o,u=t.display.page.width,a=t.display.page.height;s=r.moleculeContainers[0].scale(),o=s[0]/s[1],n=u*.4,i=n*1/o,e=-1;while(++e<r.moleculeContainers.length)r.moleculeContainers[e].resize(n,i);if(r.appletContainers){e=-1;while(++e<r.appletContainers.length)r.appletContainers[e].resize(n,i)}}function l(){var e,n,i,s,o,u,a,f,l,c=t.display.page.width,h=t.display.page.height;s=r.moleculeContainers[0].scale(),l=s[0]/s[1],f=s[0]/c,n=c*.46,i=n*1/l,i>h*.7&&(i=h*.7,n=i*l),e=-1;while(++e<r.moleculeContainers.length)r.moleculeContainers[e].resize(n,i);a=(c-n)*.41,o=i*.42,e=-1;while(++e<r.potentialCharts.length)r.potentialCharts[e].resize(a,o);e=-1;while(++e<r.speedDistributionCharts.length)r.speedDistributionCharts[e].resize(a,o);u=(c-n)*.86,o=i*.57,e=-1;while(++e<r.energyCharts.length)r.energyCharts[e].resize(u,o)}function c(){var e,n,i,s,o;i=Math.min(t.display.page.height*.45,t.display.page.width*.5),r.moleculeContainers[0].resize(i,i),s=r.moleculeContainers[0].scale(),o=s[0]/t.display.page.width,o>.5&&(i*=.5/o,r.moleculeContainers[0].resize(i,i)),r.thermometers[0].resize()}function h(){var e,n,i,s,o,u=document.getElementById("description-right");i=Math.min(t.display.page.height*.65,t.display.page.width*.5),r.moleculeContainers[0].resize(i,i),s=r.moleculeContainers[0].scale(),o=s[0]/t.display.page.width,o>.5&&(i*=.5/o,r.moleculeContainers[0].resize(i,i)),r.thermometers[0].resize()}function p(){var e,n,i,s,o,u,a,f,l,c=t.display.page.width,h=t.display.page.height;s=r.moleculeContainers[0].scale(),l=s[0]/s[1],f=s[0]/c,n=c*.7,i=n*1/l,i>h*.7&&(i=h*.7,n=i*l),r.moleculeContainers[0].resize(n,i),s=r.moleculeContainers[0].scale(),r.thermometers[0].resize()}function d(){var e,n,i,s,o,u,a,f,l,c=t.display.page.width,h=t.display.page.height;s=r.moleculeContainers[0].scale(),l=s[0]/s[1],f=s[0]/c,n=c*.6,i=n*1/l,i>h*.6&&(i=h*.6,n=i*l),r.moleculeContainers[0].resize(n,i)}function v(){var e=document.getElementById("description-right");e===null}var n,r=t.views,i=document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen;e&&e.forceRender&&(t.not_rendered=!0),t.display=t.getDisplayProperties(),t.viz=t.getVizProperties(),t.regular_display||(t.regular_display=t.getDisplayProperties());if(i||t.fullScreenRender||t.screenEqualsPage()){t.fullScreenRender=!0,t.screen_factor_width=t.display.page.width/t.canonical.width,t.screen_factor_height=t.display.page.height/t.canonical.height,t.screen_factor=t.screen_factor_height,t.checkbox_factor=Math.max(.8,t.checkbox_scale*t.screen_factor),$("body").css("font-size",t.screen_factor+"em"),t.not_rendered=!0;switch(t.selection){case"simple-screen":t.not_rendered&&d();break;case"simple-static-screen":t.not_rendered&&d();break;case"simple-iframe":d(),v();break;case"compare-screen":n=Math.min(t.screen_factor_width*1.1,t.screen_factor_height),$("body").css("font-size",n+"em"),f(),t.not_rendered=!1;break;default:t.not_rendered&&l()}}else{t.cancelFullScreen||t.fullScreenRender?(t.cancelFullScreen=!1,t.fullScreenRender=!1,t.not_rendered=!0,t.regular_display=t.previous_display):t.regular_display=t.getDisplayProperties(),t.screen_factor_width=t.display.page.width/t.canonical.width,t.screen_factor_height=t.display.page.height/t.canonical.height,t.screen_factor=t.screen_factor_height,t.checkbox_factor=Math.max(.8,t.checkbox_scale*t.screen_factor);switch(t.selection){case"simple-screen":n=Math.min(t.screen_factor_width*1.1,t.screen_factor_height),$("body").css("font-size",n+"em"),c();break;case"simple-static-screen":t.not_rendered&&(n=Math.min(t.screen_factor_width*1.1,t.screen_factor_height),$("body").css("font-size",n+"em"),h(),t.not_rendered=!1);break;case"simple-iframe":n=Math.min(t.screen_factor_width*1.5,t.screen_factor_height),$("body").css("font-size",n+"em"),p();break;case"full-static-screen":t.not_rendered&&(n=Math.min(t.screen_factor_width*1.5,t.screen_factor_height),$("body").css("font-size",n+"em"),regularScreen(),t.not_rendered=!1);break;case"compare-screen":n=Math.min(t.screen_factor_width*1.1,t.screen_factor_height),$("body").css("font-size",n+"em"),f();break;case"interactive":t.not_rendered&&(t.setVizEmsize(),u(),t.not_rendered=!1);break;case"interactive-iframe":t.setBodyEmsize(),a();break;default:t.setVizEmsize(),o()}t.regular_display=t.getDisplayProperties()}t.transform&&$("input[type=checkbox]").css(t.transform,"scale("+t.checkbox_factor+","+t.checkbox_factor+")"),t.temperature_control_checkbox&&(model.addPropertiesListener(["temperature_control"],t.temperatureControlUpdate),t.temperatureControlUpdate());var s=document.getElementById("benchmarks-table");s&&(s.style.display="none")},t.getStyleForSelector=function(e){var t,n=document.styleSheets;for(var r=0;r<n.length;r++)if(n[r])try{t=n[r].rules||n[r].cssRules;if(t)for(var i=0;i<t.length;i++)if(t[i].selectorText==e)return t[i]}catch(s){}return!1},t.getPageHeight=function(){var e;return window.innerHeight?e=window.innerHeight:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientHeight:document.body&&(e=t.display.window.height),e},t.getPageWidth=function(){var e;return window.innerWidth?e=window.innerWidth:document.documentElement&&document.documentElement.clientWidth?e=document.documentElement.clientWidth:document.body&&(e=window.width),e},t.getTransformProperty=function(e){var t=["transform","WebkitTransform","msTransform","MozTransform","OTransform"],n;if(e)while(n=t.shift())if(typeof e.style[n]!="undefined")return n;return!1};var n=document.getElementById("description-right");return n!==null&&(t.fontsize=parseInt(t.getStyleForSelector("#description-right").style.fontSize)),t.transform=t.getTransformProperty(document.body),t}),n("md2d/views/molecule-container",["require","cs!common/components/play_reset_svg","cs!common/components/play_only_svg","cs!common/components/playback_svg","common/layout/layout"],function(e){var t=e("cs!common/components/play_reset_svg"),n=e("cs!common/components/play_only_svg"),r=e("cs!common/components/playback_svg"),i=e("common/layout/layout");return function(s,o){function un(e){e&&(o=e);if(o)for(var t in Dt)o[t]===undefined&&(o[t]=Dt[t]);else o=Dt;Pt=o.model,lt=o.get_results(),ct=o.get_radial_bond_results(),mt=o.get_obstacles,Ct=o.get_radial_bonds,Mt=o.get_vdw_pairs,ht=o.set_atom_properties,pt=o.is_stopped,kt=o.images,Lt=o.textBoxes||[],o.interactiveUrl&&(At=o.interactiveUrl,Ot=At.slice(0,At.lastIndexOf("/")+1)),o.showClock||(o.showClock=Pt.get("showClock")),Ht=Pt.INDICES.RADIUS+1,Bt=Pt.INDICES.PX+1,jt=Pt.INDICES.PY+1,Ft=Pt.INDICES.X+1,It=Pt.INDICES.Y+1,qt=Pt.INDICES.VX+1,Rt=Pt.INDICES.VY+1,Ut=Pt.INDICES.SPEED+1,zt=Pt.INDICES.AX+1,Wt=Pt.INDICES.AY+1,Xt=Pt.INDICES.CHARGE+1,Vt=Pt.INDICES.FRICTION+1,$t=Pt.INDICES.VISIBLE+1,Jt=Pt.INDICES.MARKED+1,Kt=Pt.INDICES.DRAGGABLE+1,Qt=Pt.INDICES.ELEMENT+1,Gt=Pt.INDICES.MASS+1,Yt=101,Zt=102,en=103,tn=104,nn=105,rn=106,sn=107,on=108}function an(e,t){var n=Pt.size(),r=n[0]/n[1];v=i.screen_factor,S={top:o.title?40*i.screen_factor:20,right:25,bottom:10,left:o.ylabel?60*i.screen_factor:25},o.xlabel&&(S.bottom+=35*v),o.controlButtons?S.bottom+=40*v:S.bottom+=15*v,o.fit_to_parent?(l=500,h=l-S.left-S.right,p=h/r,c=p+S.top+S.bottom):arguments.length?(h=e,p=t,l=h+S.left+S.right,c=p+S.top+S.bottom,a.style.height=c+"px",a.style.width=l+"px"):(c=u.property("clientHeight"),p=c-S.top-S.bottom,h=p*r,l=h+S.left+S.right,a.style.width=l+"px"),x={width:h,height:p},m=x.width/(n[0]*100),tt=a.offsetTop+S.top,et=a.offsetLeft+S.left;switch(o.controlButtons){case"play":F=S.left+(x.width-75*v)/2;break;case"play_reset":F=S.left+(x.width-140*v)/2;break;case"play_reset_step":F=S.left+(x.width-230*v)/2;break;default:F=S.left+(x.width-230*v)/2}return I=c-42*v,T=x.width,N=x.height,A=d3.scale.linear().domain([o.xmin,o.xmax]).range([0,T]),O=A.copy(),M=Math.NaN,_=d3.scale.linear().domain([o.ymax,o.ymin]).range([0,N]),H=d3.scale.linear().domain([o.ymin,o.ymax]).nice().range([0,N]).nice(),D=_.copy(),P=Math.NaN,B=null,[l,c,h,p]}function fn(){return R+q(Pt.getTime())+U}function ln(e,t,n,r,i){return ht(e,{x:t,y:n},r,i)}function cn(e){return vt[Pt.OBSTACLE_INDICES.X][e]}function hn(e){return vt[Pt.OBSTACLE_INDICES.Y][e]}function pn(e){return vt[Pt.OBSTACLE_INDICES.WIDTH][e]}function dn(e){return vt[Pt.OBSTACLE_INDICES.HEIGHT][e]}function vn(e){return"rgb("+vt[Pt.OBSTACLE_INDICES.COLOR_R][e]+","+vt[Pt.OBSTACLE_INDICES.COLOR_G][e]+","+vt[Pt.OBSTACLE_INDICES.COLOR_B][e]+")"}function mn(e){return vt[Pt.OBSTACLE_INDICES.VISIBLE][e]}function gn(e){return radialBonds[Pt.RADIAL_BOND_INDICES.ATOM1][e]}function yn(e){return radialBonds[Pt.RADIAL_BOND_INDICES.ATOM2][e]}function bn(e){return radialBonds[Pt.RADIAL_BOND_INDICES.LENGTH][e]}function wn(e){return radialBonds[Pt.RADIAL_BOND_INDICES.STRENGTH][e]}function En(e){return Et[Pt.VDW_INDICES.ATOM1][e]}function Sn(e){return Et[Pt.VDW_INDICES.ATOM2][e]}function xn(){function e(){d3.event&&d3.event.transform&&isNaN(M)&&isNaN(P)&&d3.event.transform(A,_);var e=A.tickFormat(10),t=_.tickFormat(10);if(o.xunits){var n=y.selectAll("g.x").data(A.ticks(10),String).attr("transform",C);n.select("text").text(e);var r=n.enter().insert("svg:g","a").attr("class","x").attr("transform",C);o.grid_lines&&r.append("svg:line").attr("stroke",L).attr("y1",0).attr("y2",x.height),r.append("svg:text").attr("y",x.height).attr("dy","1em").attr("text-anchor","middle").text(e),n.exit().remove()}if(o.xunits){var i=y.selectAll("g.y").data(_.ticks(10),String).attr("transform",k);i.select("text").text(t);var s=i.enter().insert("svg:g","a").attr("class","y").attr("transform",k).attr("background-fill","#FFEEB6");o.grid_lines&&s.append("svg:line").attr("stroke",L).attr("x1",0).attr("x2",x.width),s.append("svg:text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").text(t),o.showClock&&E.text(fn()),i.exit().remove()}}function i(){var e=d3.scale.linear().interpolate(d3.interpolateRgb).range(["#F2F2F2","#FF8080"]),t=d3.scale.linear().interpolate(d3.interpolateRgb).range(["#A4A4A4","#FF2020"]),n,r,i;X=y.append("g"),X.attr("class","image_container_below"),W=y.append("g"),W.attr("class","VDWLines_container"),z=y.append("svg").attr("class","container").attr("top",0).attr("left",0).attr("width",x.width).attr("height",x.height).attr("viewBox","0 0 "+x.width+" "+x.height),h("neg-grad","#ffefff","#fdadad","#e95e5e",z),h("pos-grad","#dfffff","#9abeff","#767fbf",z),h("neutral-grad","#FFFFFF","#f2f2f2","#A4A4A4",z),h("mark-grad","#fceabb","#fccd4d","#f8b500"
,z),h("green-grad","#dfffef","#75a643","#2a7216",z),h("purple-grad","#EED3F0","#D941E0","#84198A",z),h("aqua-grad","#DCF5F4","#41E0D8","#12827C",z),h("orange-grad","#F0E6D1","#E0A21B","#AD7F1C",z);for(i=0;i<Y;i++)n="ke-shading-"+i,r=i/Y,h(n,"#FFFFFF",e(r),t(r),z),G[i]="url('#"+n+"')";Q=["green-grad","purple-grad","aqua-grad","orange-grad"],_t=["#538f2f","#aa2bb1","#2cb6af","#b3831c","#7781c2","#ee7171"],V=y.append("g"),V.attr("class","image_container_top")}function h(e,t,n,r,i){gradient=i.append("defs").append("radialGradient").attr("id",e).attr("cx","50%").attr("cy","47%").attr("r","53%").attr("fx","35%").attr("fy","30%"),gradient.append("stop").attr("stop-color",t).attr("offset","0%"),gradient.append("stop").attr("stop-color",n).attr("offset","40%"),gradient.append("stop").attr("stop-color",r).attr("offset","80%"),gradient.append("stop").attr("stop-color",n).attr("offset","100%")}function p(e){var t,n,r;return e[Jt]?"url(#mark-grad)":Tt?(t=Pt.getAtomKineticEnergy(e[0]),n=Math.min(5*t,1),G[Math.round(n*(Y-1))]):St?(r=e[Xt],r===0?"url(#neutral-grad)":r>0?"url(#pos-grad)":"url(#neg-grad)"):"url('#"+Q[e[Qt]%4]+"')"}function T(){var e="1%";y.append("image").attr({id:"heat-bath",x:e,width:"3%",height:"3%",preserveAspectRatio:"xMinYMin","xlink:href":"../../resources/heatbath.gif"}),y.append("image").attr({id:"ke-gradient",x:e,width:"12%",height:"12%",preserveAspectRatio:"xMinYMin","xlink:href":"../../resources/ke-gradient.png"})}function N(){var e=Pt.get("temperature_control"),t,n,r=0,i=1;e?(r+=i,t=d3.select("#heat-bath").attr("y",r+"%").style("display",""),n=t.attr("height"),n=Number(n.substring(0,n.length-1)),r+=n):d3.select("#heat-bath").style("display","none"),Tt?(r+=i,d3.select("#ke-gradient").attr("y",r+"%").style("display","")):d3.select("#ke-gradient").style("display","none")}function O(){y.selectAll("circle").data(lt).attr("r",function(e){return A(e[Ht])})}function D(){nt.enter().append("circle").attr({"class":"draggable",r:function(e){return A(e[Ht])},cx:function(e){return A(e[Ft])},cy:function(e){return _(e[It])}}).style({"fill-opacity":function(e){return e[$t]},fill:p}).on("mousedown",jt).on("mouseover",Bt).on("mouseout",Yt).call(d3.behavior.drag().on("dragstart",rn).on("drag",yn).on("dragend",bn))}function B(){dt.enter().append("rect").attr({x:function(e,t){return A(cn(t))},y:function(e,t){return _(hn(t)+dn(t))},width:function(e,t){return A(pn(t))},height:function(e,t){return H(dn(t))}}).style({fill:function(e,t){return mn(t)?vn(t):"rgba(128,128,128, 0)"},"stroke-width":function(e,t){return mn(t)?.2:0},stroke:function(e,t){return mn(t)?vn(t):"rgba(128,128,128, 0)"}})}function q(){bt.enter().append("path").attr("d",function(e,t){return R(e,1)}).attr("class","radialbond1").style("stroke-width",function(e,t){return U(e)?.3*m:A(Math.min(lt[e[1]][Ht],lt[e[2]][Ht]))*.75}).style("stroke",function(e,t){var n,r,i;return U(e)?"#000000":St?(n=lt[e[1]][Xt],n>0?_t[4]:n<0?_t[5]:"#A4A4A4"):(r=lt[e[1]][Qt]%4,i=_t[r],i)}).style("fill","none"),wt.enter().append("path").attr("d",function(e){return R(e,2)}).attr("class","radialbond2").style("stroke-width",function(e,t){return U(e)?.3*m:A(Math.min(lt[e[1]][Ht],lt[e[2]][Ht]))*.75}).style("stroke",function(e,t){var n,r,i;return U(e)?"#000000":St?(n=lt[e[2]][Xt],n>0?_t[4]:n<0?_t[5]:"#A4A4A4"):(r=lt[e[2]][Qt]%4,i=_t[r],i)}).style("fill","none")}function R(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,g,y,b,w,E,S,x=10;u=A(e[6]),f=_(e[7]),a=A(e[8]),l=_(e[9]),s=a-u,o=l-f,S=Math.sqrt(s*s+o*o)/m,w=s/S,E=o/S,c=A(lt[e[1]][Ht])*w,h=A(lt[e[2]][Ht])*w,d=A(lt[e[1]][Ht])*E,v=A(lt[e[2]][Ht])*E,p=c-h,g=d-v;if(U(e)){var T=S/x;b="M "+u+","+f+" ";for(i=0;i<x;i++)i%2===0?(n=u+(i+.5)*w*T-.5*E*x,r=f+(i+.5)*E*T+.5*w*x):(n=u+(i+.5)*w*T+.5*E*x,r=f+(i+.5)*E*T-.5*w*x),y=" L "+n+","+r,b+=y;return b+=" L "+a+","+l}return t===1?"M "+u+","+f+" L "+(a+u+p)/2+" , "+(l+f+g)/2:"M "+(a+u+p)/2+" , "+(l+f+g)/2+" L "+a+","+l}function U(e){return e[5]===Pt.RADIAL_BOND_STYLES.RADIAL_BOND_SHORT_SPRING_STYLE}function $(){W.selectAll("line.attractionforce").remove();if(!Et)return;var e=Et[Pt.VDW_INDICES.COUNT],t,n,r;for(r=0;r<e;r++)t=En(r),n=Sn(r),(t!==0||n!==0)&&W.append("line").attr("class","attractionforce").attr("x1",A(lt[t][Ft])).attr("y1",_(lt[t][It])).attr("x2",A(lt[n][Ft])).attr("y2",_(lt[n][It])).style("stroke-width",2*m).style("stroke-dasharray",3*m+" "+2*m)}function J(){var e=[],t,n,r,i,s,o,u;V.selectAll("image").remove(),X.selectAll("image").remove();if(!kt)return;for(u=0;u<kt.length;u++)e[u]=new Image,e[u].src=Ot+kt[u].imageUri,e[u].onload=function(u){return function(){V.selectAll("image.image_attach"+u).remove(),X.selectAll("image.image_attach"+u).remove(),r=lt[kt[u].imageHostIndex],i=kt[u].imageHostType,s=kt[u].imageLayer,o=kt[u].imageX,imgY=kt[u].imageY,n=e[u].width*m,t=e[u].height*m,s===1?V.append("image").attr("x",function(){return i===""?o:A(r[Ft])-n/2}).attr("y",function(){return i===""?imgY:_(r[It])-t/2}).attr("class","image_attach"+u+" draggable").attr("xlink:href",e[u].src).attr("width",n).attr("height",t).attr("pointer-events","none"):X.append("image").attr("x",function(){return i===""?o:A(r[Ft])-n/2}).attr("y",function(){return i===""?imgY:_(r[It])-t/2}).attr("class","image_attach"+u+" draggable").attr("xlink:href",e[u].src).attr("width",n).attr("height",t).attr("pointer-events","none")}}(u)}function K(){var e,t,n;n=Pt.size(),e=z.selectAll(".textBox").data(Lt),e.enter().append("foreignObject").attr("class","textBox").append("xhtml:body"),e.exit().remove(),e.attr({width:A(n[0]),height:_(-n[1])}).each(function(e){d3.select(this).select("body").attr("class","textBoxBody").html(e.text)})}function st(){y.selectAll(".modelTimeLabel").remove(),o.showClock=Pt.get("showClock"),o.showClock&&(E=y.append("text").attr("class","modelTimeLabel").text(fn()).attr("x",10).attr("y",x.height-35).attr("dy","2.4em").style("text-anchor","start"))}function ot(){vt=mt(),ht(),xt(),yt(),ft(),st(),N(),J(),K()}function ft(){var e=lt.length<=100?1:.9;St=Pt.get("chargeShading"),Tt=Pt.get("keShading"),z.selectAll("circle").remove(),z.selectAll("g").remove(),nt=z.selectAll("circle").data(lt),D(),rt=z.selectAll("g.label").data(lt),it=rt.enter().append("g").attr("class","label").attr("transform",function(e){return"translate("+A(e[Ft])+","+_(e[It])+")"}),o.atom_mubers?it.append("text").attr("class","index").attr("font-size",function(t){return 1.6*e*A(t[Ht])}).attr("style","font-weight: bold; opacity: .7").attr("x",0).attr("y","0.31em").attr("pointer-events","none").text(d[0]):it.append("text").attr("class","index").attr("font-size",function(e){return 1.6*A(e[Ht])}).attr("style","font-weight: bold; opacity: .7").attr("x","-0.31em").attr("y","0.31em").attr("pointer-events","none").text(function(e){var t=e[Xt];if(St||Tt){if(t>0)return"+";if(t<0)return"-";return}})}function ht(){z.selectAll("rect").remove(),vt&&(gt.length=vt[0].length,dt=z.selectAll("rect").data(gt),B())}function yt(){z.selectAll("path.radialbond1").remove(),z.selectAll("path.radialbond2").remove(),radialBonds=Ct(),ct=o.get_radial_bond_results(),ct&&(bt=z.selectAll("path.radialbond1").data(ct),wt=z.selectAll("path.radialbond2").data(ct),q())}function xt(){W.selectAll("line.attractionforce").remove(),Nt=Pt.get("showVDWLines"),Nt&&At()}function At(){Et=Mt(),$()}function Dt(){a.focus()}function Bt(e,t){o.enableAtomTooltips&&Vt(t)}function jt(e,t){a.focus(),o.enableAtomTooltips&&(Z!==!1?(ut.style("opacity",1e-6),ut.style("display","none"),Z=!1):(d3.event.shiftKey?Z=t:Z=!1,Vt(t)))}function Vt(e){ut.style("opacity",1).style("display","inline").style("background","rgba(100%, 100%, 100%, 0.7)").style("left",A(lt[e][Ft])+et+60+"px").style("top",_(lt[e][It])+tt-30+"px").style("zIndex",100).transition().duration(250),at.text("atom: "+e+"\n"+"time: "+fn()+"\n"+"speed: "+d3.format("+6.3e")(lt[e][Ut])+"\n"+"vx:    "+d3.format("+6.3e")(lt[e][qt])+"\n"+"vy:    "+d3.format("+6.3e")(lt[e][Rt])+"\n"+"ax:    "+d3.format("+6.3e")(lt[e][zt])+"\n"+"ay:    "+d3.format("+6.3e")(lt[e][Wt])+"\n")}function Gt(e){}function Yt(){!Z&&Z!==0&&ut.style("opacity",1e-6).style(NaN)}function Zt(){vt&&dt.attr("x",function(e,t){return A(cn(t))}).attr("y",function(e,t){return _(hn(t)+dn(t))}),Nt&&At(),ct&&tn(),en(),kt&&kt.length!==0&&nn()}function en(){o.showClock&&E.text(fn()),nt.attr({cx:function(e){return A(e[Ft])},cy:function(e){return _(e[It])}}),Tt&&nt.style("fill",p),rt.attr("transform",function(e,t){return"translate("+A(e[Ft])+","+_(e[It])+")"}),(Z===0||Z>0)&&Vt(Z)}function tn(){bt.attr("d",function(e){return R(e,1)}),wt.attr("d",function(e){return R(e,2)})}function nn(){var e,t,n,r,i,s,o,u,a;e=kt.length;for(var f=0;f<e;f++)i=lt[kt[f].imageHostIndex],s=kt[f].imageHostType,u=kt[f].imageX,a=kt[f].imageY,o=kt[f].imageLayer,t=new Image,t.src=Ot+kt[f].imageUri,r=t.width*m,n=t.height*m,o==1?V.selectAll("image.image_attach"+f).attr("x",function(){return s===""?u:A(i[Ft])-r/2}).attr("y",function(){return s===""?a:_(i[It])-n/2}):X.selectAll("image.image_attach"+f).attr("x",function(){return s===""?u:A(i[Ft])-r/2}).attr("y",function(){return s===""?a:_(i[It])-n/2})}function rn(e,t){pt()?j=[e[Ft],e[It]]:e[Kt]&&Pt.liveDragStart(t)}function sn(e,t,n){return n.left+e<o.xmin&&(e=o.xmin-n.left),n.right+e>o.xmax&&(e=o.xmax-n.right),n.bottom+t<o.ymin&&(t=o.ymin-n.bottom),n.top+t>o.ymax&&(t=o.ymax-n.top),{x:e,y:t}}function on(e,t,n){return e<t?t:e>n?n:e}function gn(e,t){return{x:on(e,o.xmin,o.xmax),y:on(t,o.ymin,o.ymax)}}function yn(e,t){var n=A.invert(d3.event.x),r=_.invert(d3.event.y),i;pt()?(i=sn(n,r,Pt.getMoleculeBoundingBox(t)),ln(t,i.x,i.y,!1,!0),Zt()):e[Kt]&&(i=gn(n,r),Pt.liveDrag(i.x,i.y))}function bn(e,t){var n,r;pt()?(ln(t,e[Ft],e[It],!0,!0)||(alert("You can't drop the atom there"),ln(t,j[0],j[1],!1,!0)),Zt()):e[Kt]&&Pt.liveDragEnd()}function wn(e){e=e?e:window.event?event:null;if(e)switch(e.keyCode){case 32:Pt.is_stopped()?w.action("play"):w.action("stop"),e.preventDefault();break;case 13:w.action("play"),e.preventDefault()}}function Tn(){a.onkeydown=wn}an(),Pt.addPropertiesListener(["temperature_control"],N),Pt.addPropertiesListener(["keShading","chargeShading","showVDWLines","showClock"],ot),y===undefined?(o.fit_to_parent?(f=d3.select(s),u=f.append("div").attr("class","positioning-container").append("div").attr("class","molecules-view-aspect-container").attr("style","padding-top: "+Math.round(c/l*100)+"%").append("div").attr("class","molecules-view-svg-container"),a=u.node(),g=d3.select(a).append("svg").attr("viewBox","0 0 "+l+" "+c).attr("preserveAspectRatio","xMinYMin meet")):(f=u,g=d3.select(a).append("svg").attr("width",l).attr("height",c)),y=g.append("g").attr("transform","translate("+S.left+","+S.top+")"),b=y.append("rect").attr("class","plot").attr("width",x.width).attr("height",x.height).style("fill","#EEEEEE"),o.title&&y.append("text").attr("class","title").text(o.title).attr("x",x.width/2).attr("dy","-1em").style("text-anchor","middle"),o.xlabel&&y.append("text").attr("class","xlabel").text(o.xlabel).attr("x",x.width/2).attr("y",x.height).attr("dy","2.4em").style("text-anchor","middle"),o.ylabel&&y.append("g").append("text").attr("class","ylabel").text(o.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+x.height/2+") rotate(-90)"),ut=d3.select("#viz").append("div").attr("class","tooltip").style("opacity",1e-6),at=ut.append("pre"),d3.select(a).attr("tabindex",0).on("mousedown",Dt),Tn(),e(),i(),T()):(o.fit_to_parent||d3.select(a).select("svg").attr("width",l).attr("height",c),y.select("svg").attr("width",l).attr("height",c),y.select("rect.plot").attr("width",x.width).attr("height",x.height).style("fill","#EEEEEE"),y.select("svg.container").attr("top",0).attr("left",0).attr("width",x.width).attr("height",x.height).attr("viewBox","0 0 "+x.width+" "+x.height),o.title&&y.select("text.title").attr("x",x.width/2).attr("dy","-1em"),o.xlabel&&y.select("text.xlabel").attr("x",x.width/2).attr("y",x.height),o.ylabel&&y.select("text.ylabel").attr("transform","translate(-40 "+x.height/2+") rotate(-90)"),o.showClock&&E.text(fn()).attr("x",10).attr("y",x.height-35),y.selectAll("g.x").remove(),y.selectAll("g.y").remove(),o.playback_controller&&w.position(F,I,v),e()),d3.select(".model-controller").remove();switch(o.controlButtons){case"play":w=new n(g,model_player,F,I,v);break;case"play_reset":w=new t(g,model_player,F,I,v);break;case"play_reset_step":w=new r(g,model_player,F,I,v);break;default:w=null}xn.node=a,xn.outerNode=f.node(),xn.updateMoleculeRadius=O,xn.setup_drawables=ot,xn.update_drawable_positions=Zt,xn.scale=an,xn.playback_component=w,xn.options=o,xn.processOptions=un}var u=d3.select(s),a=u.node(),f,l=u.property("clientWidth"),c=u.property("clientHeight"),h,p,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=d3.format("5.0f"),R="",U=" (fs)",z,W,X,V,$,J,K,Q,G=[],Y=25,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt=[],yt=[],bt,wt,Et,St,xt=["+","-",""],Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt={fit_to_parent:!1,title:!1,xlabel:!1,ylabel:!1,controlButtons:"play",grid_lines:!1,xunits:!1,yunits:!1,atom_mubers:!1,enableAtomTooltips:!1,xmin:0,xmax:10,ymin:0,ymax:10},Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt,Gt,Yt,Zt,en,tn,nn,rn,sn,on;return un(),o.fit_to_parent||an(l,c),C=function(e,t){return"translate("+A(e)+",0)"},k=function(e,t){return"translate(0,"+_(e)+")"},L=function(e,t){return e?"#ccc":"#666"},xn.resize=function(e,t){o.fit_to_parent?f.style("width",e+"px"):xn.scale(e,t),xn.processOptions(),xn(),xn.setup_drawables()},xn.reset=function(e){xn.processOptions(e),xn(),xn.setup_drawables(),xn.updateMoleculeRadius()},a&&xn(),xn}}),function(){n("cs!common/components/model_player",["require"],function(e){var t;return t=function(){function e(e){this.model=e}return e.prototype.play=function(){return this.model.resume()},e.prototype.stop=function(){return this.model.stop()},e.prototype.forward=function(){return this.stop(),this.model.stepForward()},e.prototype.back=function(){return this.stop(),this.model.stepBack()},e.prototype.seek=function(e){return this.stop(),this.model.seek(e)},e.prototype.reset=function(){return this.model.reset()},e.prototype.isPlaying=function(){return!this.model.is_stopped()},e}()})}.call(this),n("md2d/controllers/model-controller",["require","md2d/models/modeler","md2d/views/molecule-container","cs!common/components/model_player"],function(e){var t=e("md2d/models/modeler"),n=e("md2d/views/molecule-container"),r=e("cs!common/components/model_player");return function(i,s,o){function B(){P.update_drawable_positions()}function j(){f=o.controlButtons,l=o.modelTimeLabel,h=o.enableAtomTooltips||!1,c=o.fit_to_parent,O=o.interactiveUrl,p=s.elements,d=s.atoms,v=s.mol_number,m=s.temperature_control,g=s.temperature,y=s.width,b=s.height,w=s.keShading,E=s.chargeShading,S=s.showVDWLines,M=s.showClock,_=s.viewRefreshInterval,D=s.timeStep,x=s.radialBonds,T=s.angularBonds,N=s.obstacles,C=s.viscosity,k=s.gravitationalField,L=s.images,A=s.textBoxes}function F(){j(),model=t({elements:p,temperature:g,temperature_control:m,width:y,height:b,keShading:w,chargeShading:E,showVDWLines:S,showClock:M,viewRefreshInterval:_,timeStep:D,viscosity:C,gravitationalField:k,images:L});if(d)model.createNewAtoms(d);else{if(!v)throw new Error("ModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(v),model.relax()}x&&model.createRadialBonds(x),T&&model.createAngularBonds(T),S&&model.createVdwPairs(d),N&&model.createObstacles(N)}function I(){F(),model.resetTime(),model.on("tick",B),model.on("addAtom",U)}function q(){return{model:model,fit_to_parent:c,xmax:y,ymax:b,keShading:w,chargeShading:E,enableAtomTooltips:h,images:L,interactiveUrl:O,textBoxes:A,get_results:function(){return model.get_results()},get_radial_bond_results:function(){return model.get_radial_bond_results()},get_radial_bonds:function(){return model.get_radial_bonds()},get_obstacles:function(){return model.get_obstacles()},get_vdw_pairs:function(){return model.get_vdw_pairs()},set_atom_properties:function(){return model.setAtomProperties.apply(model,arguments)},is_stopped:function(){return model.is_stopped()},controlButtons:f,modelTimeLabel:l}}function R(){model_player=new r(H,!1),model_player.forward=function(){},model_player.back=function(){},P=n(i,q()),P.updateMoleculeRadius(),P.setup_drawables()}function U(){P.reset(q()),P.updateMoleculeRadius(),P.setup_drawables()}function z(e,t){s=e||s,o=t||o,I(),U(),a.modelReset()}function W(){P.setup_drawables()}var u={},a=d3.dispatch("modelReset"),f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H={resume:function(){model.resume()},stop:function(){model.stop()},reset:function(){model.stop(),model.reset&&model.reset(),z(s,o)},is_stopped:function(){return model.is_stopped()}};if(typeof DEVELOPMENT=="undefined")try{I()}catch(X){throw alert(X),new Error(X)}else I();return R(),a.modelReset(),u.on=function(e,t){a.on(e,t)},u.reload=z,u.repaint=W,u.moleculeContainer=P,u}}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};n("cs!common/components/thermometer",["require"],function(t){var n;return n=function(){function t(t,n,r,i){this.dom_selector=t!=null?t:"#thermometer",this.value=n,this.min=r,this.max=i,this.resize=e(this.resize,this),this.dom_element=typeof this.dom_selector=="string"?$(this.dom_selector):this.dom_selector,this.dom_element.addClass("thermometer"),this.thermometer_fill=$("<div>").addClass("thermometer_fill"),this.dom_element.append(this.thermometer_fill),this.redraw()}return t.prototype.add_value=function(e){return this.value=e,this.redraw()},t.prototype.scaled_value=function(){return(this.value-this.min)/(this.max-this.min)},t.prototype.resize=function(){return this.redraw()},t.prototype.redraw=function(){return this.thermometer_fill.height(""+this.scaled_value()*this.dom_element.height()+"px")},t}()})}.call(this),n("common/layout/interactive-layout",["require","common/layout/layout"],function(e){function n(e,t){var n=$(".interactive-thermometer p.label").outerHeight(!0);$(".interactive-thermometer").height(t),t=$(".interactive-thermometer").height(),$(".interactive-thermometer .thermometer").height(t-n),e.redraw()}var t=e("common/layout/layout");return function(){var r,i,s,o,u,a,f,l,c={},h,p=$("#content").width(),d=$("#content").height(),v;l=t.views,i=$(l.moleculeContainers[0].outerNode).width(),s=$(l.moleculeContainers[0].outerNode).height(),a=i/s,f=.6,l.energyGraphs&&(f=.5),o=p*f,u=o/a,c.moleculeContainers=[o,u],l.energyGraphs&&(c.energyGraphs=[p*.45,u]);for(h in l)if(l.hasOwnProperty(h)&&l[h].length){r=-1;while(++r<l[h].length)c[h]?l[h][r].resize(c[h][0],c[h][1]):l[h][r].resize()}s=$(l.moleculeContainers[0].outerNode).height(),t.views.thermometers&&n(t.views.thermometers[0],.8*s),l.energyGraphs&&$(l.moleculeContainers[0].outerNode).css("top",5)}}),n("md2d/controllers/interactives-controller",["require","md2d/controllers/model-controller","cs!common/components/thermometer","common/layout/layout","common/layout/interactive-layout"],function(e){var t=e("md2d/controllers/model-controller"),n=e("cs!common/components/thermometer"),r=e("common/layout/layout"),i=e("common/layout/interactive-layout");return function(s,o,u,a){function E(){window.script=$.extend({},w),window.script.run=function(e,t){var n,r=[],i=[];for(n in t)t.hasOwnProperty(n)&&(r.push(n),i.push(t[n]));return T.apply(null,r.concat(e)).apply(null,i)}}function S(e){e=ACTUAL_ROOT+e,$.get(e).done(function(e){e=typeof e=="string"?JSON.parse(e):e,l?l.reload(e,p):(l=t("#molecule-container",e,p),j(),l.on("modelReset",j),f.modelController=l)})}function x(e){switch(e.type){case"button":return C(e);case"checkbox":return k(e);case"pulldown":return L(e);case"thermometer":return m=O(e),m;case"energyGraph":return _(e);case"slider":return A(e)}}function T(){var e,t,n,r,i=Array.prototype.slice.call(arguments,0,arguments.length-1),s=arguments[arguments.length-1];t=[],n=[];for(e in w)w.hasOwnProperty(e)&&i.indexOf(e)<0&&(t.push(e),n.push(w[e]));return r="return function("+i.join(",")+") { 'use "+"strict'; "+s+"};",function(){var e,i,o,u;i=[];for(e in window)window.hasOwnProperty(e)&&!w.hasOwnProperty(e)&&i.push(e);o=t.concat(i).concat(r);try{u=Function.apply(null,o).apply(null,n)}catch(a){alert('Error compiling script: "'+a.toString()+'"\nScript:\n\n'+s)}try{return u.apply(null,Array.prototype.slice.call(arguments))}catch(a){alert('Error running script: "'+a.toString()+'"\nScript:\n\n'+s)}}}function N(e){return typeof e=="string"?e:e.join("\n")}function C(e){var t,n;return t=$("<button>").attr("id",e.id).html(e.text),t.addClass("component"),n=N(e.action),t.click(T(n)),{elem:t}}function k(e){var t=e.property,n=e.action,r,i;return r=$('<input type="checkbox">').attr("id",e.id),i=$("<label>").append(r).append(e.text),i.addClass("component"),n&&(n=N(n),n=T("value",n)),t!==undefined&&u.push(function(){var e=function(){var e=model.get(t);e?r.attr("checked",!0):r.attr("checked",!1)};model.addPropertiesListener([t],e),e()}),r.click(function(){var e=!1,r;$(this).is(":checked")&&(e=!0),t!==undefined&&(r={},r[t]=e,model.set(r)),n!==undefined&&n(e)}),{elem:i}}function L(e){var t,n,r=e.options||[],i,s,o;t=$("<select>").attr("id",e.id),t.addClass("component");for(s=0,o=r.length;s<o;s++)i=r[s],n=$("<option>").html(i.text),i.disabled&&n.attr("disabled",i.disabled),i.selected&&n.attr("selected",i.selected),t.append(n);return t.change(function(){var t=$(this).prop("selectedIndex"),n=e.options[t].action,r;n?(r=N(n),T(r)()):e.options[t].loadModel&&(model.stop(),S(e.options[t].loadModel))}),{elem:t}}function A(e){var t=e.min,n=e.max,r=e.steps,i=e.action,s=e.property,o=e.initialValue,a=e.title||"",f=e.labels||[],l,c,h,p,d,v,m;t==null&&(t=0),n==null&&(n=10),r==null&&(r=10),h=$('<p class="title">'+a+"</p>"),m=$('<div class="container">'),v=$('<div class="html-slider">'),m.append(v),v.slider({min:t,max:n,step:(n-t)/r}),c=$('<div class="interactive-slider">').append(h).append(m);for(l=0;l<f.length;l++)p=f[l],d=$('<p class="label">'+p.label+"</p>"),d.css("left",(p.value-t)/(n-t)*100+"%"),m.append(d);return i&&(i=T("value",i),v.bind("slide",function(e,t){i(t.value)})),s&&(v.bind("slide",function(e,t){var n={};n[s]=t.value,model&&model.set(n)}),u.push(function(){model.addPropertiesListener([s],function(){v.slider("value",model.get(s))})})),o!=null?(i&&u.push(function(){v.slider("value",o),i(o)}),s&&u.push(function(){var e={};e.propertyName=o,model.set(e)})):s&&u.push(function(){v.slider("value",model.get(s))}),{elem:c}}function O(e){function d(e){e=o*e+s,l.text(e.toFixed(u)+" "+i)}var t=$("<div>").attr("id",e.id),r,i="K",s=0,o=1,u=0,a=!!e.labelIsReading,f=a?"":"Thermometer",l=$('<p class="label">').text(f).width("6em"),c=$('<div class="interactive-thermometer">').append(t).append(l),h=new n(t,null,e.min,e.max),p;if(r=e.reading)r.units!=null&&(i=r.units),r.offset!=null&&(s=r.offset),r.scale!=null&&(o=r.scale),r.digits!=null&&(u=r.digits);return M(["temperature"],function(){p.update()}),p={elem:c,component:h,callback:function(){h.resize(),p.update()},update:function(){var e=model.get("temperature");h.add_value(e),a&&d(e)}}}function M(e,t){typeof model!="undefined"?model.addPropertiesListener(e,t):h.push([e,t])}function _(e){var t=$("<div>").attr("id",e.id);return{elem:t,callback:function(){var t=e,n=$("#"+t.id),r=model.get("viewRefreshInterval")/1e3,i={title:"Energy of the System (KE:red, PE:green, TE:blue)",xlabel:"Model Time (ps)",xmin:0,xmax:20,sample:r,ylabel:"eV",ymin:-5,ymax:5};B(),model.addPropertiesListener(["viewRefreshInterval"],function(){i.sample=model.get("viewRefreshInterval")/1e3,g.reset(i)}),g?(r=model.get("viewRefreshInterval")/1e3,i.sample=r,$.extend(i,t.options||[]),g.reset("#"+t.id,i,n[0])):($.extend(i,t.options||[]),D(t.id,i)),t.dimensions&&g.resize(t.dimensions.width,e.dimensions.height),model.on("tick.energyGraph",P),model.on("play.energyGraph",function(){g.number_of_points()&&model.stepCounter()<g.number_of_points()&&(B(model.stepCounter()),g.new_data(y)),g.show_canvas()}),model.on("reset.energyGraph",function(){r=model.get("viewRefreshInterval")/1e3,i.sample=r,B(),g.reset("#"+t.id,i),g.new_data(y)}),model.on("seek.energyGraph",function(){var e=model.stepCounter();e>0?B(e):B(),g.new_data(y)})}}}function D(e,t){t=t||{},t.dataset=y,g=grapher.realTimeGraph("#"+e,t)}function P(){g.add_points(H())}function H(){var e=model.ke(),t=model.pe(),n=e+t;return y[0].push(e),y[1].push(t),y[2].push(n),[e,t,n]}function B(e){var t=model.stepCounter(),n,r;if(e){for(n=0,r=y.length;n<r;n++)y[n].length=t;return e}return y=[[0],[0],[0]],0}function j(){var e,t;for(e=0;e<d.length;e++)d[e]();r.addView("moleculeContainers",l.moleculeContainer),m&&r.addView("thermometers",m.component),g&&r.addView("energyGraphs",g),$(window).unbind("resize"),a?(r.selection=a,r.setupScreen(),b||(r.setupScreen(),b=!0),$(window).on("resize",r.setupScreen)):(i(),$(window).on("resize",i));for(e=0;e<h.length;e++)t=h[e],model.addPropertiesListener(t[0],t[1]);for(e=0;e<v.length;e++)v[e]();for(e=0;e<u.length;e++)u[e]()}function F(e,t){var n,r,i={},o,u,f,l,h,m,g,y,b,w;d=[],s=e,c=$(t),c.children().length===0?(h=$('<div class="interactive-top" id="top"/>'),h.append('<div class="interactive-top" id="molecule-container"/>'),s.layout&&s.layout.right&&(m=$('<div class="interactive-top" id="right"/>'),h.append(m)),s.layout&&s.layout.rightwide&&(g=$('<div class="interactive-top" id="rightwide"/>'),h.append(g)),c.append(h),c.append('<div class="interactive-bottom" id="bottom"/>')):(y=$("#bottom"),m=$("#right"),g=$("#rightwide"),y.html(""),m&&m.empty(),g&&g.empty());if(s.model!=null){var E=s.model.onLoad;n=s.model.url,s.model.viewOptions?p=$.extend(!0,{},s.model.viewOptions):p={controlButtons:"play"},p.fit_to_parent=!a,p.interactiveUrl=n,E!=null&&v.push(T(N(E)))}n&&S(n),r=s.components||[];for(b=0,w=r.length;b<w;b++)o=x(r[b]),i[r[b].id]=o;if(s.layout)for(f in s.layout)if(s.layout.hasOwnProperty(f)){u=s.layout[f];for(b=0,w=u.length;b<w;b++)l=u[b],i[l]&&($("#"+f).append(i[l].elem),i[l].callback&&d.push(i[l].callback),delete i[l])}for(l in i)i.hasOwnProperty(l)&&$("#bottom").append(i[l].elem)}u=u||[];var f={},l,c,h=[],p,d=[],v=[],m,g,y=[[],[],[]],b=!1,w=function(){function e(e){return typeof e=="number"&&parseFloat(e)===parseInt(e,10)}function t(e){return typeof e=="object"&&e.slice===Array.prototype.slice}function n(e){return Math.floor(Math.random()*e)}function r(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function i(e,t){var i=[],s;for(s=0;s<t;s++)i[s]=s;for(s=0;s<e;s++)r(i,s,s+n(t-s));return i.length=e,i}return{deg2rad:Math.PI/180,rad2deg:180/Math.PI,addAtom:function(){return model.addAtom.apply(model,arguments)},addRandomAtom:function(){return model.addRandomAtom.apply(model,arguments)},get:function(){return model.get.apply(model,arguments)},set:function(){return model.set.apply(model,arguments)},adjustTemperature:function(t){model.set({temperature:t*model.get("temperature")})},limitHighTemperature:function(t){model.get("temperature")>t&&model.set({temperature:t})},loadModel:function(t,n){model.stop(),f.loadModel(t),v=[],typeof n=="function"&&v.push(n)},randomAtoms:function(r){var s=model.get_num_atoms();r==null&&(r=1+n(s-1));if(!e(r))throw new Error("randomAtoms: number of atoms requested, "+r+", is not an integer.");if(r<0)throw new Error("randomAtoms: number of atoms requested, "+r+", was less be greater than zero.");return r>s&&(r=s),i(r,s)},markAtoms:function s(){var e,n;if(arguments.length===0)return;if(t(arguments[0]))return s.apply(null,arguments[0]);w.unmarkAllAtoms();for(e=0,n=arguments.length;e<n;e++)model.setAtomProperties(arguments[e],{marked:1});w.repaint()},unmarkAllAtoms:function(){for(var t=0,n=model.get_num_atoms();t<n;t++)model.setAtomProperties(t,{marked:0});w.repaint()},setAtomProperties:function(t,n,r,i){model.setAtomProperties(t,n,r,i),w.repaint()},getAtomProperties:function(t){return model.getAtomProperties(t)},onPropertyChange:function(t,n){model.addPropertiesListener([t],function(){n(model.get(t))})},setElementProperties:function(t,n){model.setElementProperties(t,n),w.repaint()},getElementProperties:function(t){return model.getElementProperties(t)},setRadialBondProperties:function(t,n){model.setRadialBondProperties(t,n),w.repaint()},getRadialBondProperties:function(t){return model.getRadialBondProperties(t)},setAngularBondProperties:function(t,n){model.setAngularBondProperties(t,n),w.repaint()},getAngularBondProperties:function(t){return model.getAngularBondProperties(t)},pe:function(){return model.pe()},ke:function(){return model.ke()},start:function(){model.start()},stop:function(){model.stop()},reset:function(){model.stop(),l.reload()},tick:function(){model.tick()},repaint:function(){l.repaint()},alert:alert,console:window.console!=null?window.console:{log:function(){},error:function(){},warn:function(){},dir:function(){}}}}();return F(s,o),E(),f.loadInteractive=F,f.loadModel=S,f}}),n("md2d/views/applet-container",["require","common/layout/layout"],function(e){var t=e("common/layout/layout");return function(n,r){function N(e,n){return arguments.length?(u=n,o=e):(u=i.property("clientHeight"),o=i.property("clientWidth")),a&&(l=+a.runMwScript("mw2d:1:get %width"),c=+a.runMwScript("mw2d:1:get %height"),h=l/c,u=o*1/h*1.25),s.style.width=o+"px",s.style.height=u+"px",v=t.screen_factor,t.screen_factor_width&&t.screen_factor_height&&(v=Math.min(t.screen_factor_width,t.screen_factor_height)),v=o/600,m={top:5,right:5,bottom:5,left:5},d=u-m.top-m.bottom,p=o-m.left-m.right,g={width:p,height:d},[o,u]}function C(){function e(){var e,t,n;n=['<applet id="'+r.appletID+'", codebase="'+r.codebase+'", code="'+r.code+'"','     width="'+r.width+'" height="'+r.height+'" MAYSCRIPT="true"','     archive="'+r.archive+'">','     MAYSCRIPT="true">'];for(e=0;e<r.params.length;e++)t=r.params[e],n.push('  <param name="'+t[0]+'" value="'+t[1]+'"/>');return n.push('  <param name="MAYSCRIPT" value="true"/>'),n.push("  Your browser is completely ignoring the applet tag!"),n.push("</applet>"),n.join("\n")}a===undefined?(f=e(),s.innerHTML=f,a=document.getElementById(r.appletID)):(a.style.width=g.width,a.style.height=g.height,a.width=g.width,a.height=g.height),C.node=s,C.scale=N,C.applet=a}var i=d3.select(n),s=i.node(),o=i.property("clientWidth"),u=i.property("clientHeight"),a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x={appletID:"mw-applet",codebase:"/jnlp",code:"org.concord.modeler.MwApplet",width:"100%",height:"100%",archive:"org/concord/modeler/unsigned/mw.jar",align:"left",hspace:"5",vspace:"5",params:[["script","page:0:import /imports/legacy-mw-content/potential-tests/two-atoms-two-elements/two-atoms-two-elements.cml"]]};if(r)for(var T in x)r[T]===undefined&&(r[T]=x[T]);else r=x;return N(o,u),C.resize=function(e,t){C.scale(e,t)},s&&C(),C}}),function(){n("cs!common/components/slider",["require"],function(e){var t;return t=function(){function e(e,t,n,r,i){this.dom_id=e!=null?e:"#slider",this.value_changed_function=t,this.min=n,this.max=r,this.value=i,this.dom_element=$(this.dom_id),this.dom_element.addClass("component").addClass("slider"),this.min=this.min||this.dom_element.attr("data-min")||0,this.max=this.max||this.dom_element.attr("data-max")||1,this.value=this.value||this.dom_element.attr("data-value")||.5,this.precision=this.dom_element.attr("data-precision")||3,this.label=this.dom_element.attr("data-label"),this.domain=this.max-this.min,this.mouse_down=!1,this.width=this.dom_element.width(),this.height=this.dom_element.height(),this.init_view(),this.init_mouse_handlers()}return e.prototype.horizontal_orientation=function(){if(this.width>this.height)return!0},e.prototype.init_view=function(){var e;return this.slider_well=$("<div>").addClass("slider_well"),this.dom_element.append(this.slider_well),e=this.width/2,this.y1=this.height,this.y2=0,this.x1=this.x2=e,this.handle_y=(this.y1+this.y2)/2,this.handle_x=(this.x1+this.x2)/2,this.horizontal_orientation()&&(e=this.height/4,this.y1=this.y2=e,this.x1=0,this.x2=this.width,this.handle_y=(this.y1+this.y2)/2,this.handle_x=this.value/this.domain*this.width),this.init_slider_fill(),this.slider_well_height=this.slider_well.height(),this.slider_well_width=this.slider_well.width(),this.init_handle(),this.init_label()},e.prototype.init_slider_fill=function(){return this.slider_fill=$("<div>").addClass("slider_fill"),this.slider_well.append(this.slider_fill),this.horizontal_orientation()?this.slider_fill.addClass("horizontal"):this.slider_fill.addClass("vertical"),this.update_slider_filled()},e.prototype.update_slider_filled=function(){return this.horizontal_orientation()?this.slider_fill.width(""+this.handle_x+"px"):this.slider_fill.height(""+this.handle_y+"px")},e.prototype.init_handle=function(){return this.handle=$("<div>").addClass("handle"),this.slider_well.append(this.handle),this.handle_width=parseInt(this.handle.width()),this.handle_height=parseInt(this.handle.height()),this.handle_width_offset=this.handle_width/2-(this.handle_width-this.slider_well_width
)/2,this.handle_height_offset=this.handle_height/2-(this.handle_height-this.slider_well_height)/4,this.update_handle()},e.prototype.update=function(){return this.update_handle(),this.update_slider_filled(),this.update_label()},e.prototype.update_handle=function(){return this.handle.css("left",""+(this.handle_x-this.handle_width/2)+"px").css("top",""+(this.handle_y-this.handle_height_offset)+"px")},e.prototype.init_label=function(){return this.text_label=$("<div/>").addClass("label"),this.dom_element.append(this.text_label),this.update_label()},e.prototype.set_scaled_value=function(e){return this.value=(e-this.min)/this.domain,this.handle_x=e/this.domain*this.width,this.update()},e.prototype.scaled_value=function(){var e;return e=this.value,e*=this.max-this.min,e+=this.min,e},e.prototype.update_label=function(){var e;return this.label?(e=this.scaled_value().toFixed(this.precision),this.text_label.text(""+this.label+": "+e)):this.text_label.hide()},e.prototype.handle_mousedown=function(e){var t=this;return this.dragging=!0,$(document).bind("mouseup.drag",this.documentMouseUpDelegate=function(e){return t.handle_mouseup(e)}),$(document).bind("mousemove.drag",this.documentMouseMoveDelegate=function(e){return t.handle_drag(e)}),this.handle_drag(e)},e.prototype.handle_drag=function(e){var t,n,r,i;return this.dragging?(document.onselectstart=function(){return!1},r=e.pageX-this.slider_well.position().left,i=e.pageY-this.slider_well.position().top,this.horizontal_orientation()?(t=this.width-this.handle_width/4,n=this.handle_width/4,this.handle_x=r,this.handle_x<n&&(this.handle_x=n),this.handle_x>t&&(this.handle_x=t),this.value=this.handle_x/this.width):(this.handle_y=e.y,this.handle.attr("cy",this.handle_y),this.slider_fill.attr("y",this.handle_y).attr("height",this.height-this.handle_y),this.value=this.handle_y/this.height),typeof this.value_changed_function=="function"&&this.value_changed_function(this.scaled_value()),this.update()):!1},e.prototype.handle_mouseup=function(){return document.onselectstart=function(){return!0},this.dragging&&($(document).unbind("mousemove",this.documentMouseMoveDelegate),$(document).unbind("mouseup",this.documentMouseUpDelegate),this.dragging=!1),!0},e.prototype.init_mouse_handlers=function(){var e=this;return this.slider_well.bind("mousedown",this.documentMouseUpDelegate=function(t){return e.handle_mousedown(t)})},e}()})}.call(this),n("md2d/controllers/compare-models-controller",["require","md2d/models/modeler","md2d/views/applet-container","md2d/views/molecule-container","cs!common/components/model_player","cs!common/components/thermometer","cs!common/components/slider","common/layout/layout"],function(e){var t=e("md2d/models/modeler"),n=e("md2d/views/applet-container"),r=e("md2d/views/molecule-container"),i=e("cs!common/components/model_player"),s=e("cs!common/components/thermometer"),o=e("cs!common/components/slider"),u=e("common/layout/layout");return function(s,o,a,f,l){function nt(){function e(e){j.update_drawable_positions()}function p(){controlButtons=l.controlButtons,modelTimeLabel=l.modelTimeLabel,enableAtomTooltips=l.enableAtomTooltips||!1,fit_to_parent=l.fit_to_parent,interactiveUrl=l.interactiveUrl,m=f.elements,g=f.atoms,y=f.mol_number,b=f.temperature_control,w=f.temperature,E=f.width,S=f.height,x=f.keShading,T=f.chargeShading,N=f.showVDWLines,C=f.showClock,k=f.viewRefreshInterval,L=f.timeStep,A=f.radialBonds,O=f.angularBonds,M=f.obstacles,_=f.viscosity,D=f.gravitationalField,P=f.images,H=f.textBoxes}function d(){p(),model=t({elements:m,temperature:w,temperature_control:b,width:E,height:S,keShading:x,chargeShading:T,showVDWLines:N,showClock:C,viewRefreshInterval:k,timeStep:L,viscosity:_,gravitationalField:D,images:P});if(g)model.createNewAtoms(g);else{if(!y)throw new Error("ModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(y),model.relax()}A&&model.createRadialBonds(A),O&&model.createAngularBonds(O),N&&model.createVdwPairs(g),M&&model.createObstacles(M)}function v(){return{model:model,fit_to_parent:fit_to_parent,xmax:E,ymax:S,keShading:x,chargeShading:T,enableAtomTooltips:enableAtomTooltips,images:P,interactiveUrl:interactiveUrl,textBoxes:H,get_results:function(){return model.get_results()},get_radial_bond_results:function(){return model.get_radial_bond_results()},get_radial_bonds:function(){return model.get_radial_bonds()},get_obstacles:function(){return model.get_obstacles()},get_vdw_pairs:function(){return model.get_vdw_pairs()},set_atom_properties:function(){return model.setAtomProperties.apply(model,arguments)},is_stopped:function(){return model.is_stopped()},controlButtons:controlButtons,modelTimeLabel:modelTimeLabel}}function F(){u.selection=c,model_player=new i(model,h),j=r(s,v()),j.updateMoleculeRadius(),j.setup_drawables(),K=st(),K?V={params:[["script","page:0:import /imports/legacy-mw-content/"+K]]}:V={},X=n(o,V),u.addView("moleculeContainers",j),u.addView("appletContainers",X),u.setupScreen()}function q(){model.stop()}function R(){model.on("tick",e),model.resume()}function z(){model.stop(),model.stepBack()}function W(){model.stop(),model.stepForward()}function J(){model.stop(),d(),rt(),e()}function rt(){B=model.get_atoms(),model.resetTime(),q(),model.on("tick",e),I=model.stepCounter()}function it(){return tt=document.location.hash,tt.length>0?tt.substr(1,tt.length):!1}function st(){var e=it();return e?et[e.replace("/imports/legacy-mw-content/","")].cmlPath:!1}function ot(){var e=it();e?Z.value=e.replace("/imports/legacy-mw-content/",""):Z.value="two-atoms-two-elements/two-atoms-two-elements$0.json"}function ut(){var e,t,n,r,i;et={};for(e=0;e<modelList.length;e++){r=modelList[e],i=r.section;for(t=0;t<r.content.length;t++)n=r.content[t],et[n.json]={name:n.name,jsonPath:n.json,cmlPath:n.cml}}}function at(){ut(),d3.select(Z).selectAll("optgroup").data(modelList).enter().append("optgroup").attr("label",function(e){return e.section}).selectAll("option").data(function(e){return e.content}).enter().append("option").text(function(e){return e.name}).attr("value",function(e){return e.json}).attr("data-cml-path",function(e){return e.cml}),ot()}function ft(e){return X.applet.runMwScript(e)}function lt(){var e=$(Z).find("option:selected"),t="/imports/legacy-mw-content/",n=e.attr("value");U=t+n,document.location.hash="#"+U}function ct(){st()&&(V={params:[["script","page:0:import "+st()]]},X=n(o,V),ft("page:0:set frank false"),u.setView("appletContainers",[X]),u.setupScreen())}function ht(){u.setupScreen()}function pt(){at(),d(),rt(),F(),ot()}Z=document.getElementById(a),Q=document.getElementById("start"),Q.onclick=function(){ft("mw2d:1:run"),R()},G=document.getElementById("stop"),G.onclick=function(){ft("mw2d:1:stop"),q()},Y=document.getElementById("reset"),Y.onclick=function(){ft("mw2d:1:reset"),J()},Z.onchange=lt,document.onwebkitfullscreenchange=ht,window.onresize=ht;if(typeof DEVELOPMENT=="undefined")try{pt()}catch(dt){throw alert(dt),new Error(dt)}else pt();nt.runMWScript=ft}var c=l.layoutStyle,h=l.autostart,p=l.maximum_model_steps,d=l.lj_epsilon_max,v=l.lj_epsilon_min,m=f.elements,g=f.atoms,y=f.mol_number,b=f.temperature_control,w=f.temperature,E=f.width,S=f.height,x=f.keShading,T=f.chargeShading,N=f.showVDWLines,C=f.showClock,k=f.viewRefreshInterval,L=f.timeStep,A=f.radialBonds,O=f.angularBonds,M=f.obstacles,_=f.viscosity,D=f.gravitationalField,P=f.images,H=f.textBoxes,B,j,F,I,q,R,U,z,W,X,V={},J,K,Q,G,Y,Z,et,tt;return nt(),nt}}),n("common/benchmark/benchmark",["require"],function(e){function i(){var e=/ (Chrome)\/(.*?) /,t=/ (Firefox)\/([0123456789ab.]+)/,r=/ AppleWebKit\/([0123456789.+]+) \(KHTML, like Gecko\) Version\/([0123456789.]+) (Safari)\/([0123456789.]+)/,i=/ (MSIE) ([0123456789.]+);/,o=/^(Opera)\/.+? Version\/([0123456789.]+)$/,u=/.+?\((iPhone); CPU.+?OS .+?Version\/([0123456789._]+)/,a=/.+?\((iPad); CPU.+?OS .+?Version\/([0123456789._]+)/,f=/.+?\((iPod); CPU (iPhone.+?) like.+?Version\/([0123456789ab._]+)/,l=/.+?(Android) ([0123456789.]+).*?; (.+?)\).+? Chrome\/([0123456789.]+)/,c=/.+?(Android.+?\)).+? Firefox\/([0123456789.]+)/,h=/.+?(Android) ([0123456789ab.]+).*?; (.+?)\)/,p;p=navigator.userAgent.match(e);if(p&&p[1])return{browser:p[1],version:p[2],oscpu:s()};p=navigator.userAgent.match(t);if(p&&p[1]){var d=navigator.buildID,v="";return d&&d.length>=8&&(v="("+d.slice(0,4)+"-"+d.slice(4,6)+"-"+d.slice(6,8)+")"),{browser:p[1],version:p[2]+" "+v,oscpu:s()}}p=navigator.userAgent.match(l);if(p&&p[1])return{browser:"Chrome",version:p[4],oscpu:p[1]+"/"+p[2]+"/"+p[3]};p=navigator.userAgent.match(c);if(p&&p[1])return{browser:"Firefox",version:p[2],oscpu:p[1]};p=navigator.userAgent.match(h);if(p&&p[1])return{browser:"Android",version:p[2],oscpu:p[1]+"/"+p[2]+"/"+p[3]};p=navigator.userAgent.match(r);if(p&&p[3])return{browser:p[3],version:p[2]+"/"+p[1],oscpu:s()};p=navigator.userAgent.match(i);if(p&&p[1]){var m=navigator.userAgent.match(/\(.*?(Windows.+?); (.+?)[;)].*/);return{browser:p[1],version:p[2],oscpu:n[m[1]]+"/"+navigator.cpuClass+"/"+navigator.platform}}return p=navigator.userAgent.match(o),p&&p[1]?{browser:p[1],version:p[2],oscpu:s()}:(p=navigator.userAgent.match(u),p&&p[1]?{browser:"Mobile Safari",version:p[2],oscpu:p[1]+"/"+"iOS"+"/"+p[2]}:(p=navigator.userAgent.match(a),p&&p[1]?{browser:"Mobile Safari",version:p[2],oscpu:p[1]+"/"+"iOS"+"/"+p[2]}:(p=navigator.userAgent.match(f),p&&p[1]?{browser:"Mobile Safari",version:p[3],oscpu:p[1]+"/"+"iOS"+"/"+p[2]}:{browser:"",version:navigator.appVersion,oscpu:""})))}function s(){var e=navigator.userAgent.match(/\((.+?)[;)] (.+?)[;)].*/);if(!e)return"na";if(e[1]==="Macintosh")return e[2];if(e[1].match(/^Windows/)){var t=r[e[2]]||"32",i=navigator.userAgent.match(/\(.*?(Windows NT.+?)[;)]/);return n[i[1]]+"/"+t}}function o(e,t){function a(){return e.appendChild(document.createElement("tr"))}function c(e,t,n){var r;n=n||"td",r=e.appendChild(document.createElement(n)),typeof t=="string"&&t.slice(0,1)==="<"?r.innerHTML=t:r.textContent=t}function h(e,t){u&&c(f,e,"th"),c(l,t)}var n=0,r,s,o=[];e.style.display="";var u=e.getElementsByTagName("tr").length===0,f=a(),l=a();s=i(),h("browser",s.browser),h("version",s.version),h("cpu/os",s.oscpu);var p=d3.time.format("%Y-%m-%d %H:%M");h("date",p(new Date));for(n=0;n<t.length;n++)r=t[n],h(r.name,r.run())}var t="0.0.1",n={"Windows NT 6.2":"Windows 8","Windows NT 6.1":"Windows 7","Windows NT 6.0":"Windows Vista","Windows NT 5.2":"Windows Server 2003; Windows XP x64 Edition","Windows NT 5.1":"Windows XP","Windows NT 5.01":"Windows 2000, Service Pack 1 (SP1)","Windows NT 5.0":"Windows 2000","Windows NT 4.0":"Microsoft Windows NT 4.0"},r={WOW64:"64/32","Win64; IA64":"64","Win64; x64":"64"};return{version:t,what_browser:function(){return i()},run:function(e,t){o(e,t)}}}),n("md2d/public-api",["require","md2d/controllers/interactives-controller","md2d/controllers/compare-models-controller","common/layout/layout","common/benchmark/benchmark"],function(e){var t=e("md2d/controllers/interactives-controller"),n=e("md2d/controllers/compare-models-controller"),r=e("common/layout/layout"),i=e("common/benchmark/benchmark"),s;return s={version:"0.0.1",interactivesController:t,compareModelsController:n},window.controllers=s,window.layout=r,window.benchmark=i,s}),t(["md2d/public-api"],undefined,undefined,!0)})();