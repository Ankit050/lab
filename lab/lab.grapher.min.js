(function(){var e,t,n;(function(r){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(e){if(d(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!d(a,e)&&!d(c,e))throw new Error("No "+e);return a[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(e,t,n,i){var s,l,h,p,v,g=[],w;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")g[v]=u.require(e);else if(l==="exports")g[v]=u.exports(e),w=!0;else if(l==="module")s=g[v]=u.module(e);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=n.apply(a[e],g);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!w)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):b(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},n=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../vendor/almond/almond",function(){}),n("lab.version",["require"],function(e){return{repo:{branch:"master",commit:{sha:"3d4db3cba1037f79ed47f5088562685e071cedf9",short_sha:"3d4db3cb",url:"https://github.com/concord-consortium/lab/commit/3d4db3cb",author:"Stephen Bannasch",email:"stephen.bannasch@gmail.com",date:"2013-03-12 15:52:22 -0400",short_message:"Interactive Sampler: remove frame borders",message:"Interactive Sampler: remove frame borders\n\nNot needed with recent Interactive frame design work."},dirty:!0}}}),n("common/actual-root",["require"],function(e){function r(){var e=document.location.pathname.match(t);return e&&e[1]?e[1]:""}var t=new RegExp("(\\/.*?)\\/(doc|examples|experiments)(\\/\\w+)*?\\/\\w+\\.html"),n;return n=r(),n}),n("lab.config",["require","common/actual-root"],function(e){var t=e("common/actual-root"),n;return n={sharing:!0,home:"http://lab.concord.org",homeForSharing:"http://lab.concord.org",homeInteractivePath:"/examples/interactives/interactive.html",homeEmbeddablePath:"/examples/interactives/embeddable.html",utmCampaign:null,actualRoot:"",hostName:"lab.concord.org",dataGamesProxyPrefix:"DataGames/Games/concord/lab/",logging:!0,tracing:!1,authoring:!1},n.actualRoot=t,n}),n("grapher/core/axis",["require"],function(e){return{axisProcessDrag:function(e,t,n){var r,i,s=n,o=0,u=n[0],a=n[1],f=a-u;if(t!==0)if(u>=0&&a>u)o=u,r=e-o,i=r*.2+o,t>i&&(change=r/(t-o),f=a-o,s=[u,u+f*change]);else if(u<0&&a>0){o=0,r=e-o,i=r*.2+o;if(e>=0&&t>i||e<0&&t<i)change=r/(t-o),s=[u*change,a*change]}else u<0&&a<0&&(o=a,r=e-o,i=r*.2+o,t<i&&(change=r/(t-o),f=u-o,s=[a+f*change,a]));return s}}}),n("grapher/core/register-keyboard-handler",["require"],function(e){return function(t){d3.select(window).on("keydown",t)}}),n("grapher/core/graph",["require","grapher/core/axis","grapher/core/register-keyboard-handler"],function(e){var t=e("grapher/core/axis"),n=e("grapher/core/register-keyboard-handler");return function(r,i,s){function G(e){if(e)for(var t in z)e[t]===undefined&&(e[t]=z[t]);else e=z;return e.axisShift<1&&(e.axisShift=1),e}function Y(){o<=j.icon?(j.category="icon",j.value=0):o<=j.tiny?(j.category="tiny",j.value=1):o<=j.small?(j.category="small",j.value=2):o<=j.medium?(j.category="medium",j.value=3):o<=j.large?(j.category="large",j.value=4):(j.category="extralarge",j.value=5)}function Z(e,t){arguments.length?(o=e,u=t,a.style.width=o+"px",a.style.height=u+"px"):(o=r.property("clientWidth"),u=r.property("clientHeight")),Y(),H=1}function et(e,t){if(e||!i)i=G(e);f!==undefined&&(f.remove(),f=undefined),t&&(s=t),i.dataChange?P="ns-resize":P="crosshair",Z(),i.xrange=i.xmax-i.xmin,i.yrange=i.ymax-i.ymin,i.datacount=2,B=i.strokeWidth;switch(j.value){case 0:b={top:4,right:4,bottom:4,left:4};break;case 1:b={top:8,right:8,bottom:8,left:8};break;case 2:b={top:i.title?25:15,right:15,bottom:20,left:60};break;case 3:b={top:i.title?30:20,right:30,bottom:i.xlabel?60:10,left:i.ylabel?90:60};break;default:b={top:i.title?40:20,right:30,bottom:i.xlabel?60:10,left:i.ylabel?90:60}}Object.prototype.toString.call(i.title)==="[object Array]"?U=i.title:U=[i.title],U.reverse(),j.value>2?b.top+=(U.length-1)*j.value/3*j.value/3*H*22:U=[U[0]],w={width:o-b.left-b.right,height:u-b.top-b.bottom},x=function(e){return e[0]},T=function(e){return e[1]},E=d3.scale[i.xscale]().domain([i.xmin,i.xmax]).range([0,w.width]),i.xscale==="pow"&&E.exponent(i.xscaleExponent),S=d3.scale[i.yscale]().domain([i.ymin,i.ymax]).range([w.height,0]),i.yscale==="pow"&&S.exponent(i.yscaleExponent),O=function(e){return"translate("+E(e)+",0)"},M=function(e){return"translate(0,"+S(e)+")"},A=function(e){return e?"#ccc":"#666"},_=d3.format(i.xFormatter),D=d3.format(i.yFormatter),N=d3.svg.line().x(function(e,t){return E(m[t][0])}).y(function(e,t){return S(m[t][1])}),F=NaN,I=NaN,q=R=null}function tt(e){function y(e){s=e,e?g.text(e):g.text("")}function x(){var e=i.yrange/2,t=e/2,n;return i.datacount=w.width/30,i.xtic=i.xrange/i.datacount,i.ytic=i.yrange/i.datacount,n=d3.range(i.datacount).map(function(n){return[n*i.xtic+i.xmin,i.ymin+t+Math.random()*e]}),n}function T(){if(!R)return;switch(d3.event.keyCode){case 8:case 46:if(i.dataChange){var e=m.indexOf(R);m.splice(e,1),R=m.length?m[e>0?e-1:0]:null,V()}d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}}function z(){E.domain([i.xmin,i.xmax]).range([0,w.width])}function W(){S.domain([i.ymin,i.ymax]).range([w.height,0])}function X(){var e=l.selectAll("g.x").data(E.ticks(i.xTicCount),String).attr("transform",O),t=e.enter().insert("g","a").attr("class","x").attr("transform",O);t.append("line").attr("stroke",A).attr("y1",0).attr("y2",w.height),j.value>1&&t.append("text").attr("class","axis").style("font-size",j.value/2.7*100+"%").attr("y",w.height).attr("dy","1em").attr("text-anchor","middle").text(_).style("cursor","ew-resize").on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",J).on("touchstart.drag",J),e.exit().remove();var n=l.selectAll("g.y").data(S.ticks(i.yTicCount),String).attr("transform",M),r=n.enter().insert("g","a").attr("class","y").attr("transform",M).attr("background-fill","#FFEEB6");r.append("line").attr("stroke",A).attr("x1",0).attr("x2",w.width);if(j.value>1){if(i.yscale==="log"){var s=r[0].length;s>100?r=r.filter(function(e){return!!e.toString().match(/(\.[0]*|^)[1]/)}):s>50?r=r.filter(function(e){return!!e.toString().match(/(\.[0]*|^)[12]/)}):r=r.filter(function(e){return!!e.toString().match(/(\.[0]*|^)[125]/)})}r.append("text").attr("class","axis").style("font-size",j.value/2.7*100+"%").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").text(D).style("cursor","ns-resize").on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",Q).on("touchstart.drag",Q)}n.exit().remove(),c.call(d3.behavior.zoom().x(E).y(S).on("zoom",X)),V()}function V(){ot(),l.select("path").attr("d",N(m));var e=l.select("svg").selectAll("circle").data(m,function(e){return e});i.circleRadius&&j.value>1&&(i.circleRadius<=4&&j.value<3||(e.enter().append("circle").attr("class",function(e){return e===R?"selected":null}).attr("cx",function(e){return E(e[0])}).attr("cy",function(e){return S(e[1])}).attr("r",i.circleRadius*(1+j.value)/4).style("stroke-width",i.circleRadius/6*(j.value-1.5)).style("cursor",P).on("mousedown.drag",G).on("touchstart.drag",G),e.attr("class",function(e){return e===R?"selected":null}).attr("cx",function(e){return E(e[0])}).attr("cy",function(e){return S(e[1])}).attr("r",i.circleRadius*(1+j.value)/4).style("stroke-width",i.circleRadius/6*(j.value-1.5)))),e.exit().remove(),d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function $(){var e;d3.event.preventDefault(),n(T),d3.select("body").style("cursor","move");if(d3.event.altKey)if(d3.event.shiftKey&&i.addData){e=d3.mouse(l.node());var t=[];t[0]=E.invert(Math.max(0,Math.min(w.width,e[0]))),t[1]=S.invert(Math.max(0,Math.min(w.height,e[1]))),m.push(t),m.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}),R=t,V()}else e=d3.mouse(l.node()),F=E.invert(e[0]),I=S.invert(e[1]),q=!1,d3.event.stopPropagation()}function J(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.mouse(l.node());F=E.invert(t[0])}function Q(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.mouse(l.node());I=S.invert(t[1])}function G(e){n(T),document.onselectstart=function(){return!1},R=q=e,V()}function Y(){var e=d3.mouse(l.node());d3.event.preventDefault(),q&&i.dataChange&&(q[1]=S.invert(Math.max(0,Math.min(w.height,e[1]))),V()),isNaN(F)||(d3.select("body").style("cursor","ew-resize"),E.domain(t.axisProcessDrag(F,E.invert(e[0]),E.domain())),X(),d3.event.stopPropagation()),isNaN(I)||(d3.select("body").style("cursor","ns-resize"),S.domain(t.axisProcessDrag(I,S.invert(e[1]),S.domain())),X(),d3.event.stopPropagation())}function nt(){document.onselectstart=function(){return!0},d3.select("body").style("cursor","auto"),isNaN(F)||(F=NaN,X()),isNaN(I)||(I=NaN,X()),q=null}function rt(){var e,t=E.domain(),n=t[1]-t[0],r=n*.8;C?(C=L())?X():V():m[m.length-1][0]>t[0]+r?(L=it(r*.75,i.axisShift),C=L(),X()):V()}function it(e,t){var n=E.domain()[0],r=E.domain()[1],i=1/t,s=0;return function(){var t;return s+=i,t=e*k(s),E.domain([n+t,r+t]),E.domain()[0]<n+e}}e||(e=r),e.each(function(){r=d3.select(this),this.clientWidth&&this.clientHeight&&(o=this.clientWidth,u=this.clientHeight,w.width=o-b.left-b.right,w.height=u-b.top-b.bottom),m=i.points,m==="fake"&&(m=x()),z(),W(),f===undefined?(f=r.append("svg").attr("width",o).attr("height",u).attr("class","graph"),l=f.append("g").attr("transform","translate("+b.left+","+b.top+")"),c=l.append("rect").attr("class","plot").attr("width",w.width).attr("height",w.height).style("fill","#EEEEEE").attr("pointer-events","all").on("mousedown.drag",$).on("touchstart.drag",$).call(d3.behavior.zoom().x(E).y(S).on("zoom",X)),h=l.append("svg").attr("class","viewbox").attr("top",0).attr("left",0).attr("width",w.width).attr("height",w.height).attr("viewBox","0 0 "+w.width+" "+w.height),h.append("path").attr("class","line").style("stroke-width",B).attr("d",N(m)),K=h.append("g").attr("class","brush"),i.title&&j.value>1&&(p=l.selectAll("text").data(U,function(e){return e}),p.enter().append("text").attr("class","title").style("font-size",j.value/2.4*100+"%").text(function(e){return e}).attr("x",w.width/2).attr("dy",function(e,t){return-0.5+ -1*j.value/2.8*t*H+"em"}).style("text-anchor","middle")),i.xlabel&&j.value>2&&(d=l.append("text").attr("class","axis").style("font-size",j.value/2.6*100+"%").text(i.xlabel).attr("x",w.width/2).attr("y",w.height).attr("dy","2.4em").style("text-anchor","middle")),i.ylabel&&j.value>2&&(v=l.append("g").append("text").attr("class","axis").style("font-size",j.value/2.6*100+"%").text(i.ylabel).style("text-anchor","middle").attr("transform","translate(-50 "+w.height/2+") rotate(-90)")),d3.select(a).on("mousemove.drag",Y).on("touchmove.drag",Y).on("mouseup.drag",nt).on("touchend.drag",nt),g=l.append("text").attr("class","graph-notification").text(s).attr("x",w.width/2).attr("y",w.height/2).style("text-anchor","middle")):(l.attr("width",o).attr("height",u),c.attr("width",w.width).attr("height",w.height),h.attr("top",0).attr("left",0).attr("width",w.width).attr("height",w.height).attr("viewBox","0 0 "+w.width+" "+w.height),i.title&&j.value>1&&p.each(function(e,t){d3.select(this).attr("x",w.width/2),d3.select(this).attr("dy",function(e,t){return 1.4*t-U.length+"em"})}),i.xlabel&&j.value>1&&d.attr("x",w.width/2).attr("y",w.height),i.ylabel&&j.value>1&&v.attr("transform","translate(-40 "+w.height/2+") rotate(-90)"),g.attr("x",w.width/2).attr("y",w.height/2)),X()}),tt.elem=r,tt.redraw=X,tt.update=V,tt.notify=y,tt.points=m,tt.initialize=et,tt.updateXScale=z,tt.updateYScale=W,tt.scale=Z,tt.updateOrRescale=rt}function nt(){i.title&&p&&p.text(i.title)}function rt(){i.xlabel&&d&&d.text(i.xlabel)}function it(){i.ylabel&&v?v.text(i.ylabel):v.style("display","none")}function st(){var e;$&&(e=Q.extent(),tt.selection_domain(e[0]!==e[1]?e:[]))}function ot(){X&&V?(Q=Q||d3.svg.brush().x(E).extent([W.xmin||0,W.xmax||0]).on("brush",st),K.call(Q.extent([W.xmin||0,W.xmax||0])).style("display","inline").style("pointer-events",$?"all":"none").selectAll("rect").attr("height",w.height)):K.style("display","none")}var o=600,u=300,a;arguments.length&&(r=d3.select(r),a=r.node(),o=r.property("clientWidth"),u=r.property("clientHeight"));var f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C=!1,k=d3.ease("cubic"),L,A,O,M,_,D,P,H,B,j={category:"medium",value:3,icon:120,tiny:240,small:480,medium:960,large:1920},F,I,q,R,U=[],z={title:"Graph",xlabel:"X Axis",ylabel:"Y Axis",xscale:"linear",yscale:"linear",xTicCount:10,yTicCount:8,xFormatter:"3.3r",yFormatter:"3.3r",xscaleExponent:.5,yscaleExponent:.5,axisShift:10,xmax:60,xmin:0,ymax:40,ymin:0,circleRadius:10,strokeWidth:2,dataChange:!0,addData:!0,points:!1,notification:!1},W={xmin:null,xmax:null,ymin:null,ymax:null},X=!1,V=!1,$=!0,J,K,Q;return et(i),tt.margin=function(e){return arguments.length?(y=e,tt):y},tt.xmin=function(e){return arguments.length?(i.xmin=e,i.xrange=i.xmax-i.xmin,tt.updateXScale&&(tt.updateXScale(),tt.redraw()),tt):i.xmin},tt.xmax=function(e){return arguments.length?(i.xmax=e,i.xrange=i.xmax-i.xmin,tt.updateXScale&&(tt.updateXScale(),tt.redraw()),tt):i.xmax},tt.ymin=function(e){return arguments.length?(i.ymin=e,i.yrange=i.ymax-i.ymin,tt.updateYScale&&(tt.updateYScale(),tt.redraw()),tt):i.ymin},tt.ymax=function(e){return arguments.length?(i.ymax=e,i.yrange=i.ymax-i.ymin,tt.updateYScale&&(tt.updateYScale(),tt.redraw()),tt):i.ymax},tt.xLabel=function(e){return arguments.length?(i.xlabel=e,rt(),tt):i.xlabel},tt.yLabel=function(e){return arguments.length?(i.ylabel=e,it(),tt):i.ylabel},tt.title=function(e){return arguments.length?(i.title=e,nt(),tt):i.title},tt.width=function(e){return arguments.length?(w.width=e,tt):w.width},tt.height=function(e){return arguments.length?(w.height=e,tt):w.height},tt.x=function(e){return arguments.length?(x=e,tt):x},tt.y=function(e){return arguments.length?(T=e,tt):T},tt.elem=function(e){return arguments.length?(r=d3.select(e),tt(r),tt):r},tt.data=function(e){if(!arguments.length)return m;var t=E.domain(),n=t[1]-t[0],r=n*.8;return i.points=m=e,m.length>t[1]?(t[0]+=r,t[1]+=r,E.domain(t),tt.redraw()):tt.update(),tt},tt.add_data=function(e){if(!arguments.length)return m;var t=E.domain(),n=t[1]-t[0],r=n*.8,i;if(e instanceof Array&&e.length>0)if(e[0]instanceof Array)for(i=0;i<e.length;i++)m.push(e[i]);else{if(e.length!==2)throw new Error("invalid argument to graph.add_data() "+e+" length should === 2.");m.push(e)}return tt.updateOrRescale(),tt},tt.selection_domain=function(e){return arguments.length?(e===null?X=!1:e.length===0?(X=!0,W.xmin=Infinity,W.xmax=Infinity):(X=!0,W.xmin=e[0],W.xmax=e[1]),ot(),J&&J(tt.selection_domain()),tt):X?W.xmax===Infinity&&W.xmin===Infinity?[]:[W.xmin,W.xmax]:null},tt.has_selection=function(){return X},tt.selection_visible=function(e){return arguments.length?(e=!!e,V!==e&&(V=e,ot()),tt):V},tt.selection_enabled=function(e){return arguments.length?(e=!!e,$!==e&&($=e,ot()),tt):$},tt.selection_listener=function(e){return arguments.length?(J=e,tt):J},tt.brush_element=function(){return K},tt.brush_control=function(){return Q},tt.brush_listener=function(){return st},tt.reset=function(e,t){return arguments.length?tt.initialize(e,t):tt.initialize(),tt(),tt},tt.resize=function(e,t){return tt.scale(e,t),tt.initialize(),tt(),tt},r&&tt(r),tt}}),n("grapher/core/real-time-graph",["require","grapher/core/axis"],function(e){var t=e("grapher/core/axis");return function(n,r,i){function at(e){if(e)for(var t in ut)e[t]===undefined&&(e[t]=ut[t]);else e=ut;return e.axisShift<1&&(e.axisShift=1),e}function ft(){r.responsiveLayout?u<=V.icon?(V.category="icon",V.value=0):u<=V.tiny?(V.category="tiny",V.value=1):u<=V.small?(V.category="small",V.value=2):u<=V.medium?(V.category="medium",V.value=3):u<=V.large?(V.category="large",V.value=4):(V.category="extralarge",V.value=5):(V.category="large",V.value=4)}function lt(e,t){var n,r,i;return n=s.append("svg").attr("width",u).attr("height",a).attr("class","graph"),r=n.append("g").append("text").attr("class","axis").attr("x",-B/4+"px").attr("dy",".35em").attr("text-anchor","end").text(d3.format(e)(t)),i=r.node().getBBox().width,n.remove(),i}function ct(e,t){!e&&!t?(u=Math.max(s.property("clientWidth"),32),a=Math.max(s.property("clientHeight"),32)):(u=e,o.style.width=u+"px",t?(a=t,o.style.height=a+"px"):(o.style.height="100%",t=s.property("clientHeight"),a=t,o.style.height=a+"px")),ft()}function ht(){ct(),B=parseFloat($(o).css("font-size")),r.fontScaleRelativeToParent||$(o).css("font-size",.5+V.value/6+"em"),B=parseFloat($(o).css("font-size")),j=B/2,F=B/4,z=Math.max(lt(r.yFormatter,r.ymax)*1.5,lt(r.yFormatter,r.ymin)*1.5),d===undefined?(I=B,q=B,R=B,U=B):(I=parseFloat($("svg.graph text.title").css("font-size")),q=parseFloat($("svg.graph text.axis").css("font-size")),R=parseFloat($("svg.graph text.xlabel").css("font-size")),U=parseFloat($("svg.graph text.ylabel").css("font-size")));switch(V.value){case 0:C={top:B,right:B,bottom:B,left:B};break;case 1:C={top:B,right:B,bottom:B,left:B};break;case 2:C={top:r.title?I*1.8:j,right:B,bottom:q*1.25,left:z};break;case 3:C={top:r.title?I*1.8:j,right:B,bottom:r.xlabel?(R+q)*1.25:q*1.25,left:r.ylabel?z+q:z};break;default:C={top:r.title?I*1.8:j,right:B,bottom:r.xlabel?(R+q)*1.25:q*1.25,left:r.ylabel?z+q:z}}V.value>2?C.top+=(Y.length-1)*V.value/3*V.value/3*B:Y=[Y[0]],k={width:u-C.left-C.right,height:a-C.top-C.bottom},L=d3.scale[r.xscale]().domain([r.xmin,r.xmax]).range([0,k.width]),r.xscale==="pow"&&L.exponent(r.xscaleExponent),A=d3.scale[r.yscale]().domain([r.ymin,r.ymax]).nice().range([k.height,0]).nice(),r.yscale==="pow"&&A.exponent(r.yscaleExponent),O=d3.svg.line().x(function(e,t){return L(Z[t].x)}).y(function(e,t){return A(Z[t].y)})}function pt(e,t,n){e&&(s=d3.select(e),o=s.node(),u=s.property("clientWidth"),a=s.property("clientHeight"));if(t||!r)r=at(t);d!==undefined&&(d.remove(),d=undefined),it!==undefined&&($(it).remove(),it=undefined),rt=r.sample,r.dataChange?P="ns-resize":P="crosshair",ct(),r.xrange=r.xmax-r.xmin,r.yrange=r.ymax-r.ymin,et=[];if(Object.prototype.toString.call(r.dataset[0])==="[object Array]"){for(var i=0;i<r.dataset.length;i++)et.push(dt(r.dataset[i],0,rt));Z=et[0]}else Z=dt(r.dataset,0),et=[Z];Object.prototype.toString.call(r.title)==="[object Array]"?Y=r.title:Y=[r.title],Y.reverse(),h=d3.format(r.xFormatter),p=d3.format(r.yFormatter),J=Math.NaN,K=Math.NaN,Q=null}function dt(e,t,n){var r=0,i=t||0,s=e.length,o=[];n=n||1;for(r=0;r<s;r++)o.push({x:(r+i)*n,y:e[r]});return o}function vt(){return Z?Z.length:!1}function mt(){function e(e){i=e,e?N.text(e):N.text("")}function n(){var e=v.selectAll("g.x").data(L.ticks(r.xTicCount),String).attr("transform",l),t=e.enter().insert("g","a").attr("class","x").attr("transform",l);t.append("line").attr("stroke",f).attr("y1",0).attr("y2",k.height),V.value>1&&t.append("text").attr("class","axis").attr("y",k.height).attr("dy",q+"px").attr("text-anchor","middle").style("cursor","ew-resize").text(h).on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",P).on("touchstart.drag",P),e.exit().remove();var i=v.selectAll("g.y").data(A.ticks(r.yTicCount),String).attr("transform",c),s=i.enter().insert("g","a").attr("class","y").attr("transform",c).attr("background-fill","#FFEEB6");s.append("line").attr("stroke",f).attr("x1",0).attr("x2",k.width),V.value>1&&s.append("text").attr("class","axis").attr("x",-q/4+"px").attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(p).on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",H).on("touchstart.drag",H),i.exit().remove(),m.call(d3.behavior.zoom().x(L).y(A).on("zoom",n)),S()}function S(e){Tt(e);if(mt.selectable_points){var t=v.selectAll("circle").data(Z,function(e){return e});t.enter().append("circle").attr("class",function(e){return e===G?"selected":null}).attr("cx",function(e){return x(e.x)}).attr("cy",function(e){return y(e.y)}).attr("r",1).on("mousedown",function(e){G=Q=e,S()}),t.attr("class",function(e){return e===G?"selected":null}).attr("cx",function(e){return x(e.x)}).attr("cy",function(e){return y(e.y)}),t.exit().remove()}d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function T(){d3.event.preventDefault(),m.style("cursor","move");if(d3.event.altKey){var e=d3.mouse(v.node());J=L.invert(e[0]),K=A.invert(e[1]),Q=!1,d3.event.stopPropagation()}}function P(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.mouse(v.node());J=L.invert(t[0])}function H(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.mouse(v.node());K=A.invert(t[1])}function B(){var e=d3.mouse(v.node()),r,i,s,o=d3.event.changedTouches;document.onselectstart=function(){return!0},d3.event.preventDefault(),isNaN(J)||(d3.select("body").style("cursor","ew-resize"),L.domain(t.axisProcessDrag(J,L.invert(e[0]),L.domain())),n(),d3.event.stopPropagation()),isNaN(K)||(d3.select("body").style("cursor","ns-resize"),A.domain(t.axisProcessDrag(K,A.invert(e[1]),A.domain())),n(),d3.event.stopPropagation())}function F(){d3.select("body").style("cursor","auto"),document.onselectstart=function(){return!0},isNaN(J)||(n(),J=Math.NaN),isNaN(K)||(n(),K=Math.NaN),Q=null}function R(e){tt={x:Z[e].x,y:Z[e].y}}function U(e){var t,i=L.domain(),s=Math.round(i[0]/rt),o=Math.round(i[1]/rt),u=Math.max(0,s),a=i[1]-i[0],f=a*.9,l;typeof e!="number"&&(e=Z.length),l=e*rt,M?(M=D(),M?n():S(e)):l>i[0]+f?(D=W(f*.9,r.axisShift),M=D(),n()):l<i[1]-f&&e<Z.length&&s>0?(D=W(f*.9,r.axisShift,-1),M=D(),n()):l<i[0]?(D=W(f*.1,1,-1),M=D(),n()):S(e)}function W(e,t,n){var r=L.domain()[0],i=L.domain()[1],s=1/t,o=0;return function(){var t;return n=n||1,o+=s,t=e*_(o),n>0?(L.domain([r+t,i+t]),L.domain()[0]<r+e):(L.domain([r-t,i-t]),L.domain()[0]>r-e)}}function X(e){if(Z.length===0)return;tt=!1;var t=Z.length,n=t*rt,r={x:n,y:e},i,s;Z.push(r)}function $(e){if(Z.length===0)return;X(e),U()}function ut(e){if(Z.length===0)return;tt=!1;var t=Z.length,n=t*rt,r=n-rt,i={x:n,y:e},s=L.call(self,r,r),o=A.call(self,Z[t-1].y,t-1),u,a;Z.push(i),u=L.call(self,n,n),a=A.call(self,e,n),st.beginPath(),st.moveTo(s,o),st.lineTo(u,a),st.stroke()}function at(e){for(var t=0;t<et.length;t++)Z=et[t],X(e[t]);U()}function ft(e){for(var t=0;t<et.length;t++)Z=et[t],lt(t),ut(e[t])}function lt(e,t){var n=t?.4:1;switch(e){case 0:st.strokeStyle="rgba(160,00,0,"+n+")";break;case 1:st.strokeStyle="rgba(44,160,0,"+n+")";break;case 2:st.strokeStyle="rgba(44,0,160,"+n+")"}}function gt(e,t){var n=t?.4:1;switch(e){case 0:st.fillStyle="rgba(160,00,0,"+n+")";break;case 1:st.fillStyle="rgba(44,160,0,"+n+")";break;case 2:st.fillStyle="rgba(44,0,160,"+n+")"}}function yt(e){var t;et=[];if(Object.prototype.toString.call(e)==="[object Array]")for(t=0;t<e.length;t++)Z=dt(e[t],0,rt),et.push(Z);else Z=dt(r.dataset,0,rt),et=[Z];U()}function bt(e){x=d3.scale[r.xscale]().domain([0,e]).range([0,k.width]),mt.xmax=e,x_tics_scale=d3.scale[r.xscale]().domain([mt.xmin*mt.sample,mt.xmax*mt.sample]).range([0,k.width]),S(),n()}function wt(e){y=d3.scale[r.yscale]().domain([e,0]).range([0,k.height]),mt.ymax=e,S(),n()}function Et(){it.width=it.width,st.fillStyle="rgba(0,255,0, 0.05)",st.fillRect(0,0,it.width,it.height),st.strokeStyle="rgba(255,65,0, 1.0)"}function St(){v.select("path.line").remove(),it.style.zIndex=100}function xt(){it.style.zIndex=-100,S()}function Tt(e){var t,n,i,s,o,u=A(1e-5),a=r.lines,f=r.bars,l=2*Math.PI,c=et[0].length,h=et.length,p=Math.round(L.domain()[0]/rt),d=Math.round(L.domain()[1]/rt),v=Math.max(0,p);typeof e=="undefined"?s=c:e===c-1?s=c-1:s=e,Et(),st.fillRect(0,0,it.width,it.height);if(Z.length===0||p>=Z.length)return;if(a)for(t=0;t<h;t++){Z=et[t],lengthX=v*rt,px=L(lengthX),i=A(Z[v].y),lt(t),st.beginPath(),st.moveTo(px,i),o=s-1;for(n=v+1;n<o;n++)lengthX=n*rt,px=L(lengthX),i=A(Z[n].y),st.lineTo(px,i);st.stroke(),o=Z.length-1;if(n<o){lt(t,!0);for(;n<o;n++)lengthX=n*rt,px=L(lengthX),i=A(Z[n].y),st.lineTo(px,i);st.stroke()}}else if(f)for(t=0;t<h;t++){Z=et[t],lt(t),o=s-1;for(n=v;n<o;n++){lengthX=n*rt,px=L(lengthX),i=A(Z[n].y);if(i===0)continue;st.beginPath(),st.moveTo(px,u),st.lineTo(px,i),st.stroke()}o=Z.length-1;if(n<o){lt(t,!0);for(;n<o;n++)lengthX=n*rt,px=L(lengthX),i=A(Z[n].y),st.beginPath(),st.moveTo(px,u),st.lineTo(px,i),st.stroke()}}else for(t=0;t<h;t++){Z=et[t],lengthX=0,gt(t),lt(t,!0),o=s-1;for(n=0;n<o;n++)px=L(lengthX),i=A(Z[n].y),st.arc(px,i,1,0,l,!1),st.fill(),lengthX+=rt;o=Z.length-1;if(n<o){gt(t,!0),lt(t,!0);for(;n<o;n++)px=L(lengthX),i=A(Z[n].y),st.arc(px,i,1,0,l,!1),st.fill(),lengthX+=rt}}}function Nt(){it||(it=it||document.createElement("canvas"),o.appendChild(it)),it.style.zIndex=-100,kt(it)}function Ct(){kt(it),Tt()}function kt(e){ot.rect=m.node(),ot.width=ot.rect.width.baseVal.value,ot.height=ot.rect.height.baseVal.value,ot.left=ot.rect.getCTM().e,ot.top=ot.rect.getCTM().f,e.style.position="absolute",e.width=ot.width,e.height=ot.height,e.style.width=ot.width+"px",e.style.height=ot.height+"px",e.offsetLeft=ot.left,e.offsetTop=ot.top,e.style.left=ot.left+"px",e.style.top=ot.top+"px",e.style.border="solid 1px red",e.style.pointerEvents="none",e.className+="canvas-overlay",st=it.getContext("2d"),st.globalCompositeOperation="source-over",st.lineWidth=1,st.fillStyle="rgba(0,255,0, 0.05)",st.fillRect(0,0,e.width,it.height),st.strokeStyle="rgba(255,65,0, 1.0)",it.style.border="solid 1px red"}ht(),d===undefined?(d=s.append("svg").attr("width",u).attr("height",a).attr("class","graph"),v=d.append("g").attr("transform","translate("+C.left+","+C.top+")"),m=v.append("rect").attr("class","plot").attr("width",k.width).attr("height",k.height).style("fill","#EEEEEE").attr("pointer-events","all").on("mousedown",T).on("touchstart",T),m.call(d3.behavior.zoom().x(L).y(A).on("zoom",n)),g=v.append("svg").attr("class","viewbox").attr("top",0).attr("left",0).attr("width",k.width).attr("height",k.height).attr("viewBox","0 0 "+k.width+" "+k.height).append("path").attr("class","line").attr("d",O(Z)),nt=g.append("path").attr("class","marker"),r.title&&V.value>1&&(b=v.selectAll("text").data(Y,function(e){return e}),b.enter().append("text").attr("class","title").text(function(e){return e}).attr("x",k.width/2).attr("dy",function(e,t){return-t*I-j+"px"}).style("text-anchor","middle")),r.xlabel&&V.value>2&&(w=v.append("text").attr("class","axis").attr("class","xlabel").text(r.xlabel).attr("x",k.width/2).attr("y",k.height).attr("dy",q*2+"px").style("text-anchor","middle")),r.ylabel&&V.value>2&&(E=v.append("g").append("text").attr("class","axis").attr("class","ylabel").text(r.ylabel).style("text-anchor","middle").attr("transform","translate("+ -z+" "+k.height/2+") rotate(-90)")),N=v.append("text").attr("class","graph-notification").text(i).attr("x",k.width/2).attr("y",k.height/2).style("text-anchor","middle"),d3.select(o).on("mousemove.drag",B).on("touchmove.drag",B).on("mouseup.drag",F).on("touchend.drag",F),Nt(),St()):(v.attr("width",u).attr("height",a),m.attr("width",k.width).attr("height",k.height).style("fill","#EEEEEE"),g.attr("top",0).attr("left",0).attr("width",k.width).attr("height",k.height).attr("viewBox","0 0 "+k.width+" "+k.height),r.title&&V.value>1&&b.each(function(e,t){d3.select(this).attr("x",k.width/2),d3.select(this).attr("dy",function(e,t){return 1.4*t-Y.length+"em"})}),r.xlabel&&V.value>1&&w.attr("x",k.width/2).attr("y",k.height),r.ylabel&&V.value>1&&E.attr("transform","translate(-40 "+k.height/2+") rotate(-90)"),N.attr("x",k.width/2).attr("y",k.height/2),v.selectAll("g.x").remove(),v.selectAll("g.y").remove(),Ct()),n(),mt.node=o,mt.scale=ct,mt.update=S,mt.updateOrRescale=U,mt.redraw=n,mt.initialize=pt,mt.notify=e,mt.number_of_points=vt,mt.new_data=yt,mt.add_point=$,mt.add_points=at,mt.add_canvas_point=ut,mt.add_canvas_points=ft,mt.initialize_canvas=Nt,mt.show_canvas=St,mt.hide_canvas=xt,mt.clear_canvas=Et,mt.update_canvas=Tt,mt.showMarker=R,mt.change_xaxis=bt,mt.change_yaxis=wt}var s,o,u,a,f=function(e){return e?"#ccc":"#666"},l=function(e){return"translate("+L(e)+",0)"},c=function(e){return"translate(0,"+A(e)+")"},h,p,d,v,m,g,b,w,E,S,T,N,C,k,L,A,O,M=!1,_=d3.ease("cubic"),D,P,H,B,j,F,I,q,R,U,z,W,X,V={category:"medium",value:3,icon:120,tiny:240,small:480,medium:960,large:1920},J=Math.NaN,K=Math.NaN,Q=null,G=null,Y=[],Z,et,tt,nt,rt,it,st,ot={},ut={responsiveLayout:!1,fontScaleRelativeToParent:!0,title:"graph",xlabel:"x-axis",ylabel:"y-axis",xscale:"linear",yscale:"linear",xTicCount:10,yTicCount:10,xscaleExponent:.5,yscaleExponent:.5,xFormatter:"3.2r",yFormatter:"3.2r",axisShift:10,xmax:10,xmin:0,ymax:10,ymin:0,dataset:[0],selectable_points:!0,circleRadius:!1,dataChange:!1,points:!1,sample:1,lines:!0,bars:!1};return pt(n,r,i),mt.add_data=function(e){if(!arguments.length)return Z;var t=L.domain(),n=t[1]-t[0],r=n*.8,i,s;if(e instanceof Array&&e.length>0)if(e[0]instanceof Array)for(s=0;s<e.length;s++)Z.push(e[s]);else{if(e.length!==2)throw new Error("invalid argument to graph.add_data() "+e+" length should === 2.");Z.push(e)}return updateOrRescale(),mt},mt.getXDomain=function(){return L.domain()},mt.getYDomain=function(){return A.domain()},mt.reset=function(e,t,n){return arguments.length?mt.initialize(e,t,n):mt.initialize(),mt(),mt(),mt},mt.resize=function(e,t){return mt.scale(e,t),mt.initialize(),mt(),mt},o&&(mt(),mt()),mt}}),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=r.unshift,l=i.toString,c=i.hasOwnProperty,h=r.forEach,p=r.map,d=r.reduce,v=r.reduceRight,m=r.filter,g=r.every,y=r.some,b=r.indexOf,w=r.lastIndexOf,E=Array.isArray,S=Object.keys,x=s.bind,T=function(e){if(e instanceof T)return e;if(!(this instanceof T))return new T(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.4.2";var N=T.each=T.forEach=function(e,t,r){if(e==null)return;if(h&&e.forEach===h)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(T.has(e,o)&&t.call(r,e[o],o,e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return e==null?r:p&&e.map===p?e.map(t,n):(N(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduce===d)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);N(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(v&&e.reduceRight===v)return r&&(t=T.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var s=e.length
;if(s!==+s){var o=T.keys(e);s=o.length}N(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.find=T.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},T.filter=T.select=function(e,t,n){var r=[];return e==null?r:m&&e.filter===m?e.filter(t,n):(N(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},T.reject=function(e,t,n){return T.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return e==null?i:g&&e.every===g?e.every(t,r):(N(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return e==null?i:y&&e.some===y?e.some(t,r):(N(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};T.contains=T.include=function(e,t){return e==null?!1:b&&e.indexOf===b?e.indexOf(t)!=-1:C(e,function(e){return e===t})},T.invoke=function(e,t){var n=u.call(arguments,2);return T.map(e,function(e){return(T.isFunction(t)?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t){return T.isEmpty(t)?[]:T.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-Infinity;var r={computed:-Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return Infinity;var r={computed:Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return N(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t);return N(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};T.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)})},T.countBy=function(e,t,n){return L(e,t,n,function(e,t,n){T.has(e,t)||(e[t]=0),e[t]++})},T.sortedIndex=function(e,t,n,r){n=n==null?T.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},T.toArray=function(e){return e?e.length===+e.length?u.call(e):T.values(e):[]},T.size=function(e){return e==null?0:e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,0,t):e[0]},T.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},T.last=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},T.rest=T.tail=T.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},T.compact=function(e){return T.filter(e,function(e){return!!e})};var A=function(e,t,n){return N(e,function(e){T.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};T.flatten=function(e,t){return A(e,t,[])},T.without=function(e){return T.difference(e,u.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){T.isFunction(t)&&(r=n,n=t,t=!1);var i=n?T.map(e,n,r):e,s=[],o=[];return N(i,function(n,r){if(t?!r||o[o.length-1]!==n:!T.contains(o,n))o.push(n),s.push(e[r])}),s},T.union=function(){return T.uniq(a.apply(r,arguments))},T.intersection=function(e){var t=u.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=a.apply(r,u.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){var e=u.call(arguments),t=T.max(T.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=T.pluck(e,""+r);return n},T.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=T.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};T.bind=function(t,n){var r,i;if(t.bind===x&&x)return x.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=t.prototype;var e=new O,s=t.apply(e,i.concat(u.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(u.call(arguments)))}},T.bindAll=function(e){var t=u.call(arguments,1);return t.length==0&&(t=T.functions(e)),N(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(u.call(arguments,1)))},T.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,f<=0?(clearTimeout(i),o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},T.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},T.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},T.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},T.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&(t[t.length]=n);return t},T.values=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push(e[n]);return t},T.pairs=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push([n,e[n]]);return t},T.invert=function(e){var t={};for(var n in e)T.has(e,n)&&(t[e[n]]=n);return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return N(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=M(e[o],t[o],n,r)))break}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(f)&&f instanceof f))return!1;for(var c in e)if(T.has(e,c)){o++;if(!(u=T.has(t,c)&&M(e[c],t[c],n,r)))break}if(u){for(c in t)if(T.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};T.isEqual=function(e,t){return M(e,t,[],[])},T.isEmpty=function(e){if(e==null)return!0;if(T.isArray(e)||T.isString(e))return e.length===0;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!!e&&e.nodeType===1},T.isArray=E||function(e){return l.call(e)=="[object Array]"},T.isObject=function(e){return e===Object(e)},N(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!!e&&!!T.has(e,"callee")}),typeof /./!="function"&&(T.isFunction=function(e){return typeof e=="function"}),T.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return e===!0||e===!1||l.call(e)=="[object Boolean]"},T.isNull=function(e){return e===null},T.isUndefined=function(e){return e===void 0},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},T.random=function(e,t){return t==null&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=T.invert(_.escape);var D={escape:new RegExp("["+T.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(_.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),T.result=function(e,t){if(e==null)return null;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){N(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(T,e))}})};var P=0;T.uniqueId=function(e){var t=P++;return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":o?"';\n"+o+"\n__p+='":"",i=u+t.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,T);var a=function(e){return o.call(this,e,T)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},T.chain=function(e){return T(e).chain()};var F=function(e){return this._chain?T(e).chain():e};T.mixin(T),N(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),N(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),n("underscore",function(e){return function(){var t,n;return t||e._}}(this)),function(){var e=this,n=e.Backbone,r=[],i=r.push,s=r.slice,o=r.splice,u;typeof exports!="undefined"?u=exports:u=e.Backbone={},u.VERSION="0.9.10";var a=e._;!a&&typeof t!="undefined"&&(a=t("underscore")),u.$=e.jQuery||e.Zepto||e.ender,u.noConflict=function(){return e.Backbone=n,this},u.emulateHTTP=!1,u.emulateJSON=!1;var f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object")for(var i in n)e[t].apply(e,[i,n[i]].concat(r));else{if(!f.test(n))return!0;var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r))}},c=function(e,t){var n,r=-1,i=e.length;switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,t[0]);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,t[0],t[1]);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,t[0],t[1],t[2]);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h=u.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=a.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n),this},off:function(e,t,n){var r,i,s,o,u,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:a.keys(this._events);for(u=0,f=o.length;u<f;u++){e=o[u];if(r=this._events[e]){s=[];if(t||n)for(c=0,h=r.length;c<h;c++)i=r[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&s.push(i);this._events[e]=s}}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},listenTo:function(e,t,n){var r=this._listeners||(this._listeners={}),i=e._listenerId||(e._listenerId=a.uniqueId("l"));return r[i]=e,e.on(t,typeof t=="object"?this:n,this),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return;if(e)e.off(t,typeof t=="object"?this:n,this),!t&&!n&&delete r[e._listenerId];else{typeof t=="object"&&(n=this);for(var i in r)r[i].off(t,n,this);this._listeners={}}return this}};h.bind=h.on,h.unbind=h.off,a.extend(u,h);var p=u.Model=function(e,t){var n,r=e||{};this.cid=a.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(r=this.parse(r,t)||{});if(n=a.result(this,"defaults"))r=a.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};a.extend(p.prototype,h,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return a.clone(this.attributes)},sync:function(){return u.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return a.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,u,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,u=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=a.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],a.isEqual(c[r],t)||o.push(r),a.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!u){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!u)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,a.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,a.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!a.isEmpty(this.changed):a.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?a.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(a.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return a.clone(this._previousAttributes)},fetch:function(e){e=e?a.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){if(!e.set(e.parse(n,r),r))return!1;t&&t(e,n,r)},this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o,u=this.attributes;return e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t,r&&(!n||!n.wait)&&!this.set(r,n)?!1:(n=a.extend({validate:!0},n),this._validate(r,n)?(r&&n.wait&&(this.attributes=a.extend({},u,r)),n.parse===void 0&&(n.parse=!0),i=n.success,n.success=function(e,t,n){e.attributes=u;var s=e.parse(t,n);n.wait&&(s=a.extend(r||{},s));if(a.isObject(s)&&!e.set(s,n))return!1;i&&i(e,t,n)},s=this.isNew()?"create":n.patch?"patch":"update",s==="patch"&&(n.attrs=r),o=this.sync(s,this,n),r&&n.wait&&(this.attributes=u),o):!1)},destroy:function(e){e=e?a.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(e,t,i){(i.wait||e.isNew())&&r(),n&&n(e,t,i)};if(this.isNew())return e.success(this,null,e),!1;var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=a.result(this,"urlRoot")||a.result(this.collection,"url")||_();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=a.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,t||{}),!1):!0}});var d=u.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,a.extend({silent:!0},t))};a.extend(d.prototype,h,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return u.sync.apply(this,arguments)},add:function(e,t){e=a.isArray(e)?e.slice():[e],t||(t={});var n,r,s,u,f,l,c,h,p,d;c=[],h=t.at,p=this.comparator&&h==null&&t.sort!=0,d=a.isString(this.comparator)?this.comparator:null;for(n=0,r=e.length;n<r;n++){if(!(s=this._prepareModel(u=e[n],t))){this.trigger("invalid",this,u,t);continue}if(f=this.get(s)){t.merge&&(f.set(u===s?s.attributes:u,t),p&&!l&&f.hasChanged(d)&&(l=!0));continue}c.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,s.id!=null&&(this._byId[s.id]=s)}c.length&&(p&&(l=!0),this.length+=c.length,h!=null?o.apply(this.models,[h,0].concat(c)):i.apply(this.models,c)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,r=c.length;n<r;n++)(s=c[n]).trigger("add",s,this,t);return l&&this.trigger("sort",this,t),this},remove:function(e,t){e=a.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e])},at:function(e){return this.models[e]},where:function(e){return a.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),a.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(a.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return a.invoke(this.models,"get",e)},update:function(e,t){t=a.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var n,r,i,s,o=[],u=[],f={};a.isArray(e)||(e=e?[e]:[]);if(t.add&&!t.remove)return this.add(e,t);for(r=0,i=e.length;r<i;r++)n=e[r],s=this.get(n),t.remove&&s&&(f[s.cid]=!0),(t.add&&!s||t.merge&&s)&&o.push(n);if(t.remove)for(r=0,i=this.models.length;r<i;r++)n=this.models[r],f[n.cid]||u.push(n);return u.length&&this.remove(u,t),o.length&&this.add(o,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,a.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?a.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){var i=r.update?"update":"reset";e[i](n,r),t&&t(e,n,r)},this.sync("read",this,e)},create:function(e,t){t=t?a.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(e,t,i){i.wait&&n.add(e,i),r&&r(e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=a.isFunction(t)?t:function(e){return e.get(t)};return a.sortedIndex(this.models,e,r,n)}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];a.each(v,function(e){d.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),a[e].apply(a,t)}});var m=["groupBy","countBy","sortBy"];a.each(m,function(e){d.prototype[e]=function(t,n){var r=a.isFunction(t)?t:function(e){return e.get(t)};return a[e](this.models,r,n)}});var g=u.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,b=/(\(\?)?:\w+/g,w=/\*\w+/g,E=/[\-{}\[\]+?.,\\\^$|#\s]/g;a.extend(g.prototype,h,{initialize:function(){},route:function(e,t,n){return a.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),u.history.route(e,a.bind(function(r){var i=this._extractParameters(e,r);n&&n.apply(this,i),this.trigger.apply(this,["route:"+t].concat(i)),this.trigger("route",t,i),u.history.trigger("route",this,t,i)},this)),this},navigate:function(e,t){return u.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;var e,t=a.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(E,"\\$&").replace(y,"(?:$1)?").replace(b,function(e,t){return t?e:"([^/]+)"}).replace(w,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var S=u.History=function(){this.handlers=[],a.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},x=/^[#\/]|\s+$/g,T=/^\/+|\/+$/g,N=/msie [\w.]+/,C=/\/$/;S.started=!1,a.extend(S.prototype,h,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(C,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(x,"")},start:function(e){if(S.started)throw new Error("Backbone.history has already been started");S.started=!0,this.options=a.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=N.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(T,"/"),r&&this._wantsHashChange&&(this.iframe=u.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?u.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?u.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(x,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){u.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),S.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=a.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!S.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),u.history=new S;var k=u.View=function(e){this.cid=a.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},L=/^(\S+)\s*(.*)$/,A=["model","collection","el","id","attributes","className","tagName","events"];a.extend(k.prototype,h,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof u.$?e:u.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=a.result(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];a.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(L),i=r[1],s=r[2];n=a.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=a.extend({},a.result(this,"options"),e)),a.extend(this,a.pick(e,A)),this.options=e},_ensureElement:function(){if(!this.el){var e=a.extend({},a.result(this,"attributes"));this.id&&(e.id=a.result(this,"id")),this.className&&(e["class"]=a.result(this,"className"));var t=u.$("<"+a.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(a.result(this,"el"),!1)}});var O={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};u.sync=function(e,t,n){var r=O[e];a.defaults(n||(n={}),{emulateHTTP:u.emulateHTTP,emulateJSON:u.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=a.result(t,"url")||_()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1);var o=n.success;n.success=function(e){o&&o(t,e,n),t.trigger("sync",t,e,n)};var f=n.error;n.error=function(e){f&&f(t,e,n),t.trigger("error",t,e,n)};var l=n.xhr=u.ajax(a.extend(i,n));return t.trigger("request",t,l,n),l},u.ajax=function(){return u.$.ajax.apply(u.$,arguments)};var M=function(e,t){var n=this,r;e&&a.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},a.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&a.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=d.extend=g.extend=k.extend=S.extend=M;var _=function(){throw new Error('A "url" property or function must be specified')}}.call(this),n("backbone",["underscore"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),n("grapher/bar-graph/bar-graph-model",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({defaults:{value:0,minValue:0,maxValue:10,width:150,height:500,title:"",barColor:"green",fillColor:"white",textColor:"#555",ticks:10,tickSubdivide:1,displayLabels:!0,labelFormat:"0.1f"}});return n}),n("grapher/bar-graph/bar-graph-view",["require","backbone"],function(e){var t=e("backbone"),n={padding:{left:10,top:10,right:10,bottom:10}},r=function(e){return e.node().getBBox().width},i=function(e){return e.node().getBBox().height},s=500,o=function(e){var t=e/s;return t<.6&&(t=.6),function(e){return e*t}},u=function(e,t){var n=[],r={},i,s;for(i=0,s=t.length;i<s;i++)n[i]=t[i].value,r[n[i]]=t[i].label;e.tickValues(n).tickFormat(function(e){return r[e]})},a=t.View.extend({tagName:"div",className:"bar-graph",initialize:function(){this.vis=d3.select(this.el).append("svg"),this.fill=this.vis.append("rect"),this.bar=this.vis.append("rect"),this.title=this.vis.append("text"),this.axisContainer=this.vis.append("g"),this.yScale=d3.scale.linear(),this.heightScale=d3.scale.linear(),this.yAxis=d3.svg.axis(),this.model.on("change",this.modelChanged,this)},render:function(){var e=this.model.toJSON(),t=o(e.height),s=t(n.padding.left),a=t(n.padding.top),f=t(n.padding.bottom),l=t(n.padding.right);this.vis.attr({width:e.width,height:e.height}).style({"font-size":t(15)+"px"}),this.yScale.domain([e.minValue,e.maxValue]).range([e.height-a,f]),this.heightScale.domain([e.minValue,e.maxValue]).range([0,e.height-a-f]),e.title!==undefined&&(this.title.text(e.title).style({"font-size":"140%","text-anchor":"middle",fill:e.textColor}),l+=i(this.title),this.title.attr("transform","translate("+(e.width-l)+", "+e.height/2+") rotate(90)")),this.yAxis.scale(this.yScale).tickSubdivide(e.tickSubdivide).tickSize(t(10),t(5),t(10)).orient("right"),typeof e.ticks=="number"?this.yAxis.ticks(e.ticks).tickFormat(d3.format(e.labelFormat)):u(this.yAxis,e.ticks),this.axisContainer.call(this.yAxis),this.axisContainer.style({stroke:e.textColor,"stroke-width":t(2),fill:"none"}),this.axisContainer.selectAll("text").style({fill:e.textColor,stroke:"none","font-size":e.displayLabels?"100%":0}),e.ticks===0&&this.axisContainer.selectAll("*").remove(),l+=r(this.axisContainer)+t(7),this.axisContainer.attr("transform","translate("+
(e.width-l)+", 0)"),l+=t(5),this.fill.attr({width:e.width-s-l,height:this.heightScale(e.maxValue),x:s,y:this.yScale(e.maxValue)}).style({fill:e.fillColor}),this.bar.attr({width:e.width-s-l,x:s}).style({fill:e.barColor}),this.updateBar()},updateBar:function(){var e=this.model.get("value");this.bar.attr("height",this.heightScale(e)).attr("y",this.yScale(e))},modelChanged:function(){var e=this.model.changedAttributes(),t=0,n;for(n in e)if(e.hasOwnProperty(n)){t++;if(t>1){this.render();return}}e.value!==undefined?this.updateBar():this.render()}});return a}),n("grapher/public-api",["require","../lab.version","../lab.config","grapher/core/graph","grapher/core/real-time-graph","grapher/bar-graph/bar-graph-model","grapher/bar-graph/bar-graph-view"],function(e){"use strict";var t=e("../lab.version"),n=e("../lab.config"),r=e("grapher/core/graph"),i=e("grapher/core/real-time-graph"),s=e("grapher/bar-graph/bar-graph-model"),o=e("grapher/bar-graph/bar-graph-view"),u;return u={version:"0.0.1",graph:r,realTimeGraph:i,BarGraphModel:s,BarGraphView:o},window.Lab=window.Lab||{},window.Lab.config=n,window.Lab.grapher=u,u}),t(["grapher/public-api"],undefined,undefined,!0)})();