(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),grapher={version:"0.0.1"},grapher.data=function(e){var t=0,n=e.length,r=[];for(t=0;t<n;t+=2)r.push({x:e[t],y:e[t+1]});return r},grapher.axis={axisProcessDrag:function(e,t,n){var r,i,s=n,o=0,u=n[0],a=n[1],f=a-u;if(t!==0)if(u>=0&&a>u)o=u,r=e-o,i=r*.2+o,t>i&&(change=r/(t-o),f=a-o,s=[u,u+f*change]);else if(u<0&&a>0){o=0,r=e-o,i=r*.2+o;if(e>=0&&t>i||e<0&&t<i)change=r/(t-o),s=[u*change,a*change]}else u<0&&a<0&&(o=a,r=e-o,i=r*.2+o,t<i&&(change=r/(t-o),f=u-o,s=[a+f*change,a]));return s}},grapher.indexedData=function(e,t){var n=0,r=t||0,i=e.length,s=[];for(n=0;n<i;n++)s.push({x:n+r,y:e[n]});return s},grapher.graph=function(e,t,n){function V(e){if(e)for(var t in F)e[t]===undefined&&(e[t]=F[t]);else e=F;return e}function $(){r<=_.icon?(_.category="icon",_.value=0):r<=_.tiny?(_.category="tiny",_.value=1):r<=_.small?(_.category="small",_.value=2):r<=_.medium?(_.category="medium",_.value=3):r<=_.large?(_.category="large",_.value=4):(_.category="extralarge",_.value=5)}function J(t,n){arguments.length?(r=t,i=n,s.style.width=r+"px",s.style.height=i+"px"):(r=e.property("clientWidth"),i=e.property("clientHeight")),$(),A=layout.getDisplayProperties(),O=A.emsize}function K(e,s){if(e||!t)t=V(e);o!==undefined&&(o.remove(),o=undefined),s&&(n=s),t.dataChange?L="ns-resize":L="crosshair",J(),t.xrange=t.xmax-t.xmin,t.yrange=t.ymax-t.ymin,t.datacount=2,M=t.strokeWidth;switch(_.value){case 0:m={top:4,right:4,bottom:4,left:4};break;case 1:m={top:8,right:8,bottom:8,left:8};break;case 2:m={top:t.title?25:15,right:15,bottom:20,left:60};break;case 3:m={top:t.title?30:20,right:30,bottom:t.xlabel?60:10,left:t.ylabel?90:60};break;default:m={top:t.title?40:20,right:30,bottom:t.xlabel?60:10,left:t.ylabel?90:60}}Object.prototype.toString.call(t.title)==="[object Array]"?j=t.title:j=[t.title],j.reverse(),_.value>2?m.top+=(j.length-1)*_.value/3*_.value/3*O*22:j=[j[0]],g={width:r-m.left-m.right,height:i-m.top-m.bottom},w=function(e){return e[0]},E=function(e){return e[1]},y=d3.scale[t.xscale]().domain([t.xmin,t.xmax]).range([0,g.width]),t.xscale==="pow"&&y.exponent(t.xscaleExponent),b=d3.scale[t.yscale]().domain([t.ymin,t.ymax]).nice().range([g.height,0]).nice(),t.yscale==="pow"&&b.exponent(t.yscaleExponent),T=function(e){return"translate("+y(e)+",0)"},N=function(e){return"translate(0,"+b(e)+")"},x=function(e){return e?"#ccc":"#666"},C=y.tickFormat(t.xTicCount),k=b.tickFormat(t.yTicCount),S=d3.svg.line().x(function(e,t){return y(p[t][0])}).y(function(e,t){return b(p[t][1])}),D=NaN,P=NaN,H=B=null}function Q(v){function w(e){n=e,e?d.text(e):d.text("")}function E(){var e=t.yrange/2,n=e/2,r;return t.datacount=g.width/30,t.xtic=t.xrange/t.datacount,t.ytic=t.yrange/t.datacount,r=d3.range(t.datacount).map(function(r){return[r*t.xtic+t.xmin,t.ymin+n+Math.random()*e]}),r}function A(){if(!B)return;switch(d3.event.keyCode){case 8:case 46:if(t.dataChange){var e=p.indexOf(B);p.splice(e,1),B=p.length?p[e>0?e-1:0]:null,R()}d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}}function F(){y.domain([t.xmin,t.xmax]).range([0,g.width])}function I(){b.domain([t.ymin,t.ymax]).range([g.height,0])}function q(){var e=u.selectAll("g.x").data(y.ticks(t.xTicCount),String).attr("transform",T),n=e.enter().insert("g","a").attr("class","x").attr("transform",T);n.append("line").attr("stroke",x).attr("y1",0).attr("y2",g.height),_.value>1&&n.append("text").attr("class","axis").style("font-size",_.value/2.7*100+"%").attr("y",g.height).attr("dy","1em").attr("text-anchor","middle").text(C).style("cursor","ew-resize").on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",z).on("touchstart.drag",z),e.exit().remove();var r=u.selectAll("g.y").data(b.ticks(t.yTicCount),String).attr("transform",N),i=r.enter().insert("g","a").attr("class","y").attr("transform",N).attr("background-fill","#FFEEB6");i.append("line").attr("stroke",x).attr("x1",0).attr("x2",g.width),_.value>1&&i.append("text").attr("class","axis").style("font-size",_.value/2.7*100+"%").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").text(k).style("cursor","ns-resize").on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",X).on("touchstart.drag",X),r.exit().remove(),a.call(d3.behavior.zoom().x(y).y(b).on("zoom",q)),R()}function R(){tt(),u.select("path").attr("d",S(p));var e=u.select("svg").selectAll("circle").data(p,function(e){return e});t.circleRadius&&_.value>1&&(t.circleRadius<=4&&_.value<3||(e.enter().append("circle").attr("class",function(e){return e===B?"selected":null}).attr("cx",function(e){return y(e[0])}).attr("cy",function(e){return b(e[1])}).attr("r",t.circleRadius*(1+_.value)/4).style("stroke-width",t.circleRadius/6*(_.value-1.5)).style("cursor",L).on("mousedown.drag",V).on("touchstart.drag",V),e.attr("class",function(e){return e===B?"selected":null}).attr("cx",function(e){return y(e[0])}).attr("cy",function(e){return b(e[1])}).attr("r",t.circleRadius*(1+_.value)/4).style("stroke-width",t.circleRadius/6*(_.value-1.5)))),e.exit().remove(),d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function U(){var e;d3.event.preventDefault(),grapher.registerKeyboardHandler(A),d3.select("body").style("cursor","move");if(d3.event.altKey)if(d3.event.shiftKey&&t.addData){e=d3.svg.mouse(u.node());var n=[];n[0]=y.invert(Math.max(0,Math.min(g.width,e[0]))),n[1]=b.invert(Math.max(0,Math.min(g.height,e[1]))),p.push(n),p.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}),B=n,R()}else e=d3.svg.mouse(u[0][0]),D=y.invert(e[0]),P=b.invert(e[1]),H=!1,d3.event.stopPropagation()}function z(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.svg.mouse(u[0][0]);D=y.invert(t[0])}function X(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.svg.mouse(u[0][0]);P=b.invert(t[1])}function V(e){grapher.registerKeyboardHandler(A),document.onselectstart=function(){return!1},B=H=e,R()}function $(){var e=d3.svg.mouse(u[0][0]);d3.event.preventDefault(),H&&t.dataChange&&(H[1]=b.invert(Math.max(0,Math.min(g.height,e[1]))),R()),isNaN(D)||(d3.select("body").style("cursor","ew-resize"),y.domain(grapher.axis.axisProcessDrag(D,y.invert(e[0]),y.domain())),q(),d3.event.stopPropagation()),isNaN(P)||(d3.select("body").style("cursor","ns-resize"),b.domain(grapher.axis.axisProcessDrag(P,b.invert(e[1]),b.domain())),q(),d3.event.stopPropagation())}function G(){document.onselectstart=function(){return!0},d3.select("body").style("cursor","auto"),isNaN(D)||(D=NaN,q()),isNaN(P)||(P=NaN,q()),H=null}v||(v=e),v.each(function(){e=d3.select(this),this.clientWidth&&this.clientHeight&&(r=this.clientWidth,i=this.clientHeight,g.width=r-m.left-m.right,g.height=i-m.top-m.bottom),p=t.points,p==="fake"&&(p=E()),F(),I(),o===undefined?(o=e.append("svg").attr("width",r).attr("height",i),u=o.append("g").attr("transform","translate("+m.left+","+m.top+")"),a=u.append("rect").attr("class","plot").attr("width",g.width).attr("height",g.height).style("fill","#EEEEEE").attr("pointer-events","all").on("mousedown.drag",U).on("touchstart.drag",U).call(d3.behavior.zoom().x(y).y(b).on("zoom",q)),f=u.append("svg").attr("class","viewbox").attr("top",0).attr("left",0).attr("width",g.width).attr("height",g.height).attr("viewBox","0 0 "+g.width+" "+g.height),f.append("path").attr("class","line").style("stroke-width",M).attr("d",S(p)),W=f.append("g").attr("class","brush"),t.title&&_.value>1&&(l=u.selectAll("text").data(j,function(e){return e}),l.enter().append("text").attr("class","title").style("font-size",_.value/2.4*100+"%").text(function(e){return e}).attr("x",g.width/2).attr("dy",function(e,t){return-0.5+ -1*_.value/2.8*t*O+"em"}).style("text-anchor","middle")),t.xlabel&&_.value>2&&(c=u.append("text").attr("class","axis").style("font-size",_.value/2.6*100+"%").text(t.xlabel).attr("x",g.width/2).attr("y",g.height).attr("dy","2.4em").style("text-anchor","middle")),t.ylabel&&_.value>2&&(h=u.append("g").append("text").attr("class","axis").style("font-size",_.value/2.6*100+"%").text(t.ylabel).style("text-anchor","middle").attr("transform","translate(-50 "+g.height/2+") rotate(-90)")),d3.select(s).on("mousemove.drag",$).on("touchmove.drag",$).on("mouseup.drag",G).on("touchend.drag",G),d=u.append("text").attr("class","graph-notification").text(n).attr("x",g.width/2).attr("y",g.height/2).style("text-anchor","middle")):(u.attr("width",r).attr("height",i),a.attr("width",g.width).attr("height",g.height),f.attr("top",0).attr("left",0).attr("width",g.width).attr("height",g.height).attr("viewBox","0 0 "+g.width+" "+g.height),t.title&&_.value>1&&l.each(function(e,t){d3.select(this).attr("x",g.width/2),d3.select(this).attr("dy",function(e,t){return 1.4*t-j.length+"em"})}),t.xlabel&&_.value>1&&c.attr("x",g.width/2).attr("y",g.height),t.ylabel&&_.value>1&&h.attr("transform","translate(-40 "+g.height/2+") rotate(-90)"),d.attr("x",g.width/2).attr("y",g.height/2)),q()}),Q.elem=e,Q.redraw=q,Q.update=R,Q.notify=w,Q.points=p,Q.initialize=K,Q.updateXScale=F,Q.updateYScale=I,Q.scale=J}function G(){t.title&&l&&l.text(t.title)}function Y(){t.xlabel&&c&&c.text(t.xlabel)}function Z(){t.ylabel&&h?h.text(t.ylabel):h.style("display","none")}function et(){var e;U&&(e=X.extent(),Q.selection_domain(e[0]!==e[1]?e:[]))}function tt(){q&&R?(X=X||d3.svg.brush().x(y).extent([I.xmin||0,I.xmax||0]).on("brush",et),W.call(X.extent([I.xmin||0,I.xmax||0])).style("display","inline").style("pointer-events",U?"all":"none").selectAll("rect").attr("height",g.height)):W.style("display","none")}var r=600,i=300,s;arguments.length&&(e=d3.select(e),s=e.node(),r=e.property("clientWidth"),i=e.property("clientHeight"));var o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_={category:"medium",value:3,icon:120,tiny:240,small:480,medium:960,large:1920},D,P,H,B,j=[],F={title:"Graph",xlabel:"X Axis",ylabel:"Y Axis",xscale:"linear",yscale:"linear",xTicCount:10,yTicCount:8,xscaleExponent:.5,yscaleExponent:.5,xmax:60,xmin:0,ymax:40,ymin:0,circleRadius:10,strokeWidth:2,dataChange:!0,addData:!0,points:!1,notification:!1},I={xmin:null,xmax:null,ymin:null,ymax:null},q=!1,R=!1,U=!0,z,W,X;return K(t),Q.margin=function(e){return arguments.length?(v=e,Q):v},Q.xmin=function(e){return arguments.length?(t.xmin=e,t.xrange=t.xmax-t.xmin,Q.updateXScale&&(Q.updateXScale(),Q.redraw()),Q):t.xmin},Q.xmax=function(e){return arguments.length?(t.xmax=e,t.xrange=t.xmax-t.xmin,Q.updateXScale&&(Q.updateXScale(),Q.redraw()),Q):t.xmax},Q.ymin=function(e){return arguments.length?(t.ymin=e,t.yrange=t.ymax-t.ymin,Q.updateYScale&&(Q.updateYScale(),Q.redraw()),Q):t.ymin},Q.ymax=function(e){return arguments.length?(t.ymax=e,t.yrange=t.ymax-t.ymin,Q.updateYScale&&(Q.updateYScale(),Q.redraw()),Q):t.ymax},Q.xLabel=function(e){return arguments.length?(t.xlabel=e,Y(),Q):t.xlabel},Q.yLabel=function(e){return arguments.length?(t.ylabel=e,Z(),Q):t.ylabel},Q.title=function(e){return arguments.length?(t.title=e,G(),Q):t.title},Q.width=function(e){return arguments.length?(g.width=e,Q):g.width},Q.height=function(e){return arguments.length?(g.height=e,Q):g.height},Q.x=function(e){return arguments.length?(w=e,Q):w},Q.y=function(e){return arguments.length?(E=e,Q):E},Q.elem=function(t){return arguments.length?(e=d3.select(t),e.call(Q),Q):e},Q.data=function(e){if(!arguments.length)return p;var n=y.domain(),r=n[1]-n[0],i=r*.8;return t.points=p=e,p.length>n[1]?(n[0]+=i,n[1]+=i,y.domain(n),Q.redraw()):Q.update(),Q},Q.add_data=function(e){if(!arguments.length)return p;var t=y.domain(),n=t[1]-t[0],r=n*.8,i;if(e instanceof Array&&e.length>0)if(e[0]instanceof Array)for(i=0;i<e.length;i++)p.push(e[i]);else{if(e.length!==2)throw new Error("invalid argument to graph.add_data() "+e+" length should === 2.");p.push(e)}return p[p.length-1][0]>t[1]?(t[0]+=r,t[1]+=r,y.domain(t),Q.redraw()):Q.update(),Q},Q.selection_domain=function(e){return arguments.length?(e===null?q=!1:e.length===0?(q=!0,I.xmin=Infinity,I.xmax=Infinity):(q=!0,I.xmin=e[0],I.xmax=e[1]),tt(),z&&z(Q.selection_domain()),Q):q?I.xmax===Infinity&&I.xmin===Infinity?[]:[I.xmin,I.xmax]:null},Q.has_selection=function(){return q},Q.selection_visible=function(e){return arguments.length?(e=!!e,R!==e&&(R=e,tt()),Q):R},Q.selection_enabled=function(e){return arguments.length?(e=!!e,U!==e&&(U=e,tt()),Q):U},Q.selection_listener=function(e){return arguments.length?(z=e,Q):z},Q.brush_element=function(){return W},Q.brush_control=function(){return X},Q.brush_listener=function(){return et},Q.reset=function(e,t){return arguments.length?Q.initialize(e,t):Q.initialize(),Q(),Q},Q.resize=function(e,t){return Q.scale(e,t),Q.initialize(),Q(),Q},e&&e.call(Q),Q},grapher.realTimeGraph=function(e,t){function J(e){if(e)for(var t in $)e[t]===undefined&&(e[t]=$[t]);else e=$;return e}function K(){i<=D.icon?(D.category="icon",D.value=0):i<=D.tiny?(D.category="tiny",D.value=1):i<=D.small?(D.category="small",D.value=2):i<=D.medium?(D.category="medium",D.value=3):i<=D.large?(D.category="large",D.value=4):(D.category="extralarge",D.value=5)}function Q(e,t){arguments.length?(i=e,s=t,r.style.width=i+"px",r.style.height=s+"px"):(i=n.property("clientWidth"),s=n.property("clientHeight")),K(),A=layout.getDisplayProperties(),O=A.emsize}function G(e,n){if(e||!t)t=J(e);c!==undefined&&(c.remove(),c=undefined),n&&(message=n),z=t.sample,t.dataChange?L="ns-resize":L="crosshair",Q(),t.xrange=t.xmax-t.xmin,t.yrange=t.ymax-t.ymin,q=[];switch(D.value){case 0:S={top:4,right:4,bottom:4,left:4};break;case 1:S={top:8,right:8,bottom:8,left:8};break;case 2:S={top:t.title?25:15,right:15,bottom:20,left:20};break;case 3:S={top:t.title?30:20,right:30,bottom:t.xlabel?60:10,left:t.ylabel?70:45};break;default:S={top:t.title?40:20,right:30,bottom:t.xlabel?60:10,left:t.ylabel?70:45}}if(Object.prototype.toString.call(t.dataset[0])==="[object Array]"){for(var r=0;r<t.dataset.length;r++)q.push(Y(t.dataset[r],0,z));I=q[0]}else I=Y(t.dataset,0),q=[I];Object.prototype.toString.call(t.title)==="[object Array]"?F=t.title:F=[t.title],F.reverse(),D.value>2?S.top+=(F.length-1)*D.value/3*D.value/3*O*22:F=[F[0]],T={width:i-S.left-S.right,height:s-S.top-S.bottom},N=d3.scale[t.xscale]().domain([t.xmin,t.xmax]).range([0,T.width]),t.xscale=="pow"&&N.exponent(t.xscaleExponent),C=d3.scale[t.yscale]().domain([t.ymin,t.ymax]).nice().range([T.height,0]).nice(),t.yscale=="pow"&&C.exponent(t.yscaleExponent),f=N.tickFormat(t.xTicCount),l=C.tickFormat(t.yTicCount),k=d3.svg.line().x(function(e,t){return N(I[t].x)}).y(function(e,t){return C(I[t].y)}),P=Math.NaN,H=Math.NaN,B=null}function Y(e,t,n){var r=0,i=t||0,s=e.length,o=[];n=n||1;for(r=0;r<s;r++)o.push({x:(r+i)*n,y:e[r]});return o}function Z(){return I?I.length:!1}function et(){function e(){var n=h.selectAll("g.x").data(N.ticks(t.xTicCount),String).attr("transform",u),r=n.enter().insert("g","a").attr("class","x").attr("transform",u);r.append("line").attr("stroke",o).attr("y1",0).attr("y2",T.height),D.value>1&&r.append("text").attr("class","axis").style("font-size",D.value/2.7*100+"%").attr("y",T.height).attr("dy","1em").attr("text-anchor","middle").style("cursor","ew-resize").text(f).on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",E).on("touchstart.drag",E),n.exit().remove();var i=h.selectAll("g.y").data(C.ticks(t.yTicCount),String).attr("transform",a),s=i.enter().insert("g","a").attr("class","y").attr("transform",a).attr("background-fill","#FFEEB6");s.append("line").attr("stroke",o).attr("x1",0).attr("x2",T.width),D.value>1&&s.append("text").attr("class","axis").style("font-size",D.value/2.7*100+"%").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(l).on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",L).on("touchstart.drag",L),i.exit().remove(),p.call(d3.behavior.zoom().x(N).y(C).on("zoom",e)),b()}function b(e){ht(e);if(et.selectable_points){var t=h.selectAll("circle").data(I,function(e){return e});t.enter().append("circle").attr("class",function(e){return e===j?"selected":null}).attr("cx",function(e){return x(e.x)}).attr("cy",function(e){return y(e.y)}).attr("r",1).on("mousedown",function(e){j=B=e,b()}),t.attr("class",function(e){return e===j?"selected":null}).attr("cx",function(e){return x(e.x)}).attr("cy",function(e){return y(e.y)}),t.exit().remove()}d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function w(){d3.event.preventDefault(),p.style("cursor","move");if(d3.event.altKey){var e=d3.svg.mouse(h[0][0]);P=N.invert(e[0]),H=C.invert(e[1]),B=!1,d3.event.stopPropagation()}}function E(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.svg.mouse(h[0][0]);P=N.invert(t[0])}function L(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.svg.mouse(h[0][0]);H=C.invert(t[1])}function A(){var t=d3.svg.mouse(h[0][0]),n,r,i,s=d3.event.changedTouches;document.onselectstart=function(){return!0},d3.event.preventDefault(),isNaN(P)||(d3.select("body").style("cursor","ew-resize"),N.domain(grapher.axis.axisProcessDrag(P,N.invert(t[0]),N.domain())),e(),d3.event.stopPropagation()),isNaN(H)||(d3.select("body").style("cursor","ns-resize"),C.domain(grapher.axis.axisProcessDrag(H,C.invert(t[1]),C.domain())),e(),d3.event.stopPropagation())}function M(){d3.select("body").style("cursor","auto"),document.onselectstart=function(){return!0},isNaN(P)||(e(),P=Math.NaN),isNaN(H)||(e(),H=Math.NaN),B=null}function _(e){R={x:I[e].x,y:I[e].y}}function $(){var t,n=N.domain(),r=n[1]-n[0],i=I.length*z,s=r*.9;i>n[1]?(n[0]+=s,n[1]+=s,N.domain(n),e()):b()}function J(e){if(I.length===0)return;R=!1;var t=I.length,n=t*z,r={x:n,y:e},i,s;I.push(r),$()}function K(e){if(I.length===0)return;J(e),$()}function tt(e){if(I.length===0)return;R=!1;var t=I.length,n=t*z,r=n-z,i={x:n,y:e},s=N.call(self,r,r),o=C.call(self,I[t-1].y,t-1),u,a;I.push(i),u=N.call(self,n,n),a=C.call(self,e,n),X.beginPath(),X.moveTo(s,o),X.lineTo(u,a),X.stroke()}function nt(e){for(var t=0;t<q.length;t++)I=q[t],J(e[t]);$()}function rt(e){for(var t=0;t<q.length;t++)I=q[t],it(t),tt(e[t])}function it(e,t){var n=t?.4:1;switch(e){case 0:X.strokeStyle="rgba(160,00,0,"+n+")";break;case 1:X.strokeStyle="rgba(44,160,0,"+n+")";break;case 2:X.strokeStyle="rgba(44,0,160,"+n+")"}}function st(e,t){var n=t?.4:1;switch(e){case 0:X.fillStyle="rgba(160,00,0,"+n+")";break;case 1:X.fillStyle="rgba(44,160,0,"+n+")";break;case 2:X.fillStyle="rgba(44,0,160,"+n+")"}}function ot(e){var n;q=[];if(Object.prototype.toString.call(e)==="[object Array]")for(n=0;n<e.length;n++)I=Y(e[n],0,z),q.push(I);else I=Y(t.dataset,0,z),q=[I];$()}function ut(n){x=d3.scale[t.xscale]().domain([0,n]).range([0,T.width]),et.xmax=n,x_tics_scale=d3.scale[t.xscale]().domain([et.xmin*et.sample,et.xmax*et.sample]).range([0,T.width]),b(),e()}function at(n){y=d3.scale[t.yscale]().domain([n,0]).range([0,T.height]),et.ymax=n,b(),e()}function ft(){W.width=W.width,X.fillStyle="rgba(0,255,0, 0.05)",X.fillRect(0,0,W.width,W.height),X.strokeStyle="rgba(255,65,0, 1.0)"}function lt(){h.select("path.line").attr("d",[]),W.style.zIndex=100}function ct(){W.style.zIndex=-100,b()}function ht(e){var n,r,i,s,o,u=C(1e-5),a=t.lines,f=t.bars,l=2*Math.PI;typeof e=="undefined"?s=q[0].length:s=e;if(I.length===0)return;ft(),X.fillRect(0,0,W.width,W.height);if(a)for(n=0;n<q.length;n++){I=q[n],px=N(0),i=C(I[0].y),r=0,lengthX=0,it(n),X.beginPath(),X.moveTo(px,i),o=s-1;for(r=1;r<o;r++)lengthX+=z,px=N(lengthX),i=C(I[r].y),X.lineTo(px,i);X.stroke(),o=I.length-1;if(r<o){it(n,!0);for(;r<o;r++)lengthX+=z,px=N(lengthX),i=C(I[r].y),X.lineTo(px,i);X.stroke()}}else if(f)for(n=0;n<q.length;n++){I=q[n],lengthX=0,it(n),o=s-1;for(r=0;r<o;r++){px=N(lengthX),i=C(I[r].y);if(i===0)continue;X.beginPath(),X.moveTo(px,u),X.lineTo(px,i),X.stroke(),lengthX+=z}o=I.length-1;if(r<o){it(n,!0);for(;r<o;r++)px=N(lengthX),i=C(I[r].y),X.beginPath(),X.moveTo(px,u),X.lineTo(px,i),X.stroke(),lengthX+=z}}else for(n=0;n<q.length;n++){I=q[n],lengthX=0,st(n),it(n,!0),o=s-1;for(r=0;r<o;r++)px=N(lengthX),i=C(I[r].y),X.arc(px,i,1,0,l,!1),X.fill(),lengthX+=z;o=I.length-1;if(r<o){st(n,!0),it(n,!0);for(;r<o;r++)px=N(lengthX),i=C(I[r].y),X.arc(px,i,1,0,l,!1),X.fill(),lengthX+=z}}}function pt(){W||(W=W||document.createElement("canvas"),r.appendChild(W)),W.style.zIndex=-100,vt(W)}function dt(){vt(W),ht()}function vt(e){V.rect=p.node(),V.width=V.rect.width.baseVal.value,V.height=V.rect.height.baseVal.value,V.left=V.rect.getCTM().e,V.top=V.rect.getCTM().f,e.style.position="absolute",e.width=V.width,e.height=V.height,e.style.width=V.width+"px",e.style.height=V.height+"px",e.offsetLeft=V.left,e.offsetTop=V.top,e.style.left=V.left+"px",e.style.top=V.top+"px",e.style.border="solid 1px red",e.style.pointerEvents="none",e.className+="canvas-overlay",X=W.getContext("2d"),X.globalCompositeOperation="source-over",X.lineWidth=1,X.fillStyle="rgba(0,255,0, 0.05)",X.fillRect(0,0,e.width,W.height),X.strokeStyle="rgba(255,65,0, 1.0)",W.style.border="solid 1px red"}Q(),c===undefined?(c=n.append("svg").attr("width",i).attr("height",s),h=c.append("g").attr("transform","translate("+S.left+","+S.top+")"),p=h.append("rect").attr("class","plot").attr("width",T.width).attr("height",T.height).style("fill","#EEEEEE").attr("pointer-events","all").on("mousedown",w).on("touchstart",w),p.call(d3.behavior.zoom().x(N).y(C).on("zoom",e)),d=h.append("svg").attr("class","viewbox").attr("top",0).attr("left",0).attr("width",T.width).attr("height",T.height).attr("viewBox","0 0 "+T.width+" "+T.height).append("path").attr("class","line").attr("d",k(I)),U=d.append("path").attr("class","marker").attr("d",[]),t.title&&D.value>1&&(v=h.selectAll("text").data(F,function(e){return e}),v.enter().append("text").attr("class","title").style("font-size",D.value/2.4*100+"%").text(function(e){return e}).attr("x",T.width/2).attr("dy",function(e,t){return-0.5+ -1*D.value/2.8*t*O+"em"}).style("text-anchor","middle")),t.xlabel&&D.value>2&&(m=h.append("text").attr("class","axis").style("font-size",D.value/2.6*100+"%").attr("class","xlabel").text(t.xlabel).attr("x",T.width/2).attr("y",T.height).attr("dy","2.4em").style("text-anchor","middle")),t.ylabel&&D.value>2&&(g=h.append("g").append("text").attr("class","axis").style("font-size",D.value/2.6*100+"%").attr("class","ylabel").text(t.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+T.height/2+") rotate(-90)")),d3.select(r).on("mousemove.drag",A).on("touchmove.drag",A).on("mouseup.drag",M).on("touchend.drag",M),pt(),lt()):(h.attr("width",i).attr("height",s),p.attr("width",T.width).attr("height",T.height).style("fill","#EEEEEE"),d.attr("top",0).attr("left",0).attr("width",T.width).attr("height",T.height).attr("viewBox","0 0 "+T.width+" "+T.height),t.title&&D.value>1&&v.each(function(e,t){d3.select(this).attr("x",T.width/2),d3.select(this).attr("dy",function(e,t){return 1.4*t-F.length+"em"})}),t.xlabel&&D.value>1&&m.attr("x",T.width/2).attr("y",T.height),t.ylabel&&D.value>1&&g.attr("transform","translate(-40 "+T.height/2+") rotate(-90)"),h.selectAll("g.x").remove(),h.selectAll("g.y").remove(),dt()),e(),et.node=r,et.scale=Q,et.update=b,et.redraw=e,et.initialize=G,et.number_of_points=Z,et.new_data=ot,et.add_point=K,et.add_points=nt,et.add_canvas_point=tt,et.add_canvas_points=rt,et.initialize_canvas=pt,et.show_canvas=lt,et.hide_canvas=ct,et.clear_canvas=ft,et.update_canvas=ht,et.showMarker=_,et.change_xaxis=ut,et.change_yaxis=at}var n=d3.select(e),r=n.node(),i=n.property("clientWidth"),s=n.property("clientHeight"),o=function(e){return e?"#ccc":"#666"},u=function(e){return"translate("+N(e)+",0)"},a=function(e){return"translate(0,"+C(e)+")"},f,l,c,h,p,d,v,m,g,b,w,E,S,T,N,C,k,L,A,O,M,_,D={category:"medium",value:3,icon:120,tiny:240,small:480,medium:960,large:1920},P=Math.NaN,H=Math.NaN,B=null,j=null,F=[],I,q,R,U,z,W,X,V={},$={title:"graph",xlabel:"x-axis",ylabel:"y-axis",xscale:"linear",yscale:"linear",xTicCount:10,yTicCount:8,xscaleExponent:.5,yscaleExponent:.5,xmax:10,xmin:0,ymax:10,ymin:0,dataset:[0],selectable_points:!0,circleRadius:!1,dataChange:!1,points:!1,sample:1,lines:!0,bars:!1};return G(t),et.add_data=function(e){if(!arguments.length)return I;var t=N.domain(),n=t[1]-t[0],r=n*.8,i;if(e instanceof Array&&e.length>0)if(e[0]instanceof Array)for(i=0;i<e.length;i++)I.push(e[i]);else{if(e.length!==2)throw new Error("invalid argument to graph.add_data() "+e+" length should === 2.");I.push(e)}return I[I.length-1][0]>t[1]?(t[0]+=r,t[1]+=r,N.domain(t),et.redraw()):et.update(),et},et.reset=function(e,t){return arguments.length?et.initialize(e,t):et.initialize(),et(),et},et.resize=function(e,t){return et.scale(e,t),et.initialize(),et(),et},r&&et(),et},grapher.colors=function(e){var t={bright_red:"#ff0000",dark_red:"#990000",bright_blue:"#4444ff",dark_blue:"#110077",bright_green:"#00dd00",dark_green:"#118800",bright_purple:"#cc00cc",dark_purple:"#770099",bright_orange:"#ee6600",dark_orange:"#aa4400",bright_turquoise:"#00ccbb",dark_turquoise:"#008877"};return t[e]},grapher.registerKeyboardHandler=function(e){d3.select(window).on("keydown",e)}})();