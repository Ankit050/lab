(function(){var e,t,n;(function(r){function c(e,t){var n=t&&t.split("/"),r=o.map,i=r&&r["*"]||{},s,u,a,f,l,c,h,p,d,v;if(e&&e.charAt(0)==="."&&t){n=n.slice(0,n.length-1),e=n.concat(e.split("/"));for(p=0;v=e[p];p++)if(v===".")e.splice(p,1),p-=1;else if(v===".."){if(p===1&&(e[2]===".."||e[0]===".."))return!0;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}if((n||i)&&r){s=e.split("/");for(p=s.length;p>0;p-=1){u=s.slice(0,p).join("/");if(n)for(d=n.length;d>0;d-=1){a=r[n.slice(0,d).join("/")];if(a){a=a[u];if(a){f=a,l=p;break}}}if(f)break;!c&&i&&i[u]&&(c=i[u],h=p)}!f&&c&&(f=c,l=h),f&&(s.splice(0,l,f),e=s.join("/"))}return e}function h(e,t){return function(){return l.apply(r,a.call(arguments,0).concat([e,t]))}}function p(e){return function(t){return c(t,e)}}function d(e){return function(t){i[e]=t}}function v(e){if(s.hasOwnProperty(e)){var t=s[e];delete s[e],u[e]=!0,f.apply(r,t)}if(!i.hasOwnProperty(e))throw new Error("No "+e);return i[e]}function m(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=c(e.slice(0,i),t),e=e.slice(i+1),r=v(n),r&&r.normalize?e=r.normalize(e,p(t)):e=c(e,t)):e=c(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function g(e){return function(){return o&&o.config&&o.config[e]||{}}}var i={},s={},o={},u={},a=[].slice,f,l;f=function(e,t,n,o){var a=[],f,l,c,p,y,b;o=o||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(b=0;b<t.length;b++){y=m(t[b],o),c=y.f;if(c==="require")a[b]=h(e);else if(c==="exports")a[b]=i[e]={},f=!0;else if(c==="module")l=a[b]={id:e,uri:"",exports:i[e],config:g(e)};else if(i.hasOwnProperty(c)||s.hasOwnProperty(c))a[b]=v(c);else if(y.p)y.p.load(y.n,h(o,!0),d(c),{}),a[b]=i[c];else if(!u[c])throw new Error(e+" missing "+c)}p=n.apply(i[e],a);if(e)if(l&&l.exports!==r&&l.exports!==i[e])i[e]=l.exports;else if(p!==r||!f)i[e]=p}else e&&(i[e]=n)},e=t=l=function(e,t,n,i){return typeof e=="string"?v(m(e,t).f):(e.splice||(o=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},i?f(r,e,t,n):setTimeout(function(){f(r,e,t,n)},15),l)},l.config=function(e){return o=e,l},n=function(e,t,n){t.splice||(n=t,t=[]),s[e]=[e,t,n]},n.amd={jQuery:!0}})(),n("../vendor/almond/almond",function(){}),n("grapher/core/axis",["require"],function(e){return{axisProcessDrag:function(e,t,n){var r,i,s=n,o=0,u=n[0],a=n[1],f=a-u;if(t!==0)if(u>=0&&a>u)o=u,r=e-o,i=r*.2+o,t>i&&(change=r/(t-o),f=a-o,s=[u,u+f*change]);else if(u<0&&a>0){o=0,r=e-o,i=r*.2+o;if(e>=0&&t>i||e<0&&t<i)change=r/(t-o),s=[u*change,a*change]}else u<0&&a<0&&(o=a,r=e-o,i=r*.2+o,t<i&&(change=r/(t-o),f=u-o,s=[a+f*change,a]));return s}}}),n("grapher/core/register-keyboard-handler",["require"],function(e){return function(t){d3.select(window).on("keydown",t)}}),n("common/layout/layout",["require"],function(e){var t={version:"0.0.1"};return t.selection="",t.display={},t.canonical={width:1280,height:800},t.regular_display=!1,t.not_rendered=!0,t.fontsize=!1,t.cancelFullScreen=!1,t.screen_factor=1,t.checkbox_factor=1.1,t.checkbox_scale=1.1,t.fullScreenRender=!1,t.canonical.width=1280,t.canonical.height=800,t.getDisplayProperties=function(e){return arguments.length||(e={}),e.screen={width:screen.width,height:screen.height},e.client={width:document.body.clientWidth,height:document.body.clientHeight},e.window={width:$(window).width(),height:$(window).height()},e.page={width:t.getPageWidth(),height:t.getPageHeight()},e.screen_factor_width=e.window.width/t.canonical.width,e.screen_factor_height=e.window.height/t.canonical.height,e.emsize=Math.max(e.screen_factor_width*1.1,e.screen_factor_height),e},t.setBodyEmsize=function(e){var n,r=$("button.component"),i;t.display||(t.display=t.getDisplayProperties()),n=Math.max(t.display.screen_factor_width*1.2,t.display.screen_factor_height*1.2),e&&(n*=e),$("body").css("font-size",n+"em"),n<=.5?(i=.7/n,r.css("font-size",i+"em")):r.css("font-size","")},t.getVizProperties=function(e){var n=$("#viz");return arguments.length||(e={}),e.width=n.width(),e.height=n.height(),e.screen_factor_width=e.width/t.canonical.width,e.screen_factor_height=e.height/t.canonical.height,e.emsize=Math.min(e.screen_factor_width*1.1,e.screen_factor_height),e},t.setVizEmsize=function(){var e,n=$("#viz");t.vis||(t.vis=t.getVizProperties()),e=Math.min(t.viz.screen_factor_width*1.2,t.viz.screen_factor_height*1.2),n.css("font-size",e+"em")},t.screenEqualsPage=function(){return t.display.screen.width===t.display.page.width||t.display.screen.height===t.display.page.height},t.checkForResize=function(){(t.display.screen.width!==screen.width||t.display.screen.height!==screen.height||t.display.window.width!==document.width||t.display.window.height!==document.height)&&t.setupScreen()},t.views={},t.addView=function(e,n){t.views[e]||(t.views[e]=[]),t.views[e].push(n)},t.setView=function(e,n){t.views[e]=n},t.setupScreen=function(e){function s(){var e,t,i,s,o,u,a,f=.85,l=.0015,c={},h=$(window).width(),p=$(window).height(),d=$("#model-container").width(),i;s=r.moleculeContainers[0].scale(),o=s[2]/s[3],u=.85,modelWidthPaddingFactor=s[0]/s[2]-1.05,u-=modelWidthPaddingFactor,modelHeightPaddingFactor=s[1]/s[3]-1.05,f-=modelHeightPaddingFactor,r.thermometers&&(u-=.05),r.energyGraphs&&(u-=.35),n<=.5&&(l*=.5/n),r.bottomItems=$("#bottom").children().length,r.bottomItems&&(f-=$("#bottom").height()*l),t=h*u,i=t/o,i>p*f&&(i=p*f,t=i*o),c.moleculeContainers=[t,i],r.energyGraphs&&(c.energyGraphs=[h*.4]),r.moleculeContainers[0].resize(t,i),i=$("#model-container").height(),$("#rightwide").height(i),r.barGraphs&&(c.barGraphs=[35+i*.22]);for(viewType in r){if(viewType==="moleculeContainers")continue;if(r.hasOwnProperty(viewType)&&r[viewType].length){e=-1;while(++e<r[viewType].length)c[viewType]?r[viewType][e].resize(c[viewType][0],c[viewType][1]):r[viewType][e].resize()}}}function o(){var e,t,i,s,o,u,a,f=.85,l=.0015,c={},h=$("#content").width(),p=$("#content").height(),i;s=r.moleculeContainers[0].scale(),o=s[2]/s[3],u=.85,modelWidthPaddingFactor=s[0]/s[2]-1.05,u-=modelWidthPaddingFactor,modelHeightPaddingFactor=s[1]/s[3]-1.05,f-=modelHeightPaddingFactor,r.thermometers&&(u-=.05),r.barGraphs&&(u-=.15),r.energyGraphs&&(u-=.35),n<=.5&&(l*=.5/n),r.bottomItems=$("#bottom").children().length,r.bottomItems&&(f-=$("#bottom").height()*l),t=h*u,i=t/o,i>p*f&&(i=p*f,t=i*o),c.moleculeContainers=[t,i],r.energyGraphs&&(c.energyGraphs=[h*.4]),r.moleculeContainers[0].resize(t,i),i=$("#model-container").height(),$("#rightwide").height(i),r.barGraphs&&(c.barGraphs=[35+i*.22]);for(viewType in r){if(viewType==="moleculeContainers")continue;if(r.hasOwnProperty(viewType)&&r[viewType].length){e=-1;while(++e<r[viewType].length)c[viewType]?r[viewType][e].resize(c[viewType][0],c[viewType][1]):r[viewType][e].resize()}}}function u(){var e,n,i,s,o,u=t.display.page.width,a=t.display.page.height;s=r.moleculeContainers[0].scale(),o=s[0]/s[1],n=u*.4,i=n*1/o,e=-1;while(++e<r.moleculeContainers.length)r.moleculeContainers[e].resize(n,i);if(r.appletContainers){e=-1;while(++e<r.appletContainers.length)r.appletContainers[e].resize(n,i)}}function a(){var e,n,i,s,o,u,a,f,l,c=t.display.page.width,h=t.display.page.height;s=r.moleculeContainers[0].scale(),l=s[0]/s[1],f=s[0]/c,n=c*.46,i=n*1/l,i>h*.7&&(i=h*.7,n=i*l),e=-1;while(++e<r.moleculeContainers.length)r.moleculeContainers[e].resize(n,i);a=(c-n)*.41,o=i*.42,e=-1;while(++e<r.potentialCharts.length)r.potentialCharts[e].resize(a,o);e=-1;while(++e<r.speedDistributionCharts.length)r.speedDistributionCharts[e].resize(a,o);u=(c-n)*.86,o=i*.57,e=-1;while(++e<r.energyCharts.length)r.energyCharts[e].resize(u,o)}function f(){var e,n,i,s,o,u,a,f,l,c=t.display.page.width,h=t.display.page.height;s=r.moleculeContainers[0].scale(),l=s[0]/s[1],f=s[0]/c,n=c*.6,i=n*1/l,i>h*.6&&(i=h*.6,n=i*l),r.moleculeContainers[0].resize(n,i)}var n,r=t.views,i=document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen;e&&e.forceRender&&(t.not_rendered=!0),t.display=t.getDisplayProperties(),t.viz=t.getVizProperties(),t.regular_display||(t.regular_display=t.getDisplayProperties());if(i||t.fullScreenRender||t.screenEqualsPage()){t.fullScreenRender=!0,t.screen_factor_width=t.display.page.width/t.canonical.width,t.screen_factor_height=t.display.page.height/t.canonical.height,t.screen_factor=t.screen_factor_height,t.checkbox_factor=Math.max(.8,t.checkbox_scale*t.screen_factor),$("body").css("font-size",t.screen_factor+"em"),t.not_rendered=!0;switch(t.selection){case"simple-screen":t.not_rendered&&f();break;case"simple-static-screen":t.not_rendered&&f();break;case"compare-screen":n=Math.min(t.screen_factor_width*1.1,t.screen_factor_height),$("body").css("font-size",n+"em"),u(),t.not_rendered=!1;break;default:t.not_rendered&&a()}}else{t.cancelFullScreen||t.fullScreenRender?(t.cancelFullScreen=!1,t.fullScreenRender=!1,t.not_rendered=!0,t.regular_display=t.previous_display):t.regular_display=t.getDisplayProperties(),t.screen_factor_width=t.display.page.width/t.canonical.width,t.screen_factor_height=t.display.page.height/t.canonical.height,t.screen_factor=t.screen_factor_height,t.checkbox_factor=Math.max(.8,t.checkbox_scale*t.screen_factor);switch(t.selection){case"full-static-screen":t.not_rendered&&(n=Math.min(t.screen_factor_width*1.5,t.screen_factor_height),$("body").css("font-size",n+"em"),regularScreen(),t.not_rendered=!1);break;case"compare-screen":n=Math.min(t.screen_factor_width*1.1,t.screen_factor_height),$("body").css("font-size",n+"em"),u();break;case"interactive":t.not_rendered&&(t.setVizEmsize(),setupInteractiveScreen(),t.not_rendered=!1);break;case"interactive-iframe":t.setBodyEmsize(),s();break;case"interactive-author-iframe":t.setBodyEmsize(.7),o();break;default:t.setVizEmsize(),setupRegularScreen()}t.regular_display=t.getDisplayProperties()}},t.getPageHeight=function(){return $(document).height()},t.getPageWidth=function(){return $(document).width()},t}),n("grapher/core/graph",["require","grapher/core/axis","grapher/core/register-keyboard-handler","common/layout/layout"],function(e){var t=e("grapher/core/axis"),n=e("grapher/core/register-keyboard-handler"),r=e("common/layout/layout");return function(i,s,o){function Z(e){if(e)for(var t in X)e[t]===undefined&&(e[t]=X[t]);else e=X;return e.axisShift<1&&(e.axisShift=1),e}function et(){u<=I.icon?(I.category="icon",I.value=0):u<=I.tiny?(I.category="tiny",I.value=1):u<=I.small?(I.category="small",I.value=2):u<=I.medium?(I.category="medium",I.value=3):u<=I.large?(I.category="large",I.value=4):(I.category="extralarge",I.value=5)}function tt(e,t){arguments.length?(u=e,a=t,f.style.width=u+"px",f.style.height=a+"px"):(u=i.property("clientWidth"),a=i.property("clientHeight")),et(),B=r.getDisplayProperties(),j=B.emsize}function nt(e,t){if(e||!s)s=Z(e);l!==undefined&&(l.remove(),l=undefined),t&&(o=t),s.dataChange?H="ns-resize":H="crosshair",tt(),s.xrange=s.xmax-s.xmin,s.yrange=s.ymax-s.ymin,s.datacount=2,F=s.strokeWidth;switch(I.value){case 0:w={top:4,right:4,bottom:4,left:4};break;case 1:w={top:8,right:8,bottom:8,left:8};break;case 2:w={top:s.title?25:15,right:15,bottom:20,left:60};break;case 3:w={top:s.title?30:20,right:30,bottom:s.xlabel?60:10,left:s.ylabel?90:60};break;default:w={top:s.title?40:20,right:30,bottom:s.xlabel?60:10,left:s.ylabel?90:60}}Object.prototype.toString.call(s.title)==="[object Array]"?W=s.title:W=[s.title],W.reverse(),I.value>2?w.top+=(W.length-1)*I.value/3*I.value/3*j*22:W=[W[0]],E={width:u-w.left-w.right,height:a-w.top-w.bottom},T=function(e){return e[0]},N=function(e){return e[1]},S=d3.scale[s.xscale]().domain([s.xmin,s.xmax]).range([0,E.width]),s.xscale==="pow"&&S.exponent(s.xscaleExponent),x=d3.scale[s.yscale]().domain([s.ymin,s.ymax]).range([E.height,0]),s.yscale==="pow"&&x.exponent(s.yscaleExponent),M=function(e){return"translate("+S(e)+",0)"},_=function(e){return"translate(0,"+x(e)+")"},O=function(e){return e?"#ccc":"#666"},D=d3.format(s.xFormatter),P=d3.format(s.yFormatter),C=d3.svg.line().x(function(e,t){return S(g[t][0])}).y(function(e,t){return x(g[t][1])}),q=NaN,R=NaN,U=z=null}function rt(e){function r(e){o=e,e?y.text(e):y.text("")}function b(){var e=s.yrange/2,t=e/2,n;return s.datacount=E.width/30,s.xtic=s.xrange/s.datacount,s.ytic=s.yrange/s.datacount,n=d3.range(s.datacount).map(function(n){return[n*s.xtic+s.xmin,s.ymin+t+Math.random()*e]}),n}function T(){if(!z)return;switch(d3.event.keyCode){case 8:case 46:if(s.dataChange){var e=g.indexOf(z);g.splice(e,1),z=g.length?g[e>0?e-1:0]:null,V()}d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}}function N(){S.domain([s.xmin,s.xmax]).range([0,E.width])}function B(){x.domain([s.ymin,s.ymax]).range([E.height,0])}function X(){var e=c.selectAll("g.x").data(S.ticks(s.xTicCount),String).attr("transform",M),t=e.enter().insert("g","a").attr("class","x").attr("transform",M);t.append("line").attr("stroke",O).attr("y1",0).attr("y2",E.height),I.value>1&&t.append("text").attr("class","axis").style("font-size",I.value/2.7*100+"%").attr("y",E.height).attr("dy","1em").attr("text-anchor","middle").text(D).style("cursor","ew-resize").on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",J).on("touchstart.drag",J),e.exit().remove();var n=c.selectAll("g.y").data(x.ticks(s.yTicCount),String).attr("transform",_),r=n.enter().insert("g","a").attr("class","y").attr("transform",_).attr("background-fill","#FFEEB6");r.append("line").attr("stroke",O).attr("x1",0).attr("x2",E.width);if(I.value>1){if(s.yscale==="log"){var i=r[0].length;i>100?r=r.filter(function(e){return!!e.toString().match(/(\.[0]*|^)[1]/)}):i>50?r=r.filter(function(e){return!!e.toString().match(/(\.[0]*|^)[12]/)}):r=r.filter(function(e){return!!e.toString().match(/(\.[0]*|^)[125]/)})}r.append("text").attr("class","axis").style("font-size",I.value/2.7*100+"%").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").text(P).style("cursor","ns-resize").on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",K).on("touchstart.drag",K)}n.exit().remove(),h.call(d3.behavior.zoom().x(S).y(x).on("zoom",X)),V()}function V(){at(),c.select("path").attr("d",C(g));var e=c.select("svg").selectAll("circle").data(g,function(e){return e});s.circleRadius&&I.value>1&&(s.circleRadius<=4&&I.value<3||(e.enter().append("circle").attr("class",function(e){return e===z?"selected":null}).attr("cx",function(e){return S(e[0])}).attr("cy",function(e){return x(e[1])}).attr("r",s.circleRadius*(1+I.value)/4).style("stroke-width",s.circleRadius/6*(I.value-1.5)).style("cursor",H).on("mousedown.drag",Q).on("touchstart.drag",Q),e.attr("class",function(e){return e===z?"selected":null}).attr("cx",function(e){return S(e[0])}).attr("cy",function(e){return x(e[1])}).attr("r",s.circleRadius*(1+I.value)/4).style("stroke-width",s.circleRadius/6*(I.value-1.5)))),e.exit().remove(),d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function $(){var e;d3.event.preventDefault(),n(T),d3.select("body").style("cursor","move");if(d3.event.altKey)if(d3.event.shiftKey&&s.addData){e=d3.svg.mouse(c.node());var t=[];t[0]=S.invert(Math.max(0,Math.min(E.width,e[0]))),t[1]=x.invert(Math.max(0,Math.min(E.height,e[1]))),g.push(t),g.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}),z=t,V()}else e=d3.svg.mouse(c[0][0]),q=S.invert(e[0]),R=x.invert(e[1]),U=!1,d3.event.stopPropagation()}function J(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.svg.mouse(c[0][0]);q=S.invert(t[0])}function K(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.svg.mouse(c[0][0]);R=x.invert(t[1])}function Q(e){n(T),document.onselectstart=function(){return!1},z=U=e,V()}function Y(){var e=d3.svg.mouse(c[0][0]);d3.event.preventDefault(),U&&s.dataChange&&(U[1]=x.invert(Math.max(0,Math.min(E.height,e[1]))),V()),isNaN(q)||(d3.select("body").style("cursor","ew-resize"),S.domain(t.axisProcessDrag(q,S.invert(e[0]),S.domain())),X(),d3.event.stopPropagation()),isNaN(R)||(d3.select("body").style("cursor","ns-resize"),x.domain(t.axisProcessDrag(R,x.invert(e[1]),x.domain())),X(),d3.event.stopPropagation())}function Z(){document.onselectstart=function(){return!0},d3.select("body").style("cursor","auto"),isNaN(q)||(q=NaN,X()),isNaN(R)||(R=NaN,X()),U=null}function et(){var e,t=S.domain(),n=t[1]-t[0],r=n*.8;k?(k=A())?X():V():g[g.length-1][0]>t[0]+r?(A=it(r*.75,s.axisShift),k=A(),X()):V()}function it(e,t){var n=S.domain()[0],r=S.domain()[1],i=1/t,s=0;return function(){var t;return s+=i,t=e*L(s),S.domain([n+t,r+t]),S.domain()[0]<n+e}}e||(e=i),e.each(function(){i=d3.select(this),this.clientWidth&&this.clientHeight&&(u=this.clientWidth,a=this.clientHeight,E.width=u-w.left-w.right,E.height=a-w.top-w.bottom),g=s.points,g==="fake"&&(g=b()),N(),B(),l===undefined?(l=i.append("svg").attr("width",u).attr("height",a),c=l.append("g").attr("transform","translate("+w.left+","+w.top+")"),h=c.append("rect").attr("class","plot").attr("width",E.width).attr("height",E.height).style("fill","#EEEEEE").attr("pointer-events","all").on("mousedown.drag",$).on("touchstart.drag",$).call(d3.behavior.zoom().x(S).y(x).on("zoom",X)),p=c.append("svg").attr("class","viewbox").attr("top",0).attr("left",0).attr("width",E.width).attr("height",E.height).attr("viewBox","0 0 "+E.width+" "+E.height),p.append("path").attr("class","line").style("stroke-width",F).attr("d",C(g)),G=p.append("g").attr("class","brush"),s.title&&I.value>1&&(d=c.selectAll("text").data(W,function(e){return e}),d.enter().append("text").attr("class","title").style("font-size",I.value/2.4*100+"%").text(function(e){return e}).attr("x",E.width/2).attr("dy",function(e,t){return-0.5+ -1*I.value/2.8*t*j+"em"}).style("text-anchor","middle")),s.xlabel&&I.value>2&&(v=c.append("text").attr("class","axis").style("font-size",I.value/2.6*100+"%").text(s.xlabel).attr("x",E.width/2).attr("y",E.height).attr("dy","2.4em").style("text-anchor","middle")),s.ylabel&&I.value>2&&(m=c.append("g").append("text").attr("class","axis").style("font-size",I.value/2.6*100+"%").text(s.ylabel).style("text-anchor","middle").attr("transform","translate(-50 "+E.height/2+") rotate(-90)")),d3.select(f).on("mousemove.drag",Y).on("touchmove.drag",Y).on("mouseup.drag",Z).on("touchend.drag",Z),y=c.append("text").attr("class","graph-notification").text(o).attr("x",E.width/2).attr("y",E.height/2).style("text-anchor","middle")):(c.attr("width",u).attr("height",a),h.attr("width",E.width).attr("height",E.height),p.attr("top",0).attr("left",0).attr("width",E.width).attr("height",E.height).attr("viewBox","0 0 "+E.width+" "+E.height),s.title&&I.value>1&&d.each(function(e,t){d3.select(this).attr("x",E.width/2),d3.select(this).attr("dy",function(e,t){return 1.4*t-W.length+"em"})}),s.xlabel&&I.value>1&&v.attr("x",E.width/2).attr("y",E.height),s.ylabel&&I.value>1&&m.attr("transform","translate(-40 "+E.height/2+") rotate(-90)"),y.attr("x",E.width/2).attr("y",E.height/2)),X()}),rt.elem=i,rt.redraw=X,rt.update=V,rt.notify=r,rt.points=g,rt.initialize=nt,rt.updateXScale=N,rt.updateYScale=B,rt.scale=tt,rt.updateOrRescale=et}function it(){s.title&&d&&d.text(s.title)}function st(){s.xlabel&&v&&v.text(s.xlabel)}function ot(){s.ylabel&&m?m.text(s.ylabel):m.style("display","none")}function ut(){var e;K&&(e=Y.extent(),rt.selection_domain(e[0]!==e[1]?e:[]))}function at(){$&&J?(Y=Y||d3.svg.brush().x(S).extent([V.xmin||0,V.xmax||0]).on("brush",ut),G.call(Y.extent([V.xmin||0,V.xmax||0])).style("display","inline").style("pointer-events",K?"all":"none").selectAll("rect").attr("height",E.height)):G.style("display","none")}var u=600,a=300,f;arguments.length&&(i=d3.select(i),f=i.node(),u=i.property("clientWidth"),a=i.property("clientHeight"));var l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k=!1,L=d3.ease("cubic"),A,O,M,_,D,P,H,B,j,F,I={category:"medium",value:3,icon:120,tiny:240,small:480,medium:960,large:1920},q,R,U,z,W=[],X={title:"Graph",xlabel:"X Axis",ylabel:"Y Axis",xscale:"linear",yscale:"linear",xTicCount:10,yTicCount:8,xFormatter:"3.3r",yFormatter:"3.3r",xscaleExponent:.5,yscaleExponent:.5,axisShift:10,xmax:60,xmin:0,ymax:40,ymin:0,circleRadius:10,strokeWidth:2,dataChange:!0,addData:!0,points:!1,notification:!1},V={xmin:null,xmax:null,ymin:null,ymax:null},$=!1,J=!1,K=!0,Q,G,Y;return nt(s),rt.margin=function(e){return arguments.length?(b=e,rt):b},rt.xmin=function(e){return arguments.length?(s.xmin=e,s.xrange=s.xmax-s.xmin,rt.updateXScale&&(rt.updateXScale(),rt.redraw()),rt):s.xmin},rt.xmax=function(e){return arguments.length?(s.xmax=e,s.xrange=s.xmax-s.xmin,rt.updateXScale&&(rt.updateXScale(),rt.redraw()),rt):s.xmax},rt.ymin=function(e){return arguments.length?(s.ymin=e,s.yrange=s.ymax-s.ymin,rt.updateYScale&&(rt.updateYScale(),rt.redraw()),rt):s.ymin},rt.ymax=function(e){return arguments.length?(s.ymax=e,s.yrange=s.ymax-s.ymin,rt.updateYScale&&(rt.updateYScale(),rt.redraw()),rt):s.ymax},rt.xLabel=function(e){return arguments.length?(s.xlabel=e,st(),rt):s.xlabel},rt.yLabel=function(e){return arguments.length?(s.ylabel=e,ot(),rt):s.ylabel},rt.title=function(e){return arguments.length?(s.title=e,it(),rt):s.title},rt.width=function(e){return arguments.length?(E.width=e,rt):E.width},rt.height=function(e){return arguments.length?(E.height=e,rt):E.height},rt.x=function(e){return arguments.length?(T=e,rt):T},rt.y=function(e){return arguments.length?(N=e,rt):N},rt.elem=function(e){return arguments.length?(i=d3.select(e),i.call(rt),rt):i},rt.data=function(e){if(!arguments.length)return g;var t=S.domain(),n=t[1]-t[0],r=n*.8;return s.points=g=e,g.length>t[1]?(t[0]+=r,t[1]+=r,S.domain(t),rt.redraw()):rt.update(),rt},rt.add_data=function(e){if(!arguments.length)return g;var t=S.domain(),n=t[1]-t[0],r=n*.8,i;if(e instanceof Array&&e.length>0)if(e[0]instanceof Array)for(i=0;i<e.length;i++)g.push(e[i]);else{if(e.length!==2)throw new Error("invalid argument to graph.add_data() "+e+" length should === 2.");g.push(e)}return rt.updateOrRescale(),rt},rt.selection_domain=function(e){return arguments.length?(e===null?$=!1:e.length===0?($=!0,V.xmin=Infinity,V.xmax=Infinity):($=!0,V.xmin=e[0],V.xmax=e[1]),at(),Q&&Q(rt.selection_domain()),rt):$?V.xmax===Infinity&&V.xmin===Infinity?[]:[V.xmin,V.xmax]:null},rt.has_selection=function(){return $},rt.selection_visible=function(e){return arguments.length?(e=!!e,J!==e&&(J=e,at()),rt):J},rt.selection_enabled=function(e){return arguments.length?(e=!!e,K!==e&&(K=e,at()),rt):K},rt.selection_listener=function(e){return arguments.length?(Q=e,rt):Q},rt.brush_element=function(){return G},rt.brush_control=function(){return Y},rt.brush_listener=function(){return ut},rt.reset=function(e,t){return arguments.length?rt.initialize(e,t):rt.initialize(),rt(),rt},rt.resize=function(e,t){return rt.scale(e,t),rt.initialize(),rt(),rt},i&&i.call(rt),rt}}),n("grapher/core/real-time-graph",["require","grapher/core/axis"],function(e){var t=e("grapher/core/axis");return function(n,r,s){function nt(e){if(e)for(var t in tt)e[t]===undefined&&(e[t]=tt[t]);else e=tt;return e.axisShift<1&&(e.axisShift=1),e}function rt(){a<=q.icon?(q.category="icon",q.value=0):a<=q.tiny?(q.category="tiny",q.value=1):a<=q.small?(q.category="small",q.value=2):a<=q.medium?(q.category="medium",q.value=3):a<=q.large?(q.category="large",q.value=4):(q.category="extralarge",q.value=5)}function it(e,t){arguments.length?(a=e,u.style.width=a+"px",t?(f=t,u.style.height=f+"px"):(u.style.height="100%",t=o.property("clientHeight"),f=t,u.style.height=f+"px")):(a=o.property("clientWidth"),f=o.property("clientHeight")),rt(),j=parseFloat($("#viz").css("font-size")||$("body").css("font-size"))/10}function st(e,t,n){e&&(o=d3.select(e),u=o.node(),a=o.property("clientWidth"),f=o.property("clientHeight"));if(t||!r)r=nt(t),newOptions=undefined;v!==undefined&&(v.remove(),v=undefined),Y!==undefined&&($(Y).remove(),Y=undefined),G=r.sample,r.dataChange?H="ns-resize":H="crosshair",it(),r.xrange=r.xmax-r.xmin,r.yrange=r.ymax-r.ymin,J=[];switch(q.value){case 0:k={top:4,right:4,bottom:4,left:4};break;case 1:k={top:8,right:8,bottom:8,left:8};break;case 2:k={top:r.title?25:15,right:15,bottom:20,left:30};break;case 3:k={top:r.title?30:20,right:30,bottom:r.xlabel?60:10,left:r.ylabel?70:45};break;default:k={top:r.title?40:20,right:30,bottom:r.xlabel?60:10,left:r.ylabel?70:45}}if(Object.prototype.toString.call(r.dataset[0])==="[object Array]"){for(var i=0;i<r.dataset.length;i++)J.push(ot(r.dataset[i],0,G));V=J[0]}else V=ot(r.dataset,0),J=[V];Object.prototype.toString.call(r.title)==="[object Array]"?X=r.title:X=[r.title],X.reverse(),q.value>2?k.top+=(X.length-1)*q.value/3*q.value/3*j*22:X=[X[0]],L={width:a-k.left-k.right,height:f-k.top-k.bottom},A=d3.scale[r.xscale]().domain([r.xmin,r.xmax]).range([0,L.width]),r.xscale==="pow"&&A.exponent(r.xscaleExponent),O=d3.scale[r.yscale]().domain([r.ymin,r.ymax]).nice().range([L.height,0]).nice(),r.yscale==="pow"&&O.exponent(r.yscaleExponent),p=d3.format(r.xFormatter),d=d3.format(r.yFormatter),M=d3.svg.line().x(function(e,t){return A(V[t].x)}).y(function(e,t){return O(V[t].y)}),R=Math.NaN,U=Math.NaN,z=null}function ot(e,t,n){var r=0,i=t||0,s=e.length,o=[];n=n||1;for(r=0;r<s;r++)o.push({x:(r+i)*n,y:e[r]});return o}function ut(){return V?V.length:!1}function at(){function e(e){s=e,e?C.text(e):C.text("")}function n(){var e=m.selectAll("g.x").data(A.ticks(r.xTicCount),String).attr("transform",c),t=e.enter().insert("g","a").attr("class","x").attr("transform",c);t.append("line").attr("stroke",l).attr("y1",0).attr("y2",L.height),q.value>1&&t.append("text").attr("class","axis").style("font-size",q.value/2.7*100+"%").attr("y",L.height).attr("dy","1em").attr("text-anchor","middle").style("cursor","ew-resize").text(p).on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",N).on("touchstart.drag",N),e.exit().remove();var s=m.selectAll("g.y").data(O.ticks(r.yTicCount),String).attr("transform",h),o=s.enter().insert("g","a").attr("class","y").attr("transform",h).attr("background-fill","#FFEEB6");o.append("line").attr("stroke",l).attr("x1",0).attr("x2",L.width),q.value>1&&o.append("text").attr("class","axis").style("font-size",q.value/2.7*100+"%").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(d).on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",H).on("touchstart.drag",H),s.exit().remove(),g.call(d3.behavior.zoom().x(A).y(O).on("zoom",n)),i()}function i(e){wt(e);if(at.selectable_points){var t=m.selectAll("circle").data(V,function(e){return e});t.enter().append("circle").attr("class",function(e){return e===W?"selected":null}).attr("cx",function(e){return x(e.x)}).attr("cy",function(e){return y(e.y)}).attr("r",1).on("mousedown",function(e){W=z=e,i()}),t.attr("class",function(e){return e===W?"selected":null}).attr("cx",function(e){return x(e.x)}).attr("cy",function(e){return y(e.y)}),t.exit().remove()}d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function T(){d3.event.preventDefault(),g.style("cursor","move");if(d3.event.altKey){var e=d3.svg.mouse(m[0][0]);R=A.invert(e[0]),U=O.invert(e[1]),z=!1,d3.event.stopPropagation()}}function N(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.svg.mouse(m[0][0]);R=A.invert(t[0])}function H(e){document.onselectstart=function(){return!1},d3.event.preventDefault();var t=d3.svg.mouse(m[0][0]);U=O.invert(t[1])}function B(){var e=d3.svg.mouse(m[0][0]),r,i,s,o=d3.event.changedTouches;document.onselectstart=function(){return!0},d3.event.preventDefault(),isNaN(R)||(d3.select("body").style("cursor","ew-resize"),A.domain(t.axisProcessDrag(R,A.invert(e[0]),A.domain())),n(),d3.event.stopPropagation()),isNaN(U)||(d3.select("body").style("cursor","ns-resize"),O.domain(t.axisProcessDrag(U,O.invert(e[1]),O.domain())),n(),d3.event.stopPropagation())}function F(){d3.select("body").style("cursor","auto"),document.onselectstart=function(){return!0},isNaN(R)||(n(),R=Math.NaN),isNaN(U)||(n(),U=Math.NaN),z=null}function I(e){K={x:V[e].x,y:V[e].y}}function $(e){var t,s=A.domain(),o=Math.round(s[0]/G),u=Math.round(s[1]/G),a=Math.max(0,o),f=s[1]-s[0],l=f*.9,c;typeof e!="number"&&(e=V.length),c=e*G,_?(_=P(),_?n():i(e)):c>s[0]+l?(P=tt(l*.9,r.axisShift),_=P(),n()):c<s[1]-l&&e<V.length&&o>0?(P=tt(l*.9,r.axisShift,-1),_=P(),n()):c<s[0]?(P=tt(l*.1,1,-1),_=P(),n()):i(e)}function tt(e,t,n){var r=A.domain()[0],i=A.domain()[1],s=1/t,o=0;return function(){var t;return n=n||1,o+=s,t=e*D(o),n>0?(A.domain([r+t,i+t]),A.domain()[0]<r+e):(A.domain([r-t,i-t]),A.domain()[0]>r-e)}}function nt(e){if(V.length===0)return;K=!1;var t=V.length,n=t*G,r={x:n,y:e},i,s;V.push(r)}function rt(e){if(V.length===0)return;nt(e),$()}function ft(e){if(V.length===0)return;K=!1;var t=V.length,n=t*G,r=n-G,i={x:n,y:e},s=A.call(self,r,r),o=O.call(self,V[t-1].y,t-1),u,a;V.push(i),u=A.call(self,n,n),a=O.call(self,e,n),Z.beginPath(),Z.moveTo(s,o),Z.lineTo(u,a),Z.stroke()}function lt(e){for(var t=0;t<J.length;t++)V=J[t],nt(e[t]);$()}function ct(e){for(var t=0;t<J.length;t++)V=J[t],ht(t),ft(e[t])}function ht(e,t){var n=t?.4:1;switch(e){case 0:Z.strokeStyle="rgba(160,00,0,"+n+")";break;case 1:Z.strokeStyle="rgba(44,160,0,"+n+")";break;case 2:Z.strokeStyle="rgba(44,0,160,"+n+")"}}function pt(e,t){var n=t?.4:1;switch(e){case 0:Z.fillStyle="rgba(160,00,0,"+n+")";break;case 1:Z.fillStyle="rgba(44,160,0,"+n+")";break;case 2:Z.fillStyle="rgba(44,0,160,"+n+")"}}function dt(e){var t;J=[];if(Object.prototype.toString.call(e)==="[object Array]")for(t=0;t<e.length;t++)V=ot(e[t],0,G),J.push(V);else V=ot(r.dataset,0,G),J=[V];$()}function vt(e){x=d3.scale[r.xscale]().domain([0,e]).range([0,L.width]),at.xmax=e,x_tics_scale=d3.scale[r.xscale]().domain([at.xmin*at.sample,at.xmax*at.sample]).range([0,L.width]),i(),n()}function mt(e){y=d3.scale[r.yscale]().domain([e,0]).range([0,L.height]),at.ymax=e,i(),n()}function gt(){Y.width=Y.width,Z.fillStyle="rgba(0,255,0, 0.05)",Z.fillRect(0,0,Y.width,Y.height),Z.strokeStyle="rgba(255,65,0, 1.0)"}function yt(){m.select("path.line").remove(),Y.style.zIndex=100}function bt(){Y.style.zIndex=-100,i()}function wt(e){var t,n,i,s,o,u=O(1e-5),a=r.lines,f=r.bars,l=2*Math.PI,c=J[0].length,h=J.length,p=Math.round(A.domain()[0]/G),d=Math.round(A.domain()[1]/G),v=Math.max(0,p);typeof e=="undefined"?s=c:e===c-1?s=c-1:s=e,gt(),Z.fillRect(0,0,Y.width,Y.height);if(V.length===0||p>=V.length)return;if(a)for(t=0;t<h;t++){V=J[t],lengthX=v*G,px=A(lengthX),i=O(V[v].y),ht(t),Z.beginPath(),Z.moveTo(px,i),o=s-1;for(n=v+1;n<o;n++)lengthX=n*G,px=A(lengthX),i=O(V[n].y),Z.lineTo(px,i);Z.stroke(),o=V.length-1;if(n<o){ht(t,!0);for(;n<o;n++)lengthX=n*G,px=A(lengthX),i=O(V[n].y),Z.lineTo(px,i);Z.stroke()}}else if(f)for(t=0;t<h;t++){V=J[t],ht(t),o=s-1;for(n=v;n<o;n++){lengthX=n*G,px=A(lengthX),i=O(V[n].y);if(i===0)continue;Z.beginPath(),Z.moveTo(px,u),Z.lineTo(px,i),Z.stroke()}o=V.length-1;if(n<o){ht(t,!0);for(;n<o;n++)lengthX=n*G,px=A(lengthX),i=O(V[n].y),Z.beginPath(),Z.moveTo(px,u),Z.lineTo(px,i),Z.stroke()}}else for(t=0;t<h;t++){V=J[t],lengthX=0,pt(t),ht(t,!0),o=s-1;for(n=0;n<o;n++)px=A(lengthX),i=O(V[n].y),Z.arc(px,i,1,0,l,!1),Z.fill(),lengthX+=G;o=V.length-1;if(n<o){pt(t,!0),ht(t,!0);for(;n<o;n++)px=A(lengthX),i=O(V[n].y),Z.arc(px,i,1,0,l,!1),Z.fill(),lengthX+=G}}}function Et(){Y||(Y=Y||document.createElement("canvas"),u.appendChild(Y)),Y.style.zIndex=-100,xt(Y)}function St(){xt(Y),wt()}function xt(e){et.rect=g.node(),et.width=et.rect.width.baseVal.value,et.height=et.rect.height.baseVal.value,et.left=et.rect.getCTM().e,et.top=et.rect.getCTM().f,e.style.position="absolute",e.width=et.width,e.height=et.height,e.style.width=et.width+"px",e.style.height=et.height+"px",e.offsetLeft=et.left,e.offsetTop=et.top,e.style.left=et.left+"px",e.style.top=et.top+"px",e.style.border="solid 1px red",e.style.pointerEvents="none",e.className+="canvas-overlay",Z=Y.getContext("2d"),Z.globalCompositeOperation="source-over",Z.lineWidth=1,Z.fillStyle="rgba(0,255,0, 0.05)",Z.fillRect(0,0,e.width,Y.height),Z.strokeStyle="rgba(255,65,0, 1.0)",Y.style.border="solid 1px red"}it(),v===undefined?(v=o.append("svg").attr("width",a).attr("height",f),m=v.append("g").attr("transform","translate("+k.left+","+k.top+")"),g=m.append("rect").attr("class","plot").attr("width",L.width).attr("height",L.height).style("fill","#EEEEEE").attr("pointer-events","all").on("mousedown",T).on("touchstart",T),g.call(d3.behavior.zoom().x(A).y(O).on("zoom",n)),b=m.append("svg").attr("class","viewbox").attr("top",0).attr("left",0).attr("width",L.width).attr("height",L.height).attr("viewBox","0 0 "+L.width+" "+L.height).append("path").attr("class","line").attr("d",M(V))
,Q=b.append("path").attr("class","marker"),r.title&&q.value>1&&(w=m.selectAll("text").data(X,function(e){return e}),w.enter().append("text").attr("class","title").style("font-size",q.value/3.2*100+"%").text(function(e){return e}).attr("x",L.width/2).attr("dy",function(e,t){return-0.5+ -1*q.value/2.8*t*j+"em"}).style("text-anchor","middle")),r.xlabel&&q.value>2&&(E=m.append("text").attr("class","axis").style("font-size",q.value/2.6*100+"%").attr("class","xlabel").text(r.xlabel).attr("x",L.width/2).attr("y",L.height).attr("dy","2.4em").style("text-anchor","middle")),r.ylabel&&q.value>2&&(S=m.append("g").append("text").attr("class","axis").style("font-size",q.value/2.6*100+"%").attr("class","ylabel").text(r.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+L.height/2+") rotate(-90)")),C=m.append("text").attr("class","graph-notification").text(s).attr("x",L.width/2).attr("y",L.height/2).style("text-anchor","middle"),d3.select(u).on("mousemove.drag",B).on("touchmove.drag",B).on("mouseup.drag",F).on("touchend.drag",F),Et(),yt()):(m.attr("width",a).attr("height",f),g.attr("width",L.width).attr("height",L.height).style("fill","#EEEEEE"),b.attr("top",0).attr("left",0).attr("width",L.width).attr("height",L.height).attr("viewBox","0 0 "+L.width+" "+L.height),r.title&&q.value>1&&w.each(function(e,t){d3.select(this).attr("x",L.width/2),d3.select(this).attr("dy",function(e,t){return 1.4*t-X.length+"em"})}),r.xlabel&&q.value>1&&E.attr("x",L.width/2).attr("y",L.height),r.ylabel&&q.value>1&&S.attr("transform","translate(-40 "+L.height/2+") rotate(-90)"),C.attr("x",L.width/2).attr("y",L.height/2),m.selectAll("g.x").remove(),m.selectAll("g.y").remove(),St()),n(),at.node=u,at.scale=it,at.update=i,at.updateOrRescale=$,at.redraw=n,at.initialize=st,at.notify=e,at.number_of_points=ut,at.new_data=dt,at.add_point=rt,at.add_points=lt,at.add_canvas_point=ft,at.add_canvas_points=ct,at.initialize_canvas=Et,at.show_canvas=yt,at.hide_canvas=bt,at.clear_canvas=gt,at.update_canvas=wt,at.showMarker=I,at.change_xaxis=vt,at.change_yaxis=mt}var o,u,a,f,l=function(e){return e?"#ccc":"#666"},c=function(e){return"translate("+A(e)+",0)"},h=function(e){return"translate(0,"+O(e)+")"},p,d,v,m,g,b,w,E,S,T,N,C,k,L,A,O,M,_=!1,D=d3.ease("cubic"),P,H,B,j,F,I,q={category:"medium",value:3,icon:120,tiny:240,small:480,medium:960,large:1920},R=Math.NaN,U=Math.NaN,z=null,W=null,X=[],V,J,K,Q,G,Y,Z,et={},tt={title:"graph",xlabel:"x-axis",ylabel:"y-axis",xscale:"linear",yscale:"linear",xTicCount:10,yTicCount:10,xscaleExponent:.5,yscaleExponent:.5,xFormatter:"3.2r",yFormatter:"3.2r",axisShift:10,xmax:10,xmin:0,ymax:10,ymin:0,dataset:[0],selectable_points:!0,circleRadius:!1,dataChange:!1,points:!1,sample:1,lines:!0,bars:!1};return st(n,r,s),at.add_data=function(e){if(!arguments.length)return V;var t=A.domain(),n=t[1]-t[0],r=n*.8,s;i;if(e instanceof Array&&e.length>0)if(e[0]instanceof Array)for(i=0;i<e.length;i++)V.push(e[i]);else{if(e.length!==2)throw new Error("invalid argument to graph.add_data() "+e+" length should === 2.");V.push(e)}return updateOrRescale(),at},at.reset=function(e,t,n){return arguments.length?at.initialize(e,t,n):at.initialize(),at(),at},at.resize=function(e,t){return at.scale(e,t),at.initialize(),at(),at},u&&at(),at}}),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=r.unshift,l=i.toString,c=i.hasOwnProperty,h=r.forEach,p=r.map,d=r.reduce,v=r.reduceRight,m=r.filter,g=r.every,y=r.some,b=r.indexOf,w=r.lastIndexOf,E=Array.isArray,S=Object.keys,x=s.bind,T=function(e){if(e instanceof T)return e;if(!(this instanceof T))return new T(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.4.2";var N=T.each=T.forEach=function(e,t,r){if(e==null)return;if(h&&e.forEach===h)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(T.has(e,o)&&t.call(r,e[o],o,e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return e==null?r:p&&e.map===p?e.map(t,n):(N(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduce===d)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);N(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(v&&e.reduceRight===v)return r&&(t=T.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=T.keys(e);s=o.length}N(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.find=T.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},T.filter=T.select=function(e,t,n){var r=[];return e==null?r:m&&e.filter===m?e.filter(t,n):(N(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},T.reject=function(e,t,n){return T.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return e==null?i:g&&e.every===g?e.every(t,r):(N(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return e==null?i:y&&e.some===y?e.some(t,r):(N(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};T.contains=T.include=function(e,t){return e==null?!1:b&&e.indexOf===b?e.indexOf(t)!=-1:C(e,function(e){return e===t})},T.invoke=function(e,t){var n=u.call(arguments,2);return T.map(e,function(e){return(T.isFunction(t)?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t){return T.isEmpty(t)?[]:T.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-Infinity;var r={computed:-Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return Infinity;var r={computed:Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return N(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t);return N(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};T.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)})},T.countBy=function(e,t,n){return L(e,t,n,function(e,t,n){T.has(e,t)||(e[t]=0),e[t]++})},T.sortedIndex=function(e,t,n,r){n=n==null?T.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},T.toArray=function(e){return e?e.length===+e.length?u.call(e):T.values(e):[]},T.size=function(e){return e==null?0:e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,0,t):e[0]},T.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},T.last=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},T.rest=T.tail=T.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},T.compact=function(e){return T.filter(e,function(e){return!!e})};var A=function(e,t,n){return N(e,function(e){T.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};T.flatten=function(e,t){return A(e,t,[])},T.without=function(e){return T.difference(e,u.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){T.isFunction(t)&&(r=n,n=t,t=!1);var i=n?T.map(e,n,r):e,s=[],o=[];return N(i,function(n,r){if(t?!r||o[o.length-1]!==n:!T.contains(o,n))o.push(n),s.push(e[r])}),s},T.union=function(){return T.uniq(a.apply(r,arguments))},T.intersection=function(e){var t=u.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=a.apply(r,u.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){var e=u.call(arguments),t=T.max(T.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=T.pluck(e,""+r);return n},T.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=T.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};T.bind=function(t,n){var r,i;if(t.bind===x&&x)return x.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=t.prototype;var e=new O,s=t.apply(e,i.concat(u.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(u.call(arguments)))}},T.bindAll=function(e){var t=u.call(arguments,1);return t.length==0&&(t=T.functions(e)),N(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(u.call(arguments,1)))},T.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,f<=0?(clearTimeout(i),o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},T.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},T.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},T.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},T.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&(t[t.length]=n);return t},T.values=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push(e[n]);return t},T.pairs=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push([n,e[n]]);return t},T.invert=function(e){var t={};for(var n in e)T.has(e,n)&&(t[e[n]]=n);return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return N(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=M(e[o],t[o],n,r)))break}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(f)&&f instanceof f))return!1;for(var c in e)if(T.has(e,c)){o++;if(!(u=T.has(t,c)&&M(e[c],t[c],n,r)))break}if(u){for(c in t)if(T.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};T.isEqual=function(e,t){return M(e,t,[],[])},T.isEmpty=function(e){if(e==null)return!0;if(T.isArray(e)||T.isString(e))return e.length===0;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!!e&&e.nodeType===1},T.isArray=E||function(e){return l.call(e)=="[object Array]"},T.isObject=function(e){return e===Object(e)},N(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!!e&&!!T.has(e,"callee")}),typeof /./!="function"&&(T.isFunction=function(e){return typeof e=="function"}),T.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return e===!0||e===!1||l.call(e)=="[object Boolean]"},T.isNull=function(e){return e===null},T.isUndefined=function(e){return e===void 0},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},T.random=function(e,t){return t==null&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=T.invert(_.escape);var D={escape:new RegExp("["+T.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(_.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),T.result=function(e,t){if(e==null)return null;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){N(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(T,e))}})};var P=0;T.uniqueId=function(e){var t=P++;return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":o?"';\n"+o+"\n__p+='":"",i=u+t.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,T);var a=function(e){return o.call(this,e,T)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},T.chain=function(e){return T(e).chain()};var F=function(e){return this._chain?T(e).chain():e};T.mixin(T),N(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),N(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),n("underscore",function(e){return function(){return e._}}(this)),function(){var e=this,n=e.Backbone,r=Array.prototype,i=r.push,s=r.slice,o=r.splice,u;typeof exports!="undefined"?u=exports:u=e.Backbone={},u.VERSION="0.9.2";var a=e._;!a&&typeof t!="undefined"&&(a=t("underscore")),u.$=e.jQuery||e.Zepto||e.ender,u.noConflict=function(){return e.Backbone=n,this},u.emulateHTTP=!1,u.emulateJSON=!1;var f=/\s+/,l=u.Events={on:function(e,t,n){var r,i,s;if(!t)return this;e=e.split(f),r=this._callbacks||(this._callbacks={});while(i=e.shift())s=r[i]||(r[i]=[]),s.push(t,n);return this},off:function(e,t,n){var r,i,s,o;if(!(i=this._callbacks))return this;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(f):a.keys(i);while(r=e.shift()){if(!(s=i[r])||!t&&!n){delete i[r];continue}for(o=s.length-2;o>=0;o-=2)t&&s[o]!==t||n&&s[o+1]!==n||s.splice(o,2)}return this},trigger:function(e){var t,n,r,i,s,o,u,a;if(!(n=this._callbacks))return this;a=[],e=e.split(f);for(i=1,s=arguments.length;i<s;i++)a[i-1]=arguments[i];while(t=e.shift()){if(u=n.all)u=u.slice();if(r=n[t])r=r.slice();if(r)for(i=0,s=r.length;i<s;i+=2)r[i].apply(r[i+1]||this,a);if(u){o=[t].concat(a);for(i=0,s=u.length;i<s;i+=2)u[i].apply(u[i+1]||this,o)}}return this}};l.bind=l.on,l.unbind=l.off;var c=u.Model=function(e,t){var n,r=e||{};t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=a.uniqueId("c"),this.changed={},this._changes={},this._pending={},t&&t.parse&&(r=this.parse(r));if(n=a.result(this,"defaults"))r=a.extend({},n,r);this.set(r,{silent:!0}),this.changed={},this._changes={},this._pending={},this._previousAttributes=a.clone(this.attributes),this.initialize.apply(this,arguments)};a.extend(c.prototype,l,{changed:null,_changes:null,_pending:null,_changing:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return a.clone(this.attributes)},sync:function(){return u.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=a.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i;if(e==null)return this;a.isObject(e)?(i=e,n=t):(i={})[e]=t;var s=n&&n.silent,o=n&&n.unset;i instanceof c&&(i=i.attributes);if(o)for(r in i)i[r]=void 0;if(!this._validate(i,n))return!1;this.idAttribute in i&&(this.id=i[this.idAttribute]);var u=this._changing,f=this.attributes,l=this._escapedAttributes,h=this._previousAttributes||{};for(r in i){t=i[r];if(!a.isEqual(f[r],t)||o&&a.has(f,r))delete l[r],this._changes[r]=!0;o?delete f[r]:f[r]=t,!a.isEqual(h[r],t)||a.has(f,r)!==a.has(h,r)?(this.changed[r]=t,s||(this._pending[r]=!0)):(delete this.changed[r],delete this._pending[r],u||delete this._changes[r]),u&&a.isEqual(f[r],u[r])&&delete this._changes[r]}return s||this.change(n),this},unset:function(e,t){return t=a.extend({},t,{unset:!0}),this.set(e,null,t)},clear:function(e){return e=a.extend({},e,{unset:!0}),this.set(a.clone(this.attributes),e)},fetch:function(e){e=e?a.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r,e)},this.sync("read",this,e)},save:function(e,t,n){var r,i,s;e==null||a.isObject(e)?(r=e,n=t):e!=null&&((r={})[e]=t),n=n?a.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;i=a.clone(this.attributes)}var o=a.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?o:n))return!1;if(!r&&!this._validate(null,n))return!1;var u=this,f=n.success;n.success=function(e,t,i){s=!0;var o=u.parse(e,i);n.wait&&(o=a.extend(r||{},o));if(!u.set(o,n))return!1;f&&f(u,e,n)};var l=this.sync(this.isNew()?"create":"update",this,n);return!s&&n.wait&&(this.clear(o),this.set(i,o)),l},destroy:function(e){e=e?a.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e)};if(this.isNew())return e.success(),!1;var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=a.result(this,"urlRoot")||a.result(this.collection,"url")||O();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){var t=this._changing,n=this._changing={};for(var r in this._changes)this._pending[r]=!0;var i=this._changes;this._changes={};var s=[];for(var r in i)n[r]=this.get(r),s.push(r);for(var o=0,u=s.length;o<u;o++)this.trigger("change:"+s[o],this,n[s[o]],e);if(t)return this;while(!a.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var r in this.changed){if(this._pending[r]||this._changes[r])continue;delete this.changed[r]}this._previousAttributes=a.clone(this.attributes)}return this._changing=null,this},hasChanged:function(e){return e==null?!a.isEmpty(this.changed):a.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?a.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(a.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return a.clone(this._previousAttributes)},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(t&&t.silent||!this.validate)return!0;e=a.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error&&t.error(this,n,t),this.trigger("error",this,n,t),!1):!0}});var h=u.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&(t.parse&&(e=this.parse(e)),this.reset(e,{silent:!0,parse:t.parse}))};a.extend(h.prototype,l,{model:c,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return u.sync.apply(this,arguments)},add:function(e,t){var n,r,s,u,f,l=t&&t.at;e=a.isArray(e)?e.slice():[e];for(n=0,s=e.length;n<s;n++){if(e[n]=this._prepareModel(e[n],t))continue;throw new Error("Can't add an invalid model to a collection")}for(n=e.length-1;n>=0;n--){u=e[n],f=u.id!=null&&this._byId[u.id];if(f||this._byCid[u.cid]){t&&t.merge&&f&&f.set(u,t),e.splice(n,1);continue}u.on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u)}this.length+=e.length,r=[l!=null?l:this.models.length,0],i.apply(r,e),o.apply(this.models,r),this.comparator&&l==null&&this.sort({silent:!0});if(t&&t.silent)return this;while(u=e.shift())u.trigger("add",u,this,t);return this},remove:function(e,t){var n,r,i,s;t||(t={}),e=a.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){s=this.getByCid(e[n])||this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byCid[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return a.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(a.bind(this.comparator,this)),(!e||!e.silent)&&this.trigger("reset",this,e),this},pluck:function(e){return a.invoke(this.models,"get",e)},reset:function(e,t){for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),e&&this.add(e,a.extend({silent:!0},t)),(!t||!t.silent)&&this.trigger("reset",this,t),this},fetch:function(e){e=e?a.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r,e)},this.sync("read",this,e)},create:function(e,t){var n=this;t=t?a.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(e,t,i){i.wait&&n.add(e,i),r&&r(e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},chain:function(){return a(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){if(e instanceof c)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(n.attributes,t)?n:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var p=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortedIndex","toArray","size","first","head","take","initial","rest","tail","last","without","indexOf","shuffle","lastIndexOf","isEmpty"];a.each(p,function(e){h.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),a[e].apply(a,t)}});var d=["groupBy","countBy","sortBy"];a.each(d,function(e){h.prototype[e]=function(t,n){var r=a.isFunction(t)?t:function(e){return e.get(t)};return a[e](this.models,r,n)}});var v=u.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},m=/\((.*?)\)/g,g=/:\w+/g,y=/\*\w+/g,b=/[-{}[\]+?.,\\^$|#\s]/g;a.extend(v.prototype,l,{initialize:function(){},route:function(e,t,n){return a.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),u.history.route(e,a.bind(function(r){var i=this._extractParameters(e,r);n&&n.apply(this,i),this.trigger.apply(this,["route:"+t].concat(i)),u.history.trigger("route",this,t,i)},this)),this},navigate:function(e,t){return u.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;var e,t=a.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(b,"\\$&").replace(m,"(?:$1)?").replace(g,"([^/]+)").replace(y,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var w=u.History=function(){this.handlers=[],a.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/,S=/^\/+|\/+$/g,x=/msie [\w.]+/,T=/\/$/;w.started=!1,a.extend(w.prototype,l,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(T,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return decodeURIComponent(e.replace(E,""))},start:function(e){if(w.started)throw new Error("Backbone.history has already been started");w.started=!0,this.options=a.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=x.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(S,"/"),r&&this._wantsHashChange&&(this.iframe=u.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?u.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?u.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(E,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){u.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),w.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=a.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!w.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),u.history=new w;var N=u.View=function(e){this.cid=a.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},C=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName"];a.extend(N.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},dispose:function(){return this.undelegateEvents(),this.model&&this.model.off&&this.model.off(null,null,this),this.collection&&this.collection.off&&this.collection.off(null,null,this),this},remove:function(){return this.dispose(),this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&u.$(r).attr(t),n!=null&&u.$(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof u.$?e:u.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=a.result(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];a.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(C),i=r[1],s=r[2];n=a.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.bind(i,n):this.$el.delegate(s,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=a.extend({},this.options,e)),a.extend(this,a.pick(e,k)),this.options=e},_ensureElement:function(){if(!this.el){var e=a.extend({},a.result(this,"attributes"));this.id&&(e.id=a.result(this,"id")),this.className&&(e["class"]=a.result(this,"className")),this.setElement(this.make(a.result(this,"tagName"),e),!1)}else this.setElement(a.result(this,"el"),!1)}});var L={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};u.sync=function(e,t,n){var r=L[e];a.defaults
(n||(n={}),{emulateHTTP:u.emulateHTTP,emulateJSON:u.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=a.result(t,"url")||O()),!n.data&&t&&(e==="create"||e==="update")&&(i.contentType="application/json",i.data=JSON.stringify(t)),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1);var o=n.success;n.success=function(e,r,i){o&&o(e,r,i),t.trigger("sync",t,e,n)};var f=n.error;return n.error=function(e,r,i){f&&f(t,e,n),t.trigger("error",t,e,n)},u.ajax(a.extend(i,n))},u.ajax=function(){return u.$.ajax.apply(u.$,arguments)};var A=function(e,t){var n=this,r;e&&a.has(e,"constructor")?r=e.constructor:r=function(){n.apply(this,arguments)},a.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&a.extend(r.prototype,e),r.__super__=n.prototype,r};c.extend=h.extend=v.extend=N.extend=w.extend=A;var O=function(){throw new Error('A "url" property or function must be specified')}}.call(this),n("backbone",["underscore"],function(e){return function(){return e.Backbone}}(this)),n("grapher/bar-graph/bar-graph-model",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({defaults:{value:0,minValue:0,maxValue:10,width:150,height:500,title:"",barColor:"green",fillColor:"white",textColor:"#555",ticks:10,tickSubdivide:1,displayLabels:!0,labelFormat:"0.1f"}});return n}),n("grapher/bar-graph/bar-graph-view",["require","backbone"],function(e){var t=e("backbone"),n={padding:{left:10,top:10,right:10,bottom:10}},r=function(e){return e.node().getBBox().width},i=function(e){return e.node().getBBox().height},s=500,o=function(e){var t=e/s;return t<.6&&(t=.6),function(e){return e*t}},u=function(e,t){var n=[],r={},i,s;for(i=0,s=t.length;i<s;i++)n[i]=t[i].value,r[n[i]]=t[i].label;e.tickValues(n).tickFormat(function(e){return r[e]})},a=t.View.extend({tagName:"div",className:"bar-graph",initialize:function(){this.vis=d3.select(this.el).append("svg"),this.fill=this.vis.append("rect"),this.bar=this.vis.append("rect"),this.title=this.vis.append("text"),this.axisContainer=this.vis.append("g"),this.yScale=d3.scale.linear(),this.heightScale=d3.scale.linear(),this.yAxis=d3.svg.axis(),this.model.on("change",this.modelChanged,this)},render:function(){var e=this.model.toJSON(),t=o(e.height),s=t(n.padding.left),a=t(n.padding.top),f=t(n.padding.bottom),l=t(n.padding.right);this.vis.attr({width:e.width,height:e.height}).style({"font-size":t(15)+"px"}),this.yScale.domain([e.minValue,e.maxValue]).range([e.height-a,f]),this.heightScale.domain([e.minValue,e.maxValue]).range([0,e.height-a-f]),e.title!==undefined&&(this.title.text(e.title).style({"font-size":"140%","text-anchor":"middle",fill:e.textColor}),l+=i(this.title),this.title.attr("transform","translate("+(e.width-l)+", "+e.height/2+") rotate(90)")),this.yAxis.scale(this.yScale).tickSubdivide(e.tickSubdivide).tickSize(t(10),t(5),t(10)).orient("right"),typeof e.ticks=="number"?this.yAxis.ticks(e.ticks).tickFormat(d3.format(e.labelFormat)):u(this.yAxis,e.ticks),this.axisContainer.call(this.yAxis),this.axisContainer.style({stroke:e.textColor,"stroke-width":t(2),fill:"none"}),this.axisContainer.selectAll("text").style({fill:e.textColor,"stroke-width":0,"font-size":e.displayLabels?"100%":0}),e.ticks===0&&this.axisContainer.selectAll("*").remove(),l+=r(this.axisContainer)+t(7),this.axisContainer.attr("transform","translate("+(e.width-l)+", 0)"),l+=t(5),this.fill.attr({width:e.width-s-l,height:this.heightScale(e.maxValue),x:s,y:this.yScale(e.maxValue)}).style({fill:e.fillColor}),this.bar.attr({width:e.width-s-l,x:s}).style({fill:e.barColor}),this.updateBar()},updateBar:function(){var e=this.model.get("value");this.bar.attr("height",this.heightScale(e)).attr("y",this.yScale(e))},getParentHeight:function(){return this.$el.parent().height()},getParentWidth:function(){return this.$el.parent().width()},modelChanged:function(){var e=this.model.changedAttributes(),t=0,n;for(n in e)if(e.hasOwnProperty(n)){t++;if(t>1){this.render();return}}e.value!==undefined?this.updateBar():this.render()}});return a}),n("grapher/public-api",["require","grapher/core/graph","grapher/core/real-time-graph","grapher/bar-graph/bar-graph-model","grapher/bar-graph/bar-graph-view"],function(e){"use strict";var t=e("grapher/core/graph"),n=e("grapher/core/real-time-graph"),r=e("grapher/bar-graph/bar-graph-model"),i=e("grapher/bar-graph/bar-graph-view"),s;return s={version:"0.0.1",graph:t,realTimeGraph:n,BarGraphModel:r,BarGraphView:i},window.Lab=window.Lab||{},window.Lab.grapher=s,s}),t(["grapher/public-api"],undefined,undefined,!0)})();