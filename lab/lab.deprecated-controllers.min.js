(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers.simpleModelController=function(e,t,n){function C(){function N(){r=n.layoutStyle,i=n.autostart,s=n.maximum_model_steps,o=n.lj_epsilon_max,u=n.lj_epsilon_min,a=t.elements,f=t.atoms,l=t.mol_number,c=t.temperature_control,h=t.temperature,p=t.coulomb_forces,d=t.width,v=t.height,m=t.chargeShading,g=t.showVDWLines,y=t.radialBonds,b=t.obstacles}function k(){model=modeler.model({elements:a,model_listener:S,temperature:h,lennard_jones_forces:!0,coulomb_forces:p,temperature_control:c,width:d,height:v,chargeShading:m,showVDWLines:g});if(f)model.createNewAtoms(f);else{if(!l)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms({num:l,relax:!0})}y&&model.createRadialBonds(y),b&&model.createObstacles(b)}function L(){layout.selection=r,model_player=new ModelPlayer(model,i),E=layout.moleculeContainer(e,{xmax:d,ymax:v,chargeShading:m,showVDWLines:g,get_radial_bonds:function(){return model.get_radial_bonds()},get_nodes:function(){return model.get_nodes()},get_num_atoms:function(){return model.get_num_atoms()},get_obstacles:function(){return model.get_obstacles()}}),E.updateMoleculeRadius(),E.setup_drawables(),T=new Thermometer("#thermometer",model.temperature(),200,4e3),model.addPropertiesListener(["temperature"],A),T.resize(),A(),layout.heatCoolButtons("#heat_button","#cool_button",0,3800,model,function(e){T.add_value(e)}),model.addPropertiesListener(["coulomb_forces"],function(){$("#coulomb-forces-checkbox").prop("checked",model.get("coulomb_forces")),E.setup_drawables()}),layout.addView("moleculeContainers",E),layout.addView("thermometers",T),layout.setupScreen()}function A(){T.add_value(model.get("temperature"))}function O(){model.stop()}function M(){model.on("tick",S),(!Number(s)||model.stepCounter()<s)&&model.resume()}function _(){O(),model.stepBack()}function D(){(!Number(s)||model.stepCounter()<s)&&model.stepForward()}function P(){w=model.get_nodes(),model.resetTime(),O(),model.on("tick",S),x=model.stepCounter()}function H(){layout.setupScreen(),T.resize(),A()}function B(e){N(),k(),P(),e?L():F()}function F(){layout.setupScreen(!0)}function I(e,r){t=e,n=r,B(!1)}S=function(e){E.update_drawable_positions(),x>=model.stepCounter()&&O()},$("#coulomb-forces-checkbox").click(function(){model.set({chargeShading:this.checked}),model.set({coulomb_forces:this.checked})}),document.onwebkitfullscreenchange=H,window.onresize=H;if(typeof DEVELOPMENT=="undefined")try{B(!0)}catch(j){throw alert(j),new Error(j)}else B(!0);i&&M(),C.updateLayout=F,C.reload=I}var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return C(),C},controllers.complexModelController=function(e,t,n,r,s,o){function z(){function s(e){var t=model.ke(),n=model.pe(),r=t+n;q.update(),C.update_drawable_positions(),model.isNewStep()?(D[0].push(t),D[1].push(n),D[2].push(r),M.add_points([t,n,r])):M.update(model.stepCounter()),L>=f&&_(),layout.displayStats(),layout.datatable_visible&&layout.render_datatable()}function o(e){var t=model.stepCounter();if(e)for(i=0,len=D.length;i<len;i++)D[i].length=t;else ke=model.ke(),pe=model.pe(),te=ke+pe,D=[[ke],[pe],[te]]}function k(){model=modeler.model({elements:d,model_listener:s,temperature:y,lennard_jones_forces:!0,coulomb_forces:w,temperature_control:b,width:E,height:S,chargeShading:x,showVDWLines:T});if(v)model.createNewAtoms(v),m&&model.createRadialBonds(m),N&&model.createObstacles(N);else{if(!g)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms({num:g,relax:!0})}}function A(){function i(){g=+B.value,K(),R.checked=!1,s()}function s(){M.change_yaxis(j[g]),I.redraw(),q.redraw()}layout.selection=u,model_player=new ModelPlayer(model,a),C=layout.moleculeContainer(e,{title:"Simple Molecules",xlabel:"X position (nm)",ylabel:"Y position (nm)",control_buttons:"play_reset_step",model_time_label:!0,grid_lines:!0,xunits:!0,yunits:!0,atom_mubers:!1,xmin:0,xmax:E,ymin:0,ymax:S,chargeShading:x,showVDWLines:T,get_radial_bonds:function(){return model.get_radial_bonds()},get_nodes:function(){return model.get_nodes()},get_num_atoms:function(){return model.get_num_atoms()},get_obstacles:function(){return model.get_obstacles()}}),model.addPropertiesListener(["sigma"],C.updateMoleculeRadius),o(),M=grapher.realTimeGraph(t,{title:"Energy of the System (KE:red, PE:green, TE:blue)",xlabel:"Model Time (ps)",xmin:0,xmax:100,sample:.1,ylabel:"eV",ymin:-5,ymax:5,dataset:D}),M.new_data(D),model.on("play",function(){var e,t;M.number_of_points()&&model.stepCounter()<M.number_of_points()&&(o(model.stepCounter()),M.new_data(D)),M.show_canvas()}),model.on("stop",function(){}),model.on("seek",function(){modelsteps=model.stepCounter(),modelsteps>0?(o(modelsteps),M.new_data(D)):(o(),M.new_data(D))}),q=layout.speedDistributionChart(r,{title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01}),I=layout.potentialChart(n,model,{title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy",epsilon_max:l,epsilon_min:c,epsilon:d[0].epsilon,sigma_max:h,sigma_min:p,sigma:d[0].sigma}),model.addPropertiesListener(["epsilon"],I.ljUpdate),model.addPropertiesListener(["sigma"],I.ljUpdate),$("#coulomb-forces-checkbox").click(function(){model.set({coulomb_forces:this.checked})}),model.addPropertiesListener(["coulomb_forces"],function(){$("#coulomb-forces-checkbox").prop("checked",model.get("coulomb_forces"))}),$("#lennard-jones-forces-checkbox").click(function(){model.set({lennard_jones_forces:this.checked})}),model.addPropertiesListener(["lennard_jones_forces"],function(){$("#lennard-jones-forces-checkbox").prop("checked",model.get("lennard_jones_forces"))}),$("#show-vdw-lines-checkbox").click(function(){model.set({showVDWLines:this.checked})}),model.addPropertiesListener(["showVDWLines"],function(){$("#show-vdw-lines-checkbox").prop("checked",model.get("showVDWLines"))}),$("#show-charge-shading-checkbox").click(function(){model.set({chargeShading:this.checked})}),model.addPropertiesListener(["chargeShading"],function(){$("#show-charge-shading-checkbox").prop("checked",model.get("chargeShading")),C.setup_drawables()}),layout.addView("moleculeContainers",C),layout.addView("potentialCharts",I),layout.addView("speedDistributionCharts",q),layout.addView("energyCharts",M),P=document.getElementById("model-controls"),P&&(H=P.getElementsByTagName("input"),P.onchange=modelController),B=document.getElementById("select-molecule-number"),R=document.getElementById("radio-randomize-pos-vel"),checkbox_thermalize=document.getElementById("checkbox-thermalize"),j={2:2,5:12.5,10:5,20:10,50:120,100:250,200:1e3,500:5e3},F={2:2,5:2,10:5,20:5,50:10,100:15,200:20,500:40},B.onchange=i,R.onclick=i,B.value=g}function O(){U=model.get_nodes(),model.resetTime(),o(),C.setup_drawables(),C.updateMoleculeRadius(),layout.setupScreen(),L=model.stepCounter(),B.value=model.get_num_atoms(),_(),model.on("tick",s)}function _(){model.stop(),C.playback_component.action("stop"),P&&(H[0].checked=!0)}function W(){model.stop(),model.stepCounter()<f?(model.stepForward(),P&&(H[0].checked=!0)):P&&(H[0].checked=!1)}function X(){model.on("tick",s),model.stepCounter()<f?(M.show_canvas(),model.resume(),P&&(H[0].checked=!0)):P&&(H[0].checked=!1)}function V(){_(),model.stepBack(),M.showMarker(model.stepCounter())}function J(){model.stepCounter()<f?model.stepForward():P&&(H[0].checked=!0)}function K(){var e=!checkbox_thermalize.checked;g=+B.value,model.createNewAtoms(g,e),O(),C.update_drawable_positions(),L=model.stepCounter(),layout.displayStats(),layout.datatable_visible?layout.render_datatable(!0):layout.hide_datatable(),o(),M.new_data(D),P&&(H[0].checked=!0)}function Q(){layout.setupScreen()}function G(){k(),A(),O()}document.onwebkitfullscreenchange=Q,window.onresize=Q;if(typeof DEVELOPMENT=="undefined")try{G()}catch(Y){throw alert(Y),new Error(Y)}else G();a&&X(),z.modelListener=s,z.modelGo=X,z.modelStop=_,z.modelReset=K,z.resetEnergyData=o,z.energyGraph=M,z.moleculeContainer=C,z.energy_data=D}var u=o.layoutStyle,a=o.autostart,f=o.maximum_model_steps,l=o.lj_epsilon_max,c=o.lj_epsilon_min,h=2,p=.1,d=s.elements,v=s.atoms,m=s.radialBonds,g=s.mol_number,y=s.temperature,b=s.temperature_control,w=s.coulomb_forces,E=s.width,S=s.height,x=s.chargeShading,T=s.showVDWLines,m=s.radialBonds,N=s.obstacles,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,B,R,U;return z(),z}})();