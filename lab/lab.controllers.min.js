(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers={version:"0.0.1"},controllers.simpleModelController=function(a){function e(a){g(molecules_lennard_jones.epsilon(a))}function f(a){g(molecules_lennard_jones.sigma(a))}function g(a){var b=a.sigma,c=a.epsilon,e=a.rmin,f;model.set_lj_coefficients(c,b),d.coefficients.sigma=b,d.coefficients.epsilon=c,d.coefficients.rmin=e,d.xmax=b*3,d.xmin=Math.floor(b/2),d.ymax=Math.ceil(c*-1)+0,d.ymin=Math.ceil(c*1)-2,d.variables[1].x=b,d.variables[0].x=e,lennard_jones_potential=[];for(var g=b*.5;g<d.xmax*3;g+=.05)f=molecules_lennard_jones.potential(g),f<100&&lennard_jones_potential.push([g,f])}function h(){model.nodes({num:mol_number,xdomain:10,ydomain:10,temperature:temperature,rmin:4.4,mol_rmin_radius_factor:.38}).initialize({temperature:temperature,lennard_jones_forces:layout.lennard_jones_forces_checkbox.checked,coulomb_forces:layout.coulomb_forces_checkbox.checked,model_listener:b}),atoms=model.get_atoms(),nodes=model.get_nodes()}function j(){h(),model.set_coulomb_forces(layout.coulomb_forces_checkbox.checked),model.set_lennard_jones_forces(layout.lennard_jones_forces_checkbox.checked),model.set_temperature_control(!0),model.relax()}function l(){f(k[mol_number])}function m(){for(i=0;i<this.elements.length;i++)this.elements[i].checked&&(run_mode=this.elements[i].value);switch(run_mode){case"stop":n();break;case"step":o();break;case"go":p();break;case"reset":s()}}function n(){model_stopped=!0,model.stop()}function o(){model_stopped=!0,model.stop(),(!Number(maximum_model_steps)||model.stepCounter()<maximum_model_steps)&&model.stepForward()}function p(){model_stopped=!1,model.on("tick",b),(!Number(maximum_model_steps)||model.stepCounter()<maximum_model_steps)&&model.resume()}function q(){n(),model.stepBack()}function r(){model_stopped=!0,(!Number(maximum_model_steps)||model.stepCounter()<maximum_model_steps)&&model.stepForward()}function s(){j(),model.temperature(temperature),l(),n(),molecule_container.update_molecule_radius(),molecule_container.setup_particles(),layout.setupScreen(layout.selection),step_counter=model.stepCounter()}function t(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model_stopped?p():n(),a.preventDefault();break;case 13:p(),a.preventDefault();break;case 37:q(),a.preventDefault();break;case 39:r(),a.preventDefault()}}layout.selection=a;var b=function(a){molecule_container.update_molecule_positions(),u.add_value(model.temperature()),step_counter>=model.stepCounter()&&n()},c=molecules_lennard_jones.coefficients(),d={coefficients:c,variables:[{coefficient:"epsilon",x:c.rmin,y:c.epsilon},{coefficient:"sigma",x:c.sigma,y:0}]},k={2:7,5:6,10:5.5,20:5,50:4.5,100:4,200:3.5,500:3};document.onwebkitfullscreenchange=layout.setupScreen,window.onresize=layout.setupScreen,document.onkeydown=t,s(),layout.heatCoolButtons("#heat_button","#cool_button",0,25);var u=new Thermometer("#thermometer");u.max=25;var v=new SliderComponent("#attraction_slider",function(a){model.setEpsilon(a)},lj_epsilon_max,lj_epsilon_min,model.getEpsilon());u.add_value(model.temperature()),autostart&&p()},controllers.complexModelController=function(a){function i(){model.nodes({num:mol_number,xdomain:10,ydomain:10,temperature:temperature,mol_rmin_radius_factor:.38}).initialize({temperature:temperature,coulomb_forces:layout.coulomb_forces_checkbox.checked,model_listener:b}),atoms=model.get_atoms(),nodes=model.get_nodes()}function j(){i(),model.set_coulomb_forces(layout.coulomb_forces_checkbox.checked),model.set_lennard_jones_forces(layout.lennard_jones_forces_checkbox.checked),model.relax(),c=[model.ke()]}function l(){mol_number=+k.value,u(),o()}function o(){f.change_yaxis(m[mol_number]),layout.lj_redraw(),speed_graph.ymax=n[mol_number],layout.speed_update(),layout.speed_redraw()}function p(){model_stopped=!0,model.stop(),f.hide_canvas(),g&&(h[0].checked=!0)}function q(){model_stopped=!0,model.stop(),model.stepCounter()<maximum_model_steps?(model.stepForward(),f.hide_canvas(),g&&(h[0].checked=!0)):g&&(h[0].checked=!1)}function r(){model_stopped=!1,model.on("tick",b),model.stepCounter()<maximum_model_steps?(f.show_canvas(),model.resume(),g&&(h[0].checked=!0)):g&&(h[0].checked=!1)}function s(){p(),model.stepBack(),f.new_data(c)}function t(){model_stopped=!0,model.stepCounter()<maximum_model_steps?model.stepForward():g&&(h[0].checked=!0)}function u(){mol_number=+k.value,update_coefficients(molecules_lennard_jones.coefficients()),j(),model.temperature(temperature),layout.temperature_control_checkbox.onchange(),molecule_container.update_molecule_radius(),molecule_container.setup_particles(),layout.setupScreen(layout.selection),o(),p(),step_counter=model.stepCounter(),layout.displayStats(),layout.datatable_visible?layout.render_datatable(!0):layout.hide_datatable(),c=[model.ke()],f.new_data(c),f.hide_canvas(),g&&(h[0].checked=!0)}function v(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model_stopped?r():p(),a.preventDefault();break;case 13:r(),a.preventDefault();break;case 37:s(),a.preventDefault();break;case 39:t(),a.preventDefault()}}layout.selection=a;var b=function(a){var b=model.ke(),d=model.pe(),e=model.stepCounter();layout.speed_update(),molecule_container.update_molecule_positions(),model.isNewStep()?(c.push(b),model_stopped?(f.add_point(b),f.update_canvas()):f.add_canvas_point(b)):f.update(),e>.95*f.xmax&&f.xmax<maximum_model_steps&&f.change_xaxis(f.xmax*2),e>=maximum_model_steps&&p(),layout.displayStats(),layout.datatable_visible&&layout.render_datatable()},c=[],d=document.getElementById("ke-chart"),e={title:"Kinetic Energy of the System",xlabel:"Model Time (ns)",xmin:0,xmax:2500,sample:sample_time,ylabel:null,ymin:0,ymax:200,dataset:c,container:d},f;layout.finishSetupKEChart=function(){undefined!==f?f.setup_graph():f=graphx.graph(e)};var g=document.getElementById("model-controls");if(g)var h=g.getElementsByTagName("input");var k=document.getElementById("select-molecule-number"),m={2:2,5:12.5,10:5,20:10,50:120,100:250,200:1e3,500:5e3},n={2:2,5:2,10:5,20:5,50:10,100:15,200:20,500:40};k.onchange=l,k.value=mol_number,g&&(g.onchange=modelController),document.onwebkitfullscreenchange=layout.setupScreen,window.onresize=layout.setupScreen,document.onkeydown=v,u(),autostart&&r()}})();