(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers={version:"0.0.1"},controllers.simpleModelController=function(a){function e(a){g(molecules_lennard_jones.epsilon(a))}function f(a){g(molecules_lennard_jones.sigma(a))}function g(a){var b=a.sigma,c=a.epsilon,e=a.rmin,f;model.set_lj_coefficients(c,b),d.coefficients.sigma=b,d.coefficients.epsilon=c,d.coefficients.rmin=e,d.xmax=b*3,d.xmin=Math.floor(b/2),d.ymax=Math.ceil(c*-1)+0,d.ymin=Math.ceil(c*1)-2,d.variables[1].x=b,d.variables[0].x=e,lennard_jones_potential=[];for(var g=b*.5;g<d.xmax*3;g+=.05)f=molecules_lennard_jones.potential(g),f<100&&lennard_jones_potential.push([g,f])}function h(){model.nodes({num:mol_number,xdomain:10,ydomain:10,temperature:temperature,rmin:4.4,mol_rmin_radius_factor:.38}).initialize({temperature:temperature,lennard_jones_forces:layout.lennard_jones_forces_checkbox.checked,coulomb_forces:layout.coulomb_forces_checkbox.checked,model_listener:b}),atoms=model.get_atoms(),nodes=model.get_nodes()}function j(){h(),model.set_coulomb_forces(layout.coulomb_forces_checkbox.checked),model.set_lennard_jones_forces(layout.lennard_jones_forces_checkbox.checked),model.set_temperature_control(!0),model.relax()}function l(){f(k[mol_number])}function m(){for(i=0;i<this.elements.length;i++)this.elements[i].checked&&(run_mode=this.elements[i].value);switch(run_mode){case"stop":n();break;case"step":o();break;case"go":p();break;case"reset":s()}}function n(){model_stopped=!0,model.stop()}function o(){model_stopped=!0,model.stop(),(!Number(maximum_model_steps)||model.stepCounter()<maximum_model_steps)&&model.stepForward()}function p(){model_stopped=!1,model.on("tick",b),(!Number(maximum_model_steps)||model.stepCounter()<maximum_model_steps)&&model.resume()}function q(){n(),model.stepBack()}function r(){model_stopped=!0,(!Number(maximum_model_steps)||model.stepCounter()<maximum_model_steps)&&model.stepForward()}function s(){j(),model.temperature(temperature),l(),n(),molecule_container.update_molecule_radius(),molecule_container.setup_particles(),layout.setupScreen(layout.selection),step_counter=model.stepCounter()}function t(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model_stopped?p():n(),a.preventDefault();break;case 13:p(),a.preventDefault();break;case 37:q(),a.preventDefault();break;case 39:r(),a.preventDefault()}}layout.selection=a;var b=function(a){molecule_container.update_molecule_positions(),u.add_value(model.temperature()),step_counter>=model.stepCounter()&&n()},c=molecules_lennard_jones.coefficients(),d={coefficients:c,variables:[{coefficient:"epsilon",x:c.rmin,y:c.epsilon},{coefficient:"sigma",x:c.sigma,y:0}]},k={2:7,5:6,10:5.5,20:5,50:4.5,100:4,200:3.5,500:3};document.onwebkitfullscreenchange=layout.setupScreen,window.onresize=layout.setupScreen,document.onkeydown=t,s(),layout.heatCoolButtons("#heat_button","#cool_button",0,25);var u=new Thermometer("#thermometer");u.max=25;var v=new SliderComponent("#attraction_slider",function(a){model.setEpsilon(a)},lj_epsilon_max,lj_epsilon_min,model.getEpsilon());u.add_value(model.temperature()),autostart&&p()},controllers.complexModelController=function(a){function e(){model.nodes({num:mol_number,xdomain:10,ydomain:10,temperature:temperature,mol_rmin_radius_factor:.38}).initialize({temperature:temperature,coulomb_forces:layout.coulomb_forces_checkbox.checked,model_listener:b}),atoms=model.get_atoms(),nodes=model.get_nodes()}function f(){e(),model.set_coulomb_forces(layout.coulomb_forces_checkbox.checked),model.set_lennard_jones_forces(layout.lennard_jones_forces_checkbox.checked),model.relax(),te_data=[model.ke()]}function h(){mol_number=+g.value,q(),k()}function k(){ke_graph.change_yaxis(i[mol_number]),layout.lj_redraw(),speed_graph.ymax=j[mol_number],layout.speed_update(),layout.speed_redraw()}function l(){model_stopped=!0,model.stop(),ke_graph.hide_canvas(),c&&(d[0].checked=!0)}function m(){model_stopped=!0,model.stop(),model.stepCounter()<maximum_model_steps?(model.stepForward(),ke_graph.hide_canvas(),c&&(d[0].checked=!0)):c&&(d[0].checked=!1)}function n(){model_stopped=!1,model.on("tick",b),model.stepCounter()<maximum_model_steps?(ke_graph.show_canvas(),model.resume(),c&&(d[0].checked=!0)):c&&(d[0].checked=!1)}function o(){l(),model.stepBack(),ke_graph.new_data(te_data)}function p(){model_stopped=!0,model.stepCounter()<maximum_model_steps?model.stepForward():c&&(d[0].checked=!0)}function q(){mol_number=+g.value,update_coefficients(molecules_lennard_jones.coefficients()),f(),model.temperature(temperature),layout.temperature_control_checkbox.onchange(),molecule_container.update_molecule_radius(),molecule_container.setup_particles(),layout.setupScreen(layout.selection),k(),l(),step_counter=model.stepCounter(),layout.displayStats(),layout.datatable_visible?layout.render_datatable(!0):layout.hide_datatable(),te_data=[model.ke()],ke_graph.new_data(te_data),ke_graph.hide_canvas(),c&&(d[0].checked=!0)}function r(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model_stopped?n():l(),a.preventDefault();break;case 13:n(),a.preventDefault();break;case 37:o(),a.preventDefault();break;case 39:p(),a.preventDefault()}}layout.selection=a;var b=function(a){var b=model.ke(),c=model.pe(),d=model.stepCounter();layout.speed_update(),molecule_container.update_molecule_positions(),model.isNewStep()?(te_data.push(b),model_stopped?(ke_graph.add_point(b),ke_graph.update_canvas()):ke_graph.add_canvas_point(b)):ke_graph.update(),d>.95*ke_graph.xmax&&ke_graph.xmax<maximum_model_steps&&ke_graph.change_xaxis(ke_graph.xmax*2),d>=maximum_model_steps&&l(),layout.displayStats(),layout.datatable_visible&&layout.render_datatable()},c=document.getElementById("model-controls");if(c)var d=c.getElementsByTagName("input");var g=document.getElementById("select-molecule-number"),i={2:2,5:12.5,10:5,20:10,50:120,100:250,200:1e3,500:5e3},j={2:2,5:2,10:5,20:5,50:10,100:15,200:20,500:40};g.onchange=h,g.value=mol_number,c&&(c.onchange=modelController),document.onwebkitfullscreenchange=layout.setupScreen,window.onresize=layout.setupScreen,document.onkeydown=r,q(),autostart&&n()}})();