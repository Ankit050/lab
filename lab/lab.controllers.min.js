(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers={version:"0.0.1"},controllers.simpleModelController=function(a,b,c){function w(){model.stop()}function x(){model.on("tick",r),(!Number(f)||model.stepCounter()<f)&&model.resume()}function y(){w(),model.stepBack()}function z(){(!Number(f)||model.stepCounter()<f)&&model.stepForward()}function A(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.resetTime(),w(),model.on("tick",r),q.updateMoleculeRadius(),q.setup_particles(),layout.setupScreen(v),s=model.stepCounter()}function B(){layout.setupScreen(),t.resize()}function C(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?q.playback_component.action("play"):q.playback_component.action("stop"),a.preventDefault();break;case 13:q.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||q.playback_component.action("stop"),y(),a.preventDefault();break;case 39:model.is_stopped()||q.playback_component.action("stop"),z(),a.preventDefault()}}function D(){t.add_value(model.get("temperature"))}function E(){u.set_scaled_value(model.get("epsilon"))}function F(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),q.setup_particles()}var d=c.layoutStyle,e=c.autostart,f=c.maximum_model_steps,g=c.lj_epsilon_max,h=c.lj_epsilon_min,i=b.atoms,j=b.mol_number,k=b.epsilon,l=b.sigma,m=b.temperature,n=b.coulomb_forces,o=b.width,p=b.height,q,r,s,t,u,v;r=function(a){q.update_molecule_positions(),s>=model.stepCounter()&&w()},model=modeler.model({model_listener:r,temperature:m,lennard_jones_forces:!0,coulomb_forces:n,temperature_control:!0,epsilon:k,width:o,height:p});if(i)model.createNewAtoms(i);else{if(!j)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(j),model.relax()}layout.selection=d,model_player=new ModelPlayer(model,e),q=layout.moleculeContainer(a,{xmax:o,ymax:p}),v={moleculeContainers:[q]},document.onwebkitfullscreenchange=B,window.onresize=B,document.onkeydown=C,A(),t=new Thermometer("#thermometer",model.temperature(),0,25),model.addPropertiesListener(["temperature"],D),D(),u=new SliderComponent("#attraction_slider",function(a){model.set({epsilon:a})},g,h,k),model.addPropertiesListener(["epsilon"],E),E(),layout.heatCoolButtons("#heat_button","#cool_button",0,25,model,function(a){t.add_value(a)}),model.addPropertiesListener(["coulomb_forces"],F),F(),e&&x()},controllers.complexModelController=function(a,b,c,d,e,f){function O(){function e(a){var b=model.ke(),c=model.pe(),d=b+c;K.update(),w.update_molecule_positions(),model.isNewStep()?(N++,D.push(d),model.is_stopped()?B.add_point(d):B.add_canvas_point(d)):B.update(),y>.95*B.xmax&&B.xmax<i&&B.change_xaxis(B.xmax*2),y>=i&&C(),layout.displayStats(),layout.datatable_visible&&layout.render_datatable()}function f(){D=[model.ke()+model.pe()]}function x(){model=modeler.model({model_listener:e,temperature:r,lennard_jones_forces:!0,coulomb_forces:t,temperature_control:s,epsilon:p,sigma:q,width:u,height:v});if(n)model.createNewAtoms(n);else{if(!o)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(o),model.relax()}}function z(){function e(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),w.setup_particles()}function i(){o=+G.value,T(),checkbox_thermalize.checked&&(model.relax(),w.update_molecule_positions()),M.checked=!1,n()}function n(){B.change_yaxis(H[o]),J.redraw(),K.redraw()}layout.selection=g,model_player=new ModelPlayer(model,h),w=layout.moleculeContainer(a,{title:"Simple Molecules",xlabel:"X position (nm)",ylabel:"Y position (nm)",playback_controller:!0,play_only_controller:!1,model_time_label:!0,grid_lines:!0,xunits:!0,yunits:!0,atom_mubers:!1,xmin:0,xmax:u,ymin:0,ymax:v}),model.addPropertiesListener(["sigma"],w.updateMoleculeRadius),f(),B=grapher.realTimeGraph(b,{title:"Total Energy of the System",xlabel:"Model Time (ps)",xmin:0,xmax:100,sample:.25,ylabel:null,ymin:0,ymax:200,dataset:D}),B.new_data(D),model.on("play",function(){B.number_of_points()&&N<B.number_of_points()&&(N===0?f():D.length=N,B.new_data(D)),B.show_canvas()}),model.on("stop",function(){B.hide_canvas()}),K=layout.speedDistributionChart(d,{title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01}),J=layout.potentialChart(c,model,{title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy",epsilon_max:j,epsilon_min:k,epsilon:p,sigma_max:l,sigma_min:m,sigma:q}),model.addPropertiesListener(["epsilon"],J.ljUpdate),model.addPropertiesListener(["sigma"],J.ljUpdate),model.addPropertiesListener(["coulomb_forces"],e),e(),L={moleculeContainers:[w],potentialCharts:[J],speedDistributionCharts:[K],energyCharts:[B]},E=document.getElementById("model-controls"),E&&(F=E.getElementsByTagName("input"),E.onchange=modelController),G=document.getElementById("select-molecule-number"),M=document.getElementById("radio-randomize-pos-vel"),checkbox_thermalize=document.getElementById("checkbox-thermalize"),H={2:2,5:12.5,10:5,20:10,50:120,100:250,200:1e3,500:5e3},I={2:2,5:2,10:5,20:5,50:10,100:15,200:20,500:40},G.onchange=i,M.onclick=i,G.value=o}function A(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.resetTime(),f(),w.updateMoleculeRadius(),w.setup_particles(),layout.setupScreen(L),y=model.stepCounter(),G.value=atoms.length,C(),model.on("tick",e)}function C(){model.stop(),B.hide_canvas(),w.playback_component.action("stop"),E&&(F[0].checked=!0)}function P(){model.stop(),model.stepCounter()<i?(model.stepForward(),B.hide_canvas(),E&&(F[0].checked=!0)):E&&(F[0].checked=!1)}function Q(){model.on("tick",e),model.stepCounter()<i?(B.show_canvas(),model.resume(),E&&(F[0].checked=!0)):E&&(F[0].checked=!1)}function R(){C(),N=model.stepBack(),B.showMarker(N)}function S(){model.stepCounter()<i?(N=model.stepForward(),B.showMarker(N)):E&&(F[0].checked=!0)}function T(){o=+G.value,model.createNewAtoms(o),A(),y=model.stepCounter(),layout.displayStats(),layout.datatable_visible?layout.render_datatable(!0):layout.hide_datatable(),f(),B.new_data(D),B.hide_canvas(),E&&(F[0].checked=!0)}function U(){layout.setupScreen(L)}function V(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?w.playback_component.action("play"):w.playback_component.action("stop"),a.preventDefault();break;case 13:w.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||w.playback_component.action("stop"),R(),a.preventDefault();break;case 39:model.is_stopped()||w.playback_component.action("stop"),S(),a.preventDefault()}}document.onwebkitfullscreenchange=U,window.onresize=U,document.onkeydown=V,x(),z(),A(),h&&Q(),O.modelListener=e,O.modelGo=Q,O.modelStop=C,O.modelReset=T,O.resetTEData=f,O.energyGraph=B}var g=f.layoutStyle,h=f.autostart,i=f.maximum_model_steps,j=f.lj_epsilon_max,k=f.lj_epsilon_min,l=2,m=.1,n=e.atoms,o=e.mol_number,p=e.epsilon,q=e.sigma,r=e.temperature,s=e.temperature_control,t=e.coulomb_forces,u=e.width,v=e.height,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,G,M,N=0;return O(),O}})();