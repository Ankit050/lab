(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers={version:"0.0.1"},controllers.simpleModelController=function(a,b,c){function r(){model.stop()}function s(){model.on("tick",m),(!Number(f)||model.stepCounter()<f)&&model.resume()}function t(){r(),model.stepBack()}function u(){(!Number(f)||model.stepCounter()<f)&&model.stepForward()}function v(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.relax(),model.resetTime(),r(),model.on("tick",m),molecule_container.update_molecule_radius(),molecule_container.setup_particles(),layout.setupScreen(q),n=model.stepCounter()}function w(){layout.setupScreen(),o.resize()}function x(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?molecule_container.playback_component.action("play"):molecule_container.playback_component.action("stop"),a.preventDefault();break;case 13:molecule_container.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||molecule_container.playback_component.action("stop"),t(),a.preventDefault();break;case 39:model.is_stopped()||molecule_container.playback_component.action("stop"),u(),a.preventDefault()}}function y(){o.add_value(model.get("temperature"))}function z(){p.set_scaled_value(model.get("epsilon"))}function A(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),molecule_container.setup_particles()}var d=c.layoutStyle,e=c.autostart,f=c.maximum_model_steps,g=c.lj_epsilon_max,h=c.lj_epsilon_min,i=b.mol_number,j=b.epsilon,k=b.temperature,l=b.coulomb_forces,m,n,o,p,q;m=function(a){molecule_container.update_molecule_positions(),n>=model.stepCounter()&&r()},model=modeler.model({temperature:k,lennard_jones_forces:!0,coulomb_forces:l,temperature_control:!0,model_listener:m,epsilon:j,mol_number:i}),layout.selection=d,model_player=new ModelPlayer(model,e),molecule_container=layout.moleculeContainer(a),q={moleculeContainers:[molecule_container]},document.onwebkitfullscreenchange=w,window.onresize=w,document.onkeydown=x,v(),o=new Thermometer("#thermometer",model.temperature(),0,25),model.addPropertiesListener(["temperature"],y),y(),p=new SliderComponent("#attraction_slider",function(a){model.set({epsilon:a})},g,h,j),model.addPropertiesListener(["epsilon"],z),z(),layout.heatCoolButtons("#heat_button","#cool_button",0,25,model,function(a){o.add_value(a)}),model.addPropertiesListener(["coulomb_forces"],A),A(),e&&s()},controllers.complexModelController=function(a,b,c,d,e,f){function D(){function e(a){var b=model.ke(),c=model.pe();B.update(),molecule_container.update_molecule_positions(),model.isNewStep()?(v.push(b),model.is_stopped()?(t.add_point(b),t.update_canvas()):t.add_canvas_point(b)):t.update(),p>.95*t.xmax&&t.xmax<i&&t.change_xaxis(t.xmax*2),p>=i&&I(),layout.displayStats(),layout.datatable_visible&&layout.render_datatable()}function f(a){r(molecules_lennard_jones.epsilon(a))}function o(a){r(molecules_lennard_jones.sigma(a))}function r(a){var b=a.sigma,c=a.epsilon,d=a.rmin,e,f;model.set_lj_coefficients(c,b),lj_data.coefficients.sigma=b,lj_data.coefficients.epsilon=c,lj_data.coefficients.rmin=d,lj_data.xmax=b*3,lj_data.xmin=Math.floor(b/2),lj_data.ymax=Math.ceil(c*-1)+0,lj_data.ymin=Math.ceil(c*1)-2,lj_data.variables[1].x=b,lj_data.variables[0].x=d,lennard_jones_potential=[];for(f=b*.5;f<lj_data.xmax*3;f+=.05)e=molecules_lennard_jones.potential(f),e<100&&lennard_jones_potential.push([f,e])}function F(){model.setEpsilon(m),atoms=model.get_atoms(),nodes=model.get_nodes(),model.relax(),model.resetTime(),v=[model.ke()],molecule_container.update_molecule_radius(),molecule_container.setup_particles(),layout.setupScreen(C),p=model.stepCounter(),I(),model.on("tick",e)}function G(){l=+x.value,N(),H()}function H(){t.change_yaxis(y[l]),layout.lj_redraw(),speed_graph.ymax=z[l],layout.speed_update(),layout.speed_redraw()}function I(){model.stop(),t.hide_canvas(),E&&(w[0].checked=!0)}function J(){model.stop(),model.stepCounter()<i?(model.stepForward(),t.hide_canvas(),E&&(w[0].checked=!0)):E&&(w[0].checked=!1)}function K(){model.on("tick",e),model.stepCounter()<i?(t.show_canvas(),model.resume(),E&&(w[0].checked=!0)):E&&(w[0].checked=!1)}function L(){I(),model.stepBack(),t.new_data(v)}function M(){model.stepCounter()<i?model.stepForward():E&&(w[0].checked=!0)}function N(){l=+x.value,r(molecules_lennard_jones.coefficients()),modelSetup(),model.temperature(n),layout.temperature_control_checkbox.onchange(),molecule_container.update_molecule_radius(),molecule_container.setup_particles(),layout.setupScreen(C),H(),I(),model.on("tick",e),p=model.stepCounter(),layout.displayStats(),layout.datatable_visible?layout.render_datatable(!0):layout.hide_datatable(),v=[model.ke()],t.new_data(v),t.hide_canvas(),E&&(w[0].checked=!0)}function O(){layout.setupScreen(C)}function P(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?molecule_container.playback_component.action("play"):molecule_container.playback_component.action("stop"),a.preventDefault();break;case 13:molecule_container.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||molecule_container.playback_component.action("stop"),L(),a.preventDefault();break;case 39:model.is_stopped()||molecule_container.playback_component.action("stop"),M(),a.preventDefault()}}model=modeler.model({temperature:n,lennard_jones_forces:!0,coulomb_forces:!1,temperature_control:!0,model_listener:e,mol_number:l}),layout.selection=g,model_player=new ModelPlayer(model,h),molecule_container=layout.moleculeContainer(a,{title:"Simple Molecules",xlabel:"X position (nm)",ylabel:"Y position (nm)",playback_controller:!0,play_only_controller:!1,model_time_label:!0,grid_lines:!0,xunits:!0,yunits:!0,atom_mubers:!1,xmin:0,xmax:10,ymin:0,ymax:10}),v=[],s=document.getElementById(b),u={title:"Kinetic Energy of the System",xlabel:"Model Time (ps)",xmin:0,xmax:2500,sample:.25,ylabel:null,ymin:0,ymax:200,dataset:v,container:s},layout.finishSetupKEChart=function(a,b){s.style.width=a+"px",s.style.height=b+"px",undefined!==t?t.setup_graph():t=graphx.graph(u)},B=layout.speedDistributionChart(d,{title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01}),lj_coefficients=molecules_lennard_jones.coefficients(),lj_data={coefficients:lj_coefficients,variables:[{coefficient:"epsilon",x:lj_coefficients.rmin,y:lj_coefficients.epsilon},{coefficient:"sigma",x:lj_coefficients.sigma,y:0}]},r(lj_coefficients),A=layout.potentialChart(c,lj_data,{title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy",epsilon_max:j,epsilon_min:k,initial_epsilon:m,epsilon_callback:f}),C={moleculeContainers:[molecule_container],potentialCharts:[A],speedDistributionCharts:[B],energyCharts:[]};var E=document.getElementById("model-controls");E&&(w=E.getElementsByTagName("input")),x=document.getElementById("select-molecule-number"),y={2:2,5:12.5,10:5,20:10,50:120,100:250,200:1e3,500:5e3},z={2:2,5:2,10:5,20:5,50:10,100:15,200:20,500:40},x.onchange=G,x.value=l,E&&(E.onchange=modelController),document.onwebkitfullscreenchange=O,window.onresize=O,document.onkeydown=P,F(),layout.heatCoolButtons("#heat_button","#cool_button",0,25,model,function(a){q.add_value(a)}),h&&K(),D.modelListener=e,D.modelGo=K,D.modelStop=I,D.modelReset=N}var g=f.layoutStyle,h=f.autostart,i=f.maximum_model_steps,j=f.lj_epsilon_max,k=f.lj_epsilon_min,l=e.mol_number,m=e.initial_epsilon,n=e.temperature,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;return D(),D}})();