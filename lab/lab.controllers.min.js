(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers={version:"0.0.1"},controllers.simpleModelController=function(a,b,c){function t(){model.stop()}function u(){model.on("tick",o),(!Number(f)||model.stepCounter()<f)&&model.resume()}function v(){t(),model.stepBack()}function w(){(!Number(f)||model.stepCounter()<f)&&model.stepForward()}function x(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.resetTime(),t(),model.on("tick",o),n.updateMoleculeRadius(),n.setup_particles(),layout.setupScreen(s),p=model.stepCounter()}function y(){layout.setupScreen(),q.resize()}function z(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?n.playback_component.action("play"):n.playback_component.action("stop"),a.preventDefault();break;case 13:n.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||n.playback_component.action("stop"),v(),a.preventDefault();break;case 39:model.is_stopped()||n.playback_component.action("stop"),w(),a.preventDefault()}}function A(){q.add_value(model.get("temperature"))}function B(){r.set_scaled_value(model.get("epsilon"))}function C(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),n.setup_particles()}var d=c.layoutStyle,e=c.autostart,f=c.maximum_model_steps,g=c.lj_epsilon_max,h=c.lj_epsilon_min,i=b.atoms,j=b.mol_number,k=b.epsilon,l=b.temperature,m=b.coulomb_forces,n,o,p,q,r,s;o=function(a){n.update_molecule_positions(),p>=model.stepCounter()&&t()},model=modeler.model({model_listener:o,temperature:l,lennard_jones_forces:!0,coulomb_forces:m,temperature_control:!0,epsilon:k});if(i)model.createNewAtoms(i);else{if(!j)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(j),model.relax()}layout.selection=d,model_player=new ModelPlayer(model,e),n=layout.moleculeContainer(a),s={moleculeContainers:[n]},document.onwebkitfullscreenchange=y,window.onresize=y,document.onkeydown=z,x(),q=new Thermometer("#thermometer",model.temperature(),0,25),model.addPropertiesListener(["temperature"],A),A(),r=new SliderComponent("#attraction_slider",function(a){model.set({epsilon:a})},g,h,k),model.addPropertiesListener(["epsilon"],B),B(),layout.heatCoolButtons("#heat_button","#cool_button",0,25,model,function(a){q.add_value(a)}),model.addPropertiesListener(["coulomb_forces"],C),C(),e&&u()},controllers.complexModelController=function(a,b,c,d,e,f){function L(){function e(a){var b=model.ke(),c=model.pe(),d=b+c;I.update(),u.update_molecule_positions(),model.isNewStep()?(B.push(d),model.is_stopped()?(z.add_point(d),z.update_canvas()):z.add_canvas_point(d)):z.update(),w>.95*z.xmax&&z.xmax<i&&z.change_xaxis(z.xmax*2),w>=i&&y(),layout.displayStats(),layout.datatable_visible&&layout.render_datatable()}function f(){model=modeler.model({model_listener:e,temperature:r,lennard_jones_forces:!0,coulomb_forces:t,temperature_control:s,epsilon:p,sigma:q});if(n)model.createNewAtoms(n);else{if(!o)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(o),model.relax()}}function v(){function e(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),u.setup_particles()}function f(){o=+E.value,P(),checkbox_thermalize.checked&&(model.relax(),u.update_molecule_positions()),K.checked=!1,i()}function i(){z.change_yaxis(F[o]),H.redraw(),I.redraw()}layout.selection=g,model_player=new ModelPlayer(model,h),u=layout.moleculeContainer(a,{title:"Simple Molecules",xlabel:"X position (nm)",ylabel:"Y position (nm)",playback_controller:!0,play_only_controller:!1,model_time_label:!0,grid_lines:!0,xunits:!0,yunits:!0,atom_mubers:!1,xmin:0,xmax:10,ymin:0,ymax:10}),model.addPropertiesListener(["sigma"],u.updateMoleculeRadius),z=grapher.realTimeGraph(b,{title:"Total Energy of the System",xlabel:"Model Time (ps)",xmin:0,xmax:2500,sample:.25,ylabel:null,ymin:0,ymax:200,dataset:B}),B=[model.ke()+model.pe()],z.new_data(B),model.on("play",z.show_canvas),model.on("stop",z.hide_canvas),I=layout.speedDistributionChart(d,{title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01}),H=layout.potentialChart(c,model,{title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy",epsilon_max:j,epsilon_min:k,epsilon:p,sigma_max:l,sigma_min:m,sigma:q}),model.addPropertiesListener(["epsilon"],H.ljUpdate),model.addPropertiesListener(["sigma"],H.ljUpdate),model.addPropertiesListener(["coulomb_forces"],e),e(),J={moleculeContainers:[u],potentialCharts:[H],speedDistributionCharts:[I],energyCharts:[z]},C=document.getElementById("model-controls"),C&&(D=C.getElementsByTagName("input"),C.onchange=modelController),E=document.getElementById("select-molecule-number"),K=document.getElementById("radio-randomize-pos-vel"),checkbox_thermalize=document.getElementById("checkbox-thermalize"),F={2:2,5:12.5,10:5,20:10,50:120,100:250,200:1e3,500:5e3},G={2:2,5:2,10:5,20:5,50:10,100:15,200:20,500:40},E.onchange=f,K.onclick=f,E.value=o}function x(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.resetTime(),B=[model.ke()],u.updateMoleculeRadius(),u.setup_particles(),layout.setupScreen(J),w=model.stepCounter(),E.value=atoms.length,y(),model.on("tick",e)}function y(){model.stop(),z.hide_canvas(),u.playback_component.action("stop"),C&&(D[0].checked=!0)}function A(){model.stop(),model.stepCounter()<i?(model.stepForward(),z.hide_canvas(),C&&(D[0].checked=!0)):C&&(D[0].checked=!1)}function M(){model.on("tick",e),model.stepCounter()<i?(z.show_canvas(),model.resume(),C&&(D[0].checked=!0)):C&&(D[0].checked=!1)}function N(){y(),model.stepBack(),z.new_data(B)}function O(){model.stepCounter()<i?model.stepForward():C&&(D[0].checked=!0)}function P(){o=+E.value,model.createNewAtoms(o),x(),w=model.stepCounter(),layout.displayStats(),layout.datatable_visible?layout.render_datatable(!0):layout.hide_datatable(),B=[model.ke()],z.new_data(B),z.hide_canvas(),C&&(D[0].checked=!0)}function Q(){layout.setupScreen(J)}function R(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?u.playback_component.action("play"):u.playback_component.action("stop"),a.preventDefault();break;case 13:u.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||u.playback_component.action("stop"),N(),a.preventDefault();break;case 39:model.is_stopped()||u.playback_component.action("stop"),O(),a.preventDefault()}}document.onwebkitfullscreenchange=Q,window.onresize=Q,document.onkeydown=R,f(),v(),x(),h&&M(),L.modelListener=e,L.modelGo=M,L.modelStop=y,L.modelReset=P}var g=f.layoutStyle,h=f.autostart,i=f.maximum_model_steps,j=f.lj_epsilon_max,k=f.lj_epsilon_min,l=2,m=.1,n=e.atoms,o=e.mol_number,p=e.epsilon,q=.34,r=e.temperature,s=e.temperature_control,t=e.coulomb_forces,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,E,K;return L(),L}})();