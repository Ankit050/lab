(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers={version:"0.0.1"},controllers.simpleModelController=function(a,b,c){function t(){model.stop()}function u(){model.on("tick",o),(!Number(f)||model.stepCounter()<f)&&model.resume()}function v(){t(),model.stepBack()}function w(){(!Number(f)||model.stepCounter()<f)&&model.stepForward()}function x(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.relax(),model.resetTime(),t(),model.on("tick",o),n.updateMoleculeRadius(),n.setup_particles(),layout.setupScreen(s),p=model.stepCounter()}function y(){layout.setupScreen(),q.resize()}function z(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?n.playback_component.action("play"):n.playback_component.action("stop"),a.preventDefault();break;case 13:n.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||n.playback_component.action("stop"),v(),a.preventDefault();break;case 39:model.is_stopped()||n.playback_component.action("stop"),w(),a.preventDefault()}}function A(){q.add_value(model.get("temperature"))}function B(){r.set_scaled_value(model.get("epsilon"))}function C(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),n.setup_particles()}var d=c.layoutStyle,e=c.autostart,f=c.maximum_model_steps,g=c.lj_epsilon_max,h=c.lj_epsilon_min,i=b.atoms,j=b.mol_number,k=b.epsilon,l=b.temperature,m=b.coulomb_forces,n,o,p,q,r,s;o=function(a){n.update_molecule_positions(),p>=model.stepCounter()&&t()},model=modeler.model({model_listener:o,temperature:l,lennard_jones_forces:!0,coulomb_forces:m,temperature_control:!0,epsilon:k});if(i)model.createNewAtoms(i);else{if(!j)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(j)}layout.selection=d,model_player=new ModelPlayer(model,e),n=layout.moleculeContainer(a),s={moleculeContainers:[n]},document.onwebkitfullscreenchange=y,window.onresize=y,document.onkeydown=z,x(),q=new Thermometer("#thermometer",model.temperature(),0,25),model.addPropertiesListener(["temperature"],A),A(),r=new SliderComponent("#attraction_slider",function(a){model.set({epsilon:a})},g,h,k),model.addPropertiesListener(["epsilon"],B),B(),layout.heatCoolButtons("#heat_button","#cool_button",0,25,model,function(a){q.add_value(a)}),model.addPropertiesListener(["coulomb_forces"],C),C(),e&&u()},controllers.complexModelController=function(a,b,c,d,e,f){function J(){function e(a){var b=model.ke(),c=model.pe(),d=b+c;H.update(),t.update_molecule_positions(),model.isNewStep()?(A.push(d),model.is_stopped()?(y.add_point(d),y.update_canvas()):y.add_canvas_point(d)):y.update(),v>.95*y.xmax&&y.xmax<i&&y.change_xaxis(y.xmax*2),v>=i&&x(),layout.displayStats(),layout.datatable_visible&&layout.render_datatable()}function f(){model=modeler.model({model_listener:e,temperature:r,lennard_jones_forces:!0,coulomb_forces:s,temperature_control:!0,epsilon:p,sigma:q});if(n)model.createNewAtoms(n);else{if(!o)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(o)}}function u(){function e(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),t.setup_particles()}function f(){o=+D.value,N(),i()}function i(){y.change_yaxis(E[o]),G.redraw(),H.redraw()}layout.selection=g,model_player=new ModelPlayer(model,h),t=layout.moleculeContainer(a,{title:"Simple Molecules",xlabel:"X position (nm)",ylabel:"Y position (nm)",playback_controller:!0,play_only_controller:!1,model_time_label:!0,grid_lines:!0,xunits:!0,yunits:!0,atom_mubers:!1,xmin:0,xmax:10,ymin:0,ymax:10}),model.addPropertiesListener(["sigma"],t.updateMoleculeRadius),y=grapher.realTimeGraph(b,{title:"Total Energy of the System",xlabel:"Model Time (ps)",xmin:0,xmax:2500,sample:.25,ylabel:null,ymin:0,ymax:200,dataset:A}),A=[model.ke()+model.pe()],y.new_data(A),model.on("play",y.show_canvas),model.on("stop",y.hide_canvas),H=layout.speedDistributionChart(d,{title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01}),G=layout.potentialChart(c,model,{title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy",epsilon_max:j,epsilon_min:k,epsilon:p,sigma_max:l,sigma_min:m,sigma:q}),model.addPropertiesListener(["epsilon"],G.ljUpdate),model.addPropertiesListener(["sigma"],G.ljUpdate),model.addPropertiesListener(["coulomb_forces"],e),I={moleculeContainers:[t],potentialCharts:[G],speedDistributionCharts:[H],energyCharts:[y]},B=document.getElementById("model-controls"),B&&(C=B.getElementsByTagName("input"),B.onchange=modelController),D=document.getElementById("select-molecule-number"),E={2:2,5:12.5,10:5,20:10,50:120,100:250,200:1e3,500:5e3},F={2:2,5:2,10:5,20:5,50:10,100:15,200:20,500:40},D.onchange=f,D.value=o}function w(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.relax(),model.resetTime(),A=[model.ke()],t.updateMoleculeRadius(),t.setup_particles(),layout.setupScreen(I),v=model.stepCounter(),x(),model.on("tick",e)}function x(){model.stop(),y.hide_canvas(),t.playback_component.action("stop"),B&&(C[0].checked=!0)}function z(){model.stop(),model.stepCounter()<i?(model.stepForward(),y.hide_canvas(),B&&(C[0].checked=!0)):B&&(C[0].checked=!1)}function K(){model.on("tick",e),model.stepCounter()<i?(y.show_canvas(),model.resume(),B&&(C[0].checked=!0)):B&&(C[0].checked=!1)}function L(){x(),model.stepBack(),y.new_data(A)}function M(){model.stepCounter()<i?model.stepForward():B&&(C[0].checked=!0)}function N(){o=+D.value,model.createNewAtoms(o),w(),v=model.stepCounter(),layout.displayStats(),layout.datatable_visible?layout.render_datatable(!0):layout.hide_datatable(),A=[model.ke()],y.new_data(A),y.hide_canvas(),B&&(C[0].checked=!0)}function O(){layout.setupScreen(I)}function P(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?t.playback_component.action("play"):t.playback_component.action("stop"),a.preventDefault();break;case 13:t.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||t.playback_component.action("stop"),L(),a.preventDefault();break;case 39:model.is_stopped()||t.playback_component.action("stop"),M(),a.preventDefault()}}document.onwebkitfullscreenchange=O,window.onresize=O,document.onkeydown=P,f(),u(),w(),h&&K(),J.modelListener=e,J.modelGo=K,J.modelStop=x,J.modelReset=N}var g=f.layoutStyle,h=f.autostart,i=f.maximum_model_steps,j=f.lj_epsilon_max,k=f.lj_epsilon_min,l=2,m=.1,n=e.atoms,o=e.mol_number,p=e.epsilon,q=.34,r=e.temperature,s=e.coulomb_forces,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;return J(),J}})();