(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers={version:"0.0.1"},controllers.simpleModelController=function(a,b,c){function x(){model.stop()}function y(){model.on("tick",s),(!Number(f)||model.stepCounter()<f)&&model.resume()}function z(){x(),model.stepBack()}function A(){(!Number(f)||model.stepCounter()<f)&&model.stepForward()}function B(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.resetTime(),x(),model.on("tick",s),r.updateMoleculeRadius(),r.setup_particles(),layout.setupScreen(w),t=model.stepCounter()}function C(){layout.setupScreen(w),u.resize()}function D(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?r.playback_component.action("play"):r.playback_component.action("stop"),a.preventDefault();break;case 13:r.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||r.playback_component.action("stop"),z(),a.preventDefault();break;case 39:model.is_stopped()||r.playback_component.action("stop"),A(),a.preventDefault()}}function E(){u.add_value(model.get("temperature"))}function F(){v.set_scaled_value(model.get("epsilon"))}function G(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),r.setup_particles()}var d=c.layoutStyle,e=c.autostart,f=c.maximum_model_steps,g=c.lj_epsilon_max,h=c.lj_epsilon_min,i=b.elements,j=b.atoms,k=b.mol_number,l=b.epsilon,m=b.sigma,n=b.temperature,o=b.coulomb_forces,p=b.width,q=b.height,r,s,t,u,v,w;s=function(a){r.update_molecule_positions(),t>=model.stepCounter()&&x()},model=modeler.model({elements:i,model_listener:s,temperature:n,lennard_jones_forces:!0,coulomb_forces:o,temperature_control:!0,epsilon:l,sigma:m,width:p,height:q});if(j)model.createNewAtoms(j);else{if(!k)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(k),model.relax()}layout.selection=d,model_player=new ModelPlayer(model,e),r=layout.moleculeContainer(a,{xmax:p,ymax:q}),w={moleculeContainers:[r]},document.onwebkitfullscreenchange=C,window.onresize=C,document.onkeydown=D,B(),u=new Thermometer("#thermometer",model.temperature(),0,25),model.addPropertiesListener(["temperature"],E),E(),v=new SliderComponent("#attraction_slider",function(a){model.set({epsilon:a})},g,h,l),model.addPropertiesListener(["epsilon"],F),F(),layout.heatCoolButtons("#heat_button","#cool_button",0,25,model,function(a){u.add_value(a)}),model.addPropertiesListener(["coulomb_forces"],G),G(),e&&y()},controllers.complexModelController=function(a,b,c,d,e,f){function P(){function e(a){var b=model.ke(),c=model.pe(),d=b+c;L.update(),x.update_molecule_positions(),model.isNewStep()?(O++,E.push(d),model.is_stopped()?C.add_point(d):C.add_canvas_point(d)):C.update(),z>.95*C.xmax&&C.xmax<i&&C.change_xaxis(C.xmax*2),z>=i&&D(),layout.displayStats(),layout.datatable_visible&&layout.render_datatable()}function f(){E=[model.ke()+model.pe()]}function y(){model=modeler.model({elements:n,model_listener:e,temperature:s,lennard_jones_forces:!0,coulomb_forces:u,temperature_control:t,epsilon:q,sigma:r,width:v,height:w});if(o)model.createNewAtoms(o);else{if(!p)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(p),model.relax()}}function A(){function e(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),x.setup_particles()}function i(){p=+H.value,U(),checkbox_thermalize.checked&&(model.relax(),x.update_molecule_positions()),N.checked=!1,n()}function n(){C.change_yaxis(I[p]),K.redraw(),L.redraw()}layout.selection=g,model_player=new ModelPlayer(model,h),x=layout.moleculeContainer(a,{title:"Simple Molecules",xlabel:"X position (nm)",ylabel:"Y position (nm)",playback_controller:!0,play_only_controller:!1,model_time_label:!0,grid_lines:!0,xunits:!0,yunits:!0,atom_mubers:!1,xmin:0,xmax:v,ymin:0,ymax:w}),model.addPropertiesListener(["sigma"],x.updateMoleculeRadius),f(),C=grapher.realTimeGraph(b,{title:"Total Energy of the System",xlabel:"Model Time (ps)",xmin:0,xmax:2500,sample:.25,ylabel:null,ymin:0,ymax:200,dataset:E}),C.new_data(E),model.on("play",function(){C.number_of_points()&&O<C.number_of_points()&&(O===0?f():E.length=O,C.new_data(E)),C.show_canvas()}),model.on("stop",function(){C.hide_canvas()}),model.on("seek",function(){f(),C.new_data(E)}),L=layout.speedDistributionChart(d,{title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01}),K=layout.potentialChart(c,model,{title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy",epsilon_max:j,epsilon_min:k,epsilon:q,sigma_max:l,sigma_min:m,sigma:r}),model.addPropertiesListener(["epsilon"],K.ljUpdate),model.addPropertiesListener(["sigma"],K.ljUpdate),model.addPropertiesListener(["coulomb_forces"],e),e(),M={moleculeContainers:[x],potentialCharts:[K],speedDistributionCharts:[L],energyCharts:[C]},F=document.getElementById("model-controls"),F&&(G=F.getElementsByTagName("input"),F.onchange=modelController),H=document.getElementById("select-molecule-number"),N=document.getElementById("radio-randomize-pos-vel"),checkbox_thermalize=document.getElementById("checkbox-thermalize"),I={2:2,5:12.5,10:5,20:10,50:120,100:250,200:1e3,500:5e3},J={2:2,5:2,10:5,20:5,50:10,100:15,200:20,500:40},H.onchange=i,N.onclick=i,H.value=p}function B(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.resetTime(),f(),x.updateMoleculeRadius(),x.setup_particles(),layout.setupScreen(M),z=model.stepCounter(),H.value=atoms.length,D(),model.on("tick",e)}function D(){model.stop(),C.hide_canvas(),x.playback_component.action("stop"),F&&(G[0].checked=!0)}function Q(){model.stop(),model.stepCounter()<i?(model.stepForward(),C.hide_canvas(),F&&(G[0].checked=!0)):F&&(G[0].checked=!1)}function R(){model.on("tick",e),model.stepCounter()<i?(C.show_canvas(),model.resume(),F&&(G[0].checked=!0)):F&&(G[0].checked=!1)}function S(){D(),O=model.stepBack(),C.showMarker(O)}function T(){model.stepCounter()<i?(O=model.stepForward(),C.showMarker(O)):F&&(G[0].checked=!0)}function U(){p=+H.value,model.createNewAtoms(p),B(),z=model.stepCounter(),layout.displayStats(),layout.datatable_visible?layout.render_datatable(!0):layout.hide_datatable(),f(),C.new_data(E),C.hide_canvas(),F&&(G[0].checked=!0)}function V(){layout.setupScreen(M)}function W(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?x.playback_component.action("play"):x.playback_component.action("stop"),a.preventDefault();break;case 13:x.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||x.playback_component.action("stop"),S(),a.preventDefault();break;case 39:model.is_stopped()||x.playback_component.action("stop"),T(),a.preventDefault()}}document.onwebkitfullscreenchange=V,window.onresize=V,document.onkeydown=W,y(),A(),B(),h&&R(),P.modelListener=e,P.modelGo=R,P.modelStop=D,P.modelReset=U,P.resetTEData=f,P.energyGraph=C,P.moleculeContainer=x}var g=f.layoutStyle,h=f.autostart,i=f.maximum_model_steps,j=f.lj_epsilon_max,k=f.lj_epsilon_min,l=2,m=.1,n=e.elements,o=e.atoms,p=e.mol_number,q=e.epsilon,r=e.sigma,s=e.temperature,t=e.temperature_control,u=e.coulomb_forces,v=e.width,w=e.height,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,H,N,O=0;return P(),P}})();