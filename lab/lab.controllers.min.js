(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers={version:"0.0.1"},controllers.modelController=function(e,t,n){function m(){v.update_drawable_positions()}function g(){i=n.layoutStyle,s=n.autostart,o=t.elements,u=t.atoms,a=t.mol_number,f=t.temperature_control,l=t.temperature,c=t.width,h=t.height,p=t.radialBonds,d=t.obstacles}function y(){g(),model=modeler.model({elements:o,temperature:l,temperature_control:f,width:c,height:h});if(u)model.createNewAtoms(u);else{if(!a)throw new Error("ModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(a),model.relax()}p&&model.createRadialBonds(p),d&&model.createObstacles(d)}function b(){layout.selection=i,model_player=new ModelPlayer(model,!1),v=layout.moleculeContainer(e,{xmax:c,ymax:h,get_nodes:function(){return model.get_nodes()},get_num_atoms:function(){return model.get_num_atoms()},get_obstacles:function(){return model.get_obstacles()}}),v.updateMoleculeRadius(),v.setup_drawables(),layout.addView("moleculeContainers",v),layout.setupScreen()}function w(){v.reset({xmax:c,ymax:h,get_nodes:function(){return model.get_nodes()},get_num_atoms:function(){return model.get_num_atoms()},get_obstacles:function(){return model.get_obstacles()}}),layout.setupScreen(!0)}function E(){model.resetTime(),model.stop(),model.on("tick",m)}function S(e){y(),E(),e?b():w()}function x(e,r){t=e,n=r,S(!1)}function N(){layout.setupScreen()}var r={},i,s,o,u,a,f,l,c,h,p,d,v;if(typeof DEVELOPMENT=="undefined")try{S(!0)}catch(T){throw alert(T),new Error(T)}else S(!0);return document.onwebkitfullscreenchange=N,window.onresize=N,r.reload=x,r},controllers.interactivesController=function(e,t,n){function a(e){var t={layoutStyle:n};$.get(e).done(function(e){e=typeof e=="string"?JSON.parse(e):e,i?i.reload(e,t):(i=controllers.modelController("#molecule-container",e,t),v())})}function f(e){switch(e.type){case"button":return c(e);case"thermometer":return h(e)}}function l(e){var t,n,r,i,s;n={addAtom:function(){return model.addRandomAtom.apply(model,arguments)},addRandomAtom:function(){return model.addRandomAtom.apply(model,arguments)},get:function(){return model.get.apply(model,arguments)},set:function(){return model.set.apply(model,arguments)},console:window.console},r=[],i=[];for(t in n)n.hasOwnProperty(t)&&(r.push(t),i.push(n[t]));return s="'use strict';"+e,function(){var t,n,o,u;n=[];for(t in window)window.hasOwnProperty(t)&&r.indexOf(t)<0&&n.push(t);o=r.concat(n).concat(s);try{u=Function.apply(null,o)}catch(a){alert('Error compiling script: "'+a.toString()+'"\nScript:\n\n'+e)}try{u.apply(null,i)}catch(a){alert("Error running script: "+a.toString())}}}function c(e){var t,n;return t=$("<button>").attr("id",e.id).html(e.text),typeof e.action=="string"?n=e.action:n=e.action.join("\n"),t.click(l(n)),t}function h(e){function i(){n.add_value(model.get("temperature"))}var t=$("<div>").attr("id",e.id),n=new Thermometer(t,0,e.min,e.max),r=$("<div>").css("padding-bottom","4em").append(t).append($("<div>").text("Thermometer"));return p(["temperature"],i),d(function(){n.resize(),i()}),layout.addView("thermometers",n),r}function p(e,t){typeof model!="undefined"?model.addPropertiesListener(e,t):o.push([e,t])}function d(e){typeof model!="undefined"?e():u.push(e)}function v(){var e,t;while(o.length>0)e=o.pop(),model.addPropertiesListener(e[0],e[1]);while(u.length>0)t=u.pop()()}function m(t,n){var r,i={},o,u,l,c,h,p,d,v;e=t,s=$(n),s.children().length===0?(h=$('<div class="top" id="top"/>'),h.append('<div id="molecule-container"/>'),p=$('<div id="right"/>'),h.append(p),s.append(h),s.append('<div class="bottom" id="bottom"/>')):($("#bottom").html(""),$("#right").html(""),s.append('<div id="bottom"/>')),e.model&&a(e.model),r=e.components;for(d=0,v=r.length;d<v;d++)o=f(r[d]),i[r[d].id]=o;if(e.layout)for(l in e.layout)if(e.layout.hasOwnProperty(l)){u=e.layout[l];for(d=0,v=u.length;d<v;d++)c=u[d],i[c]&&($("#"+l).append(i[c]),delete i[c])}for(c in i)i.hasOwnProperty(c)&&$("#bottom").append(i[c])}typeof n=="undefined"&&(n="interactive");var r={},i,s,o=[],u=[];return m(e,t),r.loadInteractive=m,r},controllers.compareModelsController=function(e,t,n,r,i){function I(){function r(e){E.update_drawable_positions()}function i(){model=modeler.model({elements:l,model_listener:r,temperature:d,lennard_jones_forces:!0,coulomb_forces:v,temperature_control:p,width:m,height:g});if(c)model.createNewAtoms(c);else{if(!h)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms({num:h,relax:!0})}y&&model.createRadialBonds(y),b&&model.createObstacles(b)}function u(){layout.selection=s,model_player=new ModelPlayer(model,o),E=layout.moleculeContainer(e,{playback_controller:!1,play_only_controller:!1,model_time_label:!0,grid_lines:!0,xunits:!0,yunits:!0,xmax:m,ymax:g,get_nodes:function(){return model.get_nodes()},get_num_atoms:function(){return model.get_num_atoms()},get_obstacles:function(){return model.get_obstacles()}}),E.updateMoleculeRadius(),E.setup_drawables(),_=M(),_?O={params:[["script","page:0:import /imports/legacy-mw-content/"+_]]}:O={},A=layout.appletContainer(t,O),layout.addView("moleculeContainers",E),layout.addView("appletContainers",A),layout.setupScreen()}function a(){model.stop()}function f(){model.on("tick",r),model.resume()}function S(){model.stop(),model.stepBack()}function T(){model.stop(),model.stepForward()}function N(){model.stop(),i(),k(),r()}function k(){w=model.get_nodes(),model.resetTime(),a(),model.on("tick",r),x=model.stepCounter()}function L(){return F=document.location.hash,F.length>0?F.substr(1,F.length):!1}function M(){var e=L();return e?j[e.replace("/imports/legacy-mw-content/","")].cmlPath:!1}function q(){var e=L();e?B.value=e.replace("/imports/legacy-mw-content/",""):B.value="two-atoms-two-elements/two-atoms-two-elements$0.json"}function R(){var e,t,n,r,i;j={};for(e=0;e<modelList.length;e++){r=modelList[e],i=r.section;for(t=0;t<r.content.length;t++)n=r.content[t],j[n.json]={name:n.name,jsonPath:n.json,cmlPath:n.cml}}}function U(){R(),d3.select(B).selectAll("optgroup").data(modelList).enter().append("optgroup").attr("label",function(e){return e.section}).selectAll("option").data(function(e){return e.content}).enter().append("option").text(function(e){return e.name}).attr("value",function(e){return e.json}).attr("data-cml-path",function(e){return e.cml}),q()}function z(e){return A.applet.runMwScript(e)}function W(){var e=$(B).find("option:selected"),t="/imports/legacy-mw-content/",n=e.attr("value");C=t+n,document.location.hash="#"+C}function X(){M()&&(O={params:[["script","page:0:import "+M()]]},A=layout.appletContainer(t,O),z("page:0:set frank false"),layout.setView("appletContainers",[A]),layout.setupScreen())}function V(){layout.setupScreen()}function J(){U(),i(),k(),u(),q()}B=document.getElementById(n),D=document.getElementById("start"),D.onclick=function(){z("mw2d:1:run"),f()},P=document.getElementById("stop"),P.onclick=function(){z("mw2d:1:stop"),a()},H=document.getElementById("reset"),H.onclick=function(){z("mw2d:1:reset"),N()},B.onchange=W,document.onwebkitfullscreenchange=V,window.onresize=V;if(typeof DEVELOPMENT=="undefined")try{J()}catch(K){throw alert(K),new Error(K)}else J();I.runMWScript=z}var s=i.layoutStyle,o=i.autostart,u=i.maximum_model_steps,a=i.lj_epsilon_max,f=i.lj_epsilon_min,l=r.elements,c=r.atoms,h=r.mol_number,p=r.temperature_control,d=r.temperature,v=r.coulomb_forces,m=r.width,g=r.height,y=r.radialBonds,b=r.obstacles,w,E,S,x,T,N,C,k,L,A,O={},M,_,D,P,H,B,j,F;return I(),I}})();