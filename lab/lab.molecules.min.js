var require=function(a,b){var c=require.resolve(a,b||"/"),d=require.modules[c];if(!d)throw new Error("Failed to resolve module "+a+", tried "+c);var e=d._cached?d._cached:d();return e};require.paths=[],require.modules={},require.extensions=[".js",".coffee"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(a,b){function g(a){if(require.modules[a])return a;for(var b=0;b<require.extensions.length;b++){var c=require.extensions[b];if(require.modules[a+c])return a+c}}function h(a){a=a.replace(/\/+$/,"");var b=a+"/package.json";if(require.modules[b]){var d=require.modules[b](),e=d.browserify;if(typeof e=="object"&&e.main){var f=g(c.resolve(a,e.main));if(f)return f}else if(typeof e=="string"){var f=g(c.resolve(a,e));if(f)return f}else if(d.main){var f=g(c.resolve(a,d.main));if(f)return f}}return g(a+"/index")}function i(a,b){var c=j(b);for(var d=0;d<c.length;d++){var e=c[d],f=g(e+"/"+a);if(f)return f;var i=h(e+"/"+a);if(i)return i}var f=g(a);if(f)return f}function j(a){var b;a==="/"?b=[""]:b=c.normalize(a).split("/");var d=[];for(var e=b.length-1;e>=0;e--){if(b[e]==="node_modules")continue;var f=b.slice(0,e+1).join("/")+"/node_modules";d.push(f)}return d}b||(b="/");if(require._core[a])return a;var c=require.modules.path();b=c.resolve("/",b);var d=b||"/";if(a.match(/^(?:\.\.?\/|\/)/)){var e=g(c.resolve(d,a))||h(c.resolve(d,a));if(e)return e}var f=i(a,d);if(f)return f;throw new Error("Cannot find module '"+a+"'")}}(),require.alias=function(a,b){var c=require.modules.path(),d=null;try{d=require.resolve(a+"/package.json","/")}catch(e){d=require.resolve(a,"/")}var f=c.dirname(d),g=(Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b})(require.modules);for(var h=0;h<g.length;h++){var i=g[h];if(i.slice(0,f.length+1)===f+"/"){var j=i.slice(f.length);require.modules[b+j]=require.modules[f+j]}else i===f&&(require.modules[b]=require.modules[f])}},require.define=function(a,b){var c=require._core[a]?"":require.modules.path().dirname(a),d=function(a){return require(a,c)};d.resolve=function(a){return require.resolve(a,c)},d.modules=require.modules,d.define=require.define;var e={exports:{}};require.modules[a]=function(){return require.modules[a]._cached=e.exports,b.call(e.exports,d,e,e.exports,c,a),require.modules[a]._cached=e.exports,e.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var a=[],b=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return b&&window.addEventListener("message",function(b){if(b.source===window&&b.data==="browserify-tick"){b.stopPropagation();if(a.length>0){var c=a.shift();c()}}},!0),function(c){b?(a.push(c),window.postMessage("browserify-tick","*")):setTimeout(c,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(a){if(a==="evals")return require("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),process.env||(process.env={}),process.argv||(process.argv=[]),require.define("path",function(a,b,c,d,e){function f(a,b){var c=[];for(var d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}function g(a,b){var c=0;for(var d=a.length;d>=0;d--){var e=a[d];e=="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}var h=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;c.resolve=function(){var a="",b=!1;for(var c=arguments.length;c>=-1&&!b;c--){var d=c>=0?arguments[c]:process.cwd();if(typeof d!="string"||!d)continue;a=d+"/"+a,b=d.charAt(0)==="/"}return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),(b?"/":"")+a||"."},c.normalize=function(a){var b=a.charAt(0)==="/",c=a.slice(-1)==="/";return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),!a&&!b&&(a="."),a&&c&&(a+="/"),(b?"/":"")+a},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(f(a,function(a,b){return a&&typeof a=="string"}).join("/"))},c.dirname=function(a){var b=h.exec(a)[1]||"",c=!1;return b?b.length===1||c&&b.length<=3&&b.charAt(1)===":"?b:b.substring(0,b.length-1):"."},c.basename=function(a,b){var c=h.exec(a)[2]||"";return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return h.exec(a)[3]||""}}),require.define("/arrays/arrays.js",function(a,b,c,d,e){var f;f=c.arrays={},f.version="0.0.1",f.webgl=typeof window!="undefined"&&!!window.WebGLRenderingContext,f.typed=!1;try{var g=new Float64Array(0);f.typed=!0}catch(h){}f.create=function(a,b,c){c||(f.webgl||f.typed?c="Float32Array":c="regular"),b=b||0;var d,e;if(c==="regular")d=new Array(a);else switch(c){case"Float64Array":d=new Float64Array(a);break;case"Float32Array":d=new Float32Array(a);break;case"Int32Array":d=new Int32Array(a);break;case"Int16Array":d=new Int16Array(a);break;case"Int8Array":d=new Int8Array(a);break;case"Uint32Array":d=new Uint32Array(a);break;case"Uint16Array":d=new Uint16Array(a);break;case"Uint8Array":d=new Uint8Array(a);break;default:d=new Array(a)}e=-1;while(++e<a)d[e]=b;return d},f.constructor_function=function(a){if(a.buffer&&a.buffer.__proto__.constructor)return a.__proto__.constructor;if(a.constructor===Array)return a.constructor;throw new Error("arrays.constructor_function: must be an Array or Typed Array:   source: "+a+", source.constructor: "+a.constructor+", source.buffer: "+a.buffer+", source.buffer.slice: "+a.buffer.slice+", source.buffer.__proto__: "+a.buffer.__proto__+", source.buffer.__proto__.constructor: "+a.buffer.__proto__.constructor)},f.copy=function(a,b){var c=a.length,d=-1;while(++d<c)b[d]=a[d];return b.length=c,b},f.clone=function(a){var b,c=a.length,d,e;e=f.constructor_function(a);if(e===Array){d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d}if(a.buffer.slice)return d=new e(a.buffer.slice(0)),d;d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d},f.between=function(a,b,c){return c<Math.max(a,b)&&c>Math.min(a,b)},f.max=function(a){return Math.max.apply(Math,a)},f.min=function(a){return Math.min.apply(Math,a)},f.maxTypedArray=function(a){var b,c,d=Number.MIN_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b>d?b:d;return d},f.minTypedArray=function(a){var b,c,d=Number.MAX_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b<d?b:d;return d},f.maxAnyArray=function(a){try{return Math.max.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MIN_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c>e?c:e;return e}}},f.minAnyArray=function(a){try{return Math.min.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MAX_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c<e?c:e;return e}}},f.average=function(a){var b,c=0,d=a.length;for(b=0;b<d;b++)c+=a[b];return c/d}}),require.define("/constants/index.js",function(a,b,c,d,e){var f=a("./units"),g=f.unit,h=f.ratio,i=f.convert,j={ELEMENTARY_CHARGE:{value:1,unit:g.ELEMENTARY_CHARGE},ATOMIC_MASS:{value:1,unit:g.DALTON},BOLTZMANN_CONSTANT:{value:1.380658e-23,unit:g.JOULES_PER_KELVIN},AVAGADRO_CONSTANT:{value:h(g.DALTON,{per:g.GRAM}),unit:g.INVERSE_MOLE},PERMITTIVITY_OF_FREE_SPACE:{value:8.854187e-12,unit:g.FARADS_PER_METER}},k,l;j.COULOMB_CONSTANT={value:1/(4*Math.PI*j.PERMITTIVITY_OF_FREE_SPACE.value),unit:g.METERS_PER_FARAD},c.unit=g,c.ratio=h,c.convert=i;for(k in j)j.hasOwnProperty(k)&&(l=j[k],c[k]=function(a){return{as:function(b){return f.convert(a.value,{from:a.unit,to:b})}}}(l))}),require.define("/constants/units.js",function(a,b,c,d,e){var f=1.66054e-27,g=1.602177e-19,h=g,i=1e-15,j=1e-9,k=10,l=1e3,m={TIME:"time",LENGTH:"length",MASS:"mass",ENERGY:"energy",ENTROPY:"entropy",CHARGE:"charge",INVERSE_QUANTITY:"inverse quantity",FARADS_PER_METER:"farads per meter",METERS_PER_FARAD:"meters per farad",FORCE:"force",VELOCITY:"velocity",AREA:"area",PRESSURE:"pressure"},n,o,p;c.unit=n={FEMTOSECOND:{name:"femtosecond",value:1,type:m.TIME},SECOND:{name:"second",value:i,type:m.TIME},NANOMETER:{name:"nanometer",value:1,type:m.LENGTH},ANGSTROM:{name:"Angstrom",value:1*k,type:m.LENGTH},METER:{name:"meter",value:1*j,type:m.LENGTH},DALTON:{name:"Dalton",value:1,type:m.MASS},GRAM:{name:"gram",value:1*f*l,type:m.MASS},KILOGRAM:{name:"kilogram",value:1*f,type:m.MASS},MW_ENERGY_UNIT:{name:"MW Energy Unit (Dalton * nm^2 / fs^2)",value:1,type:m.ENERGY},JOULE:{name:"Joule",value:f*j*j*(1/i)*(1/i),type:m.ENERGY},EV:{name:"electron volt",value:f*j*j*(1/i)*(1/i)*(1/h),type:m.ENERGY},EV_PER_KELVIN:{name:"electron volts per Kelvin",value:1,type:m.ENTROPY},JOULES_PER_KELVIN:{name:"Joules per Kelvin",value:1*h,type:m.ENTROPY},ELEMENTARY_CHARGE:{name:"elementary charge",value:1,type:m.CHARGE},COULOMB:{name:"Coulomb",value:g,type:m.CHARGE},INVERSE_MOLE:{name:"inverse moles",value:1,type:m.INVERSE_QUANTITY},FARADS_PER_METER:{name:"Farads per meter",value:1,type:m.FARADS_PER_METER},METERS_PER_FARAD:{name:"meters per Farad",value:1,type:m.METERS_PER_FARAD},MW_FORCE_UNIT:{name:"MW force units (Dalton * nm / fs^2)",value:1,type:m.FORCE},NEWTON:{name:"Newton",value:1*f*j*(1/i)*(1/i),type:m.FORCE},MW_VELOCITY_UNIT:{name:"MW velocity units (nm / fs)",value:1,type:m.VELOCITY},METERS_PER_SECOND:{name:"meters per second",value:1*j*(1/i),type:m.VELOCITY}},c.ratio=o=function(a,b){var c=function(a,b){if(a.type!==b.type)throw new Error("Attempt to convert incompatible type '"+a.name+"'' to '"+b.name+"'")};if(b.per)return c(a,b.per),a.value/b.per.value;if(b.as)return c(a,b.as),b.as.value/a.value;throw new Error("units.ratio() received arguments it couldn't understand.")},c.convert=p=function(a,b){var c=b&&b.from,d=b&&b.to;if(!c)throw new Error('units.convert() did not receive a "from" argument');if(!d)throw new Error('units.convert() did not receive a "to" argument');return a*o(d,{per:c})}}),require.define("/math/index.js",function(a,b,c,d,e){c.normal=a("./distributions").normal,c.getWindowedAverager=a("./utils").getWindowedAverager}),require.define("/math/distributions.js",function(a,b,c,d,e){c.normal=function(){var a=null;return function(b,c){b==null&&(b=0),c==null&&(c=1);var d,e,f,g,h;return a?(e=a,a=null,e):(g=Math.random(),h=Math.random(),f=2*Math.PI*g,d=Math.sqrt(-2*Math.log(h)),a=b+c*d*Math.sin(f),b+c*d*Math.cos(f))}}()}),require.define("/math/utils.js",function(a,b,c,d,e){c.getWindowedAverager=function(a){a==null&&(a=1e3);var b=0,c=[],d=0;return function(e){return d-=c[b]||0,d+=e,c[b]=e,++b===a&&(b=0),c.length===a?d/a:NaN}}}),require.define("/potentials/index.js",function(a,b,c,d,e){var f=c.potentials={};c.coulomb=a("./coulomb"),c.makeLennardJonesCalculator=a("./lennard-jones").makeLennardJonesCalculator}),require.define("/potentials/coulomb.js",function(a,b,c,d,e){var f=a("../constants"),g=f.unit,h=f.COULOMB_CONSTANT.as(f.unit.METERS_PER_FARAD),i=f.ratio(g.NANOMETER,{per:g.METER}),j=Math.pow(f.ratio(g.COULOMB,{per:g.ELEMENTARY_CHARGE}),2),k=f.ratio(g.EV,{per:g.JOULE}),l=f.ratio(g.MW_FORCE_UNIT,{per:g.NEWTON}),m=h*j*i*k,n=h*j*i*i*l,o=c.potential=function(a,b,c){return m*(b*c/a)},p=c.forceFromSquaredDistance=function(a,b,c){return-n*(b*c/a)},q=c.forceOverDistanceFromSquaredDistance=function(a,b,c){return p(a,b,c)/Math.sqrt(a)},r=c.force=function(a,b,c){return p(a*a,b,c)}}),require.define("/potentials/lennard-jones.js",function(a,b,c,d,e){var f=a("../constants"),g=f.unit,h=f.ratio(g.NANOMETER,{per:g.METER}),i=f.ratio(g.MW_FORCE_UNIT,{per:g.NEWTON});c.makeLennardJonesCalculator=function(a,b){var c,d,e,j,k,l,m,n=function(a,n){arguments.length&&(c=a,d=n,e=Math.pow(2,1/6)*d,j=4*c*Math.pow(d,12),k=4*c*Math.pow(d,6),l=12*f.convert(j,{from:g.EV,to:g.JOULE})*h*i,m=6*f.convert(k,{from:g.EV,to:g.JOULE})*h*i);var o={epsilon:c,sigma:d,rmin:e};return typeof b=="function"&&b(o,this),o},o=function(a){return j*Math.pow(a,-6)-k*Math.pow(a,-3)+c},p=function(a){var b=1/a,c=b*b*b,d=c*b,e=d*c;return l*e-m*d};return n(a.epsilon,a.sigma),{coefficients:n,setEpsilon:function(a){return n(a,d)},setSigma:function(a){return n(c,a)},potentialFromSquaredDistance:o,potential:function(a){return o(a*a)},forceOverDistanceFromSquaredDistance:p,force:function(a){return a*p(a*a)}}}}),require.define("/md2d.js",function(a,b,c,d,e){typeof window=="undefined"&&(window={});var f=a("./arrays/arrays").arrays,g=a("./constants"),h=g.unit,i=a("./math"),j=a("./potentials").coulomb,k=a("./potentials").makeLennardJonesCalculator,l=!0,m=function(){try{new Float32Array}catch(a){return!1}return!0}(),n=2,o=1e3,p=-120*g.BOLTZMANN_CONSTANT.as(h.EV_PER_KELVIN),q=.34,r=39.95,s=g.convert(r,{from:h.DALTON,to:h.KILOGRAM}),t=g.BOLTZMANN_CONSTANT.as(h.JOULES_PER_KELVIN),u,v,w=function(a,b,c,d){return a*d-b*c},x=function(a,b){return a*a+b*b},y=function(){},z=function(a,b){var c=2*b-3,d=2/c*a,e=g.convert(d,{from:h.MW_ENERGY_UNIT,to:h.JOULE});return e/t};c.INDICES=v={RADIUS:0,PX:1,PY:2,X:3,Y:4,VX:5,VY:6,SPEED:7,AX:8,AY:9,MASS:10,CHARGE:11},c.NODE_PROPERTIES_COUNT=u=12,c.makeModel=function(){var a,b=!1,c=!1,d=!1,e=!0,s=!1,t=!1,y=100,A=.001,B=[10,10],C,D,E,F,G=0,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ba,bb,bc,bd,be,bf,bg=window.state={},bh,bi,bj=function(a){bh=a.rmin*5,bi=bh*bh},bk=window.lennardJones=k({epsilon:p,sigma:q},bj),bl,bm=function(){return d?1e3:1e3},bn=function(){t=!0,bl=i.getWindowedAverager(bm())},bo=function(){var a=0,b;for(b=0;b<J;b++)a+=V[b]*(Q[b]*Q[b]+R[b]*R[b]);return z(a/2,J)},bp=function(a,b){Q[a]*=b,R[a]*=b},bq=function(a,b,c){Q[a]+=b,R[a]+=c},br=function(a,b){Q[a]-=b*(P[a]-Z),R[a]+=b*(O[a]-Y)},bs=function(){for(var a=0;a<J;a++)bq(a,-ba,-bb),br(a,-be)},bt=function(){for(var a=0;a<J;a++)bq(a,ba,bb),br(a,be)},bu=function(){var a=0,b=0,c=0,d=0,e;for(e=0;e<J;e++)a+=O[e],b+=P[e],c+=M[e],d+=N[e];Y=a/J,Z=b/J,$=c,_=d,ba=c/K,bb=d/K},bv=function(){var a=0,b=0,c;for(c=0;c<J;c++)a+=V[c]*w(O[c]-Y,P[c]-Z,Q[c]-ba,R[c]-bb),b+=V[c]*x(O[c]-Y,P[c]-Z);bc=a,bd=b,be=bc/bd},bw=function(){bu(),bv()},bx=function(a){O[a]+=Q[a]*H+.5*T[a]*I,P[a]+=R[a]*H+.5*U[a]*I},by=function(a){O[a]<F?(O[a]=F+(F-O[a]),Q[a]*=-1):O[a]>D&&(O[a]=D-(O[a]-D),Q[a]*=-1),P[a]<E?(P[a]=E+(E-P[a]),R[a]*=-1):P[a]>C&&(P[a]=C-(P[a]-C),R[a]*=-1)},bz=function(a){Q[a]+=.5*T[a]*H,M[a]=V[a]*Q[a],R[a]+=.5*U[a]*H,N[a]=V[a]*R[a]},bA=function(a){var b,c,f,g,h,i,k,l,m=1/V[a],n=W[a];for(b=0;b<a;b++)c=O[b]-O[a],f=P[b]-P[a],g=c*c+f*f,h=0,e&&g<bi&&(h+=bk.forceOverDistanceFromSquaredDistance(g)),d&&(h+=j.forceOverDistanceFromSquaredDistance(g,n,W[b])),h&&(i=h*m,k=i*c,l=i*f,T[a]+=k,U[a]+=l,T[b]-=k,U[b]-=l)},bB=function(){var a,b;bs(),bf=bo(),t&&Math.abs(bl(bf)-y)<=y*A&&(t=!1);if(t||s&&bf>0){a=Math.sqrt(y/bf);for(b=0;b<J;b++)bp(b,a);bf=y}bt()};return a={outputState:bg,useCoulombInteraction:function(a){a!==d&&(d=a,bn())},useLennardJonesInteraction:function(a){a!==e&&(e=a,e&&bn())},useThermostat:function(a){s=a},setTargetTemperature:function(a){a!==y&&(y=a,bn()),y=a},setTime:function(a){bg.time=G=a},setSize:function(a){if(b)throw new Error("The molecular model's size has already been set, and cannot be reset.");B=[a[0],a[1]]},getSize:function(){return[B[0],B[1]]},setLJEpsilon:function(a){bk.setEpsilon(a)},getLJEpsilon:function(){return bk.coefficients().epsilon},setLJSigma:function(a){bk.setSigma(a)},getLJSigma:function(){return bk.coefficients().sigma},getLJCalculator:function(){return bk},createAtoms:function(d){var e=bk.coefficients().rmin,g=m&&l?"Float32Array":"regular";if(c)throw new Error("md2d: createAtoms was called even though the particles have already been created for this model instance.");c=!0,b=!0;if(!d||typeof d.num=="undefined")throw new Error("md2d: createAtoms was called without the required 'N' option specifying the number of atoms to create.");if(d.num!==Math.floor(d.num))throw new Error("md2d: createAtoms was passed a non-integral 'N' option.");if(d.num<n)throw new Error("md2d: create Atoms was passed an 'N' option less than the minimum allowable value N_MIN = "+n+".");if(d.num>o)throw new Error("md2d: create Atoms was passed an 'N' option greater than the maximum allowable value N_MAX = "+o+".");J=d.num,X=a.nodes=f.create(u,null,"regular"),L=a.radius=X[v.RADIUS]=f.create(J,.5*e,g),M=a.px=X[v.PX]=f.create(J,0,g),N=a.py=X[v.PY]=f.create(J,0,g),O=a.x=X[v.X]=f.create(J,0,g),P=a.y=X[v.Y]=f.create(J,0,g),Q=a.vx=X[v.VX]=f.create(J,0,g),R=a.vy=X[v.VY]=f.create(J,0,g),S=a.speed=X[v.SPEED]=f.create(J,0,g),T=a.ax=X[v.AX]=f.create(J,0,g),U=a.ay=X[v.AY]=f.create(J,0,g),V=a.mass=X[v.MASS]=f.create(J,r,g),W=a.charge=X[v.CHARGE]=f.create(J,0,g),K=a.totalMass=J*r},initializeAtomsRandomly:function(b){var c=b.temperature||100,d=g.BOLTZMANN_CONSTANT.as(h.JOULES_PER_KELVIN),e,f,j,k=Math.floor(Math.sqrt(J)),l=Math.ceil(J/k),m,n,o,p,q,r,s,t;q=B[0]/(1+l),p=B[1]/(1+k),m=-1;for(n=1;n<=k;n++)for(o=1;o<=l;o++){m++;if(m===J)break;O[m]=o*q,P[m]=n*p,m<Math.floor(J/2)&&(e=g.convert(V[m],{from:h.DALTON,to:h.KILOGRAM}),f=Math.sqrt(2*d*c/e),j=g.convert(f,{from:h.METERS_PER_SECOND,to:h.MW_VELOCITY_UNIT}),r=i.normal(j,j/4),s=2*Math.random()*Math.PI,Q[m]=r*Math.cos(s),M[m]=V[m]*Q[m],R[m]=r*Math.sin(s),N[m]=V[m]*R[m],Q[J-m-1]=-Q[m],M[J-m-1]=V[J-m-1]*Q[J-m-1],R[J-m-1]=-R[m],N[J-m-1]=V[J-m-1]*R[J-m-1]),T[m]=0,U[m]=0,S[m]=Math.sqrt(Q[m]*Q[m]+R[m]*R[m]),W[m]=2*(m%2)-1}bw(),bs(),bf=bo(),t=Math.sqrt(c/bf);for(m=0;m<J;m++)bp(m,t);bf=c,bt(),a.computeOutputState()},relaxToTemperature:function(a){a!=null&&(y=a),bn();while(t)this.integrate()},integrate:function(b,d){if(!c)throw new Error("md2d: integrate called before atoms created.");b==null&&(b=250),H=d||5,I=H*H,F=L[0],E=L[0],D=B[0]-L[0],C=B[1]-L[0];var e=G,f=Math.floor(b/H),g,h;for(g=1;g<=f;g++){G=e+g*H;for(h=0;h<J;h++)bx(h),by(h),bz(h),T[h]=U[h]=0,bA(h);for(h=0;h<J;h++)bz(h),S[h]=Math.sqrt(Q[h]*Q[h]+R[h]*R[h]);bw(),bB()}a.computeOutputState()},computeOutputState:function(){var a,b,c,f,i,k,l;l=0,k=0;for(a=0;a<J;a++){k+=.5*V[a]*(Q[a]*Q[a]+R[a]*R[a]);for(b=a+1;b<J;b++)c=O[b]-O[a],f=P[b]-P[a],i=c*c+f*f,e&&(l+=-bk.potentialFromSquaredDistance(i)),d&&(l+=-j.potential(Math.sqrt(i),W[a],W[b]))}bg.time=G,bg.pressure=0,bg.PE=l,bg.KE=g.convert(k,{from:h.MW_ENERGY_UNIT,to:h.EV}),bg.T=bf,bg.pCM=[$,_],bg.CM=[Y,Z],bg.vCM=[ba,bb],bg.omega_CM=be}}}}),require("/md2d.js"),function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),molecules_coulomb={},molecules_coulomb={version:"0.0.1"};var a=-50;molecules_coulomb.force=function(b,c,d){return a*(c*d/(b*b))},molecules_coulomb.potential=function(b,c,d){return-a*(c*d/b)},molecules_lennard_jones={},molecules_lennard_jones={version:"0.0.1"};var b=-1,c=4,d=Math.pow(2,1/6)*c,e=4*b*Math.pow(c,12),f=4*b*Math.pow(c,6);molecules_lennard_jones.epsilon=function(a){return molecules_lennard_jones.coefficients(a,c)},molecules_lennard_jones.sigma=function(a){return molecules_lennard_jones.coefficients(b,a)},molecules_lennard_jones.coefficients=function(a,g){arguments.length&&(b=a,c=g,d=Math.pow(2,1/6)*c,e=4*b*Math.pow(c,12),f=4*b*Math.pow(c,6));var h={epsilon:b,sigma:c,rmin:d,alpha:e,beta:f};return h},molecules_lennard_jones.potential=function(a){return(e/Math.pow(a,12)-f/Math.pow(a,6))*-1},molecules_lennard_jones.force=function(a){var b=Math.pow(a,6),c=b*a,d=b*c;return 12*e/d-6*f/c};var g=require("./md2d"),h;modeler={},modeler.VERSION="0.2.0",modeler.model=function(a){function Q(a){$.unique(a);for(var b=0,c=a.length;b<c;b++)a[b]()}function R(a){return 5+a*1995/25}function S(){var a,b=0,c=N[0].length;a=-1;while(++a<c)b+=H[a];return b/c}function T(){return l===0}function U(){var a,b=[],c=M;a=-1;while(++a<c)b[a]=arrays.clone(N[a]);k.length=l,l++,m++,n=!0,k.push({nodes:b,ke:x,time:v}),l>1e3&&(k.splice(0,1),l=1e3)}function V(){var a;return T()&&U(),h.integrate(),q=y.pressure,w=y.PE,x=y.KE,v=y.time,r.push(q),r.splice(0,r.length-16),U(),j||(a=Date.now(),s?(s=a-s,s&&t.push(s),s=a,t.splice(0,t.length-128)):s=a,d.tick({type:"tick"})),j}function W(){k=[],l=0,m=-1}function X(){k.length=l+1}function Y(a){var b,c=M;if(a<0)throw new Error("modeler: request for tick_history_list["+a+"]");if(a>=k.length)throw new Error("modeler: request for tick_history_list["+a+"], tick_history_list.length="+k.length);b=-1;while(++b<c)arrays.copy(k[a].nodes[b],N[b]);x=k[a].ke,v=k[a].time,h.setTime(v)}function Z(){return r.reduce(function(a,b){return a+b})/r.length}function _(a){if(!arguments.length)return _.reduce(function(a,b){return a+b})/r.length;_.push(a),_.splice(0,_.length-100)}function ba(){var a,b,c=0,d=t.length;a=-1;while(++a<d)c+=t[a];return b=c/d,b?1/b*1e3:0}function bb(a){u=a,h.setTargetTemperature(R(a))}var b={},c=[],d=d3.dispatch("tick"),e,f,i,j=!0,k=[],l=0,m=0,n=!1,o,p,q,r=[0],s,t=[],u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=12,N,O={},P={mol_number:50,temperature:3,coulomb_forces:!1,epsilon:-0.1,set_temperature:function(a){this.temperature=a,h&&h.setTargetTemperature(R(a))},set_coulomb_forces:function(a){this.coulomb_forces=a,h&&h.useCoulombInteraction(a),molecule_container&&molecule_container.setup_particles()},set_epsilon:function(a){this.epsilon=a,h&&h.setLJEpsilon(a)}};b.INDICES={RADIUS:g.INDICES.RADIUS,PX:g.INDICES.PX,PY:g.INDICES.PY,X:g.INDICES.X,Y:g.INDICES.Y,VX:g.INDICES.VX,VY:g.INDICES.VY,SPEED:g.INDICES.SPEED,AX:g.INDICES.AX,AY:g.INDICES.AY,MASS:g.INDICES.MASS,CHARGE:g.INDICES.CHARGE},h=g.makeModel(),h.createAtoms({num:a.mol_number}),N=h.nodes,A=h.radius,B=h.px,C=h.py,D=h.x,E=h.y,F=h.vx,G=h.vy,H=h.speed,I=h.ax,J=h.ay,K=h.mass,L=h.charge,y=h.outputState,c.length=N[0].length,f=a.lennard_jones_forces||!0,i=a.coulomb_forces||!1,e=a.temperature_control||!1,u=a.temperature||5,z=a.model_listener||!1,W(),n=!0,h.useLennardJonesInteraction(f),h.useCoulombInteraction(i),h.useThermostat(e);var bc=R(u);return h.setTargetTemperature(bc),h.initializeAtomsRandomly({temperature:bc}),b.getStats=function(){return{speed:S(),ke:x,temperature:u,pressure:Z(),current_step:m,steps:k.length-1}},b.stepCounter=function(){return m},b.steps=function(){return T()?0:k.length-1},b.isNewStep=function(){return n},b.seek=function(a){return arguments.length||(a=0),j=!0,n=!1,l=a,m=a,Y(l),m},b.stepBack=function(a){arguments.length||(a=1);var b=-1;j=!0,n=!1;while(++b<a)l>1&&(l--,m--,Y(l-1),z&&z());return m},b.stepForward=function(a){arguments.length||(a=1);var b=-1;j=!0;while(++b<a)l<k.length?(Y(l),l++,m++,z&&z()):(V(),z&&z());return m},b.set_lj_coefficients=function(a,b){o=a,p=b},b.setEpsilon=function(a){h.setLJEpsilon(a)},b.setSigma=function(a){h.setLJSigma(a)},b.getEpsilon=function(){return h.getLJEpsilon()},b.getSigma=function(){return h.getLJSigma()},b.getLJCalculator=function(){return h.getLJCalculator()},b.resetTime=function(){h.setTime(0)},b.getTime=function(){return y?y.time:undefined},b.set_radius=function(a){},b.get_speed=function(){return arrays.copy(H,[])},b.get_rate=function(){return ba()},b.is_stopped=function(){return j},b.set_temperature_control=function(a){e=a,h.useThermostat(a)},b.set_lennard_jones_forces=function(a){f=a,h.useLennardJonesInteraction(a)},b.set_coulomb_forces=function(a){i=a,h.useCoulombInteraction(a)},b.get_nodes=function(){return N},b.get_atoms=function(){return c},b.on=function(a,c){return d.on(a,c),b},b.tickInPlace=function(){return d.tick({type:"tick"}),b},b.tick=function(a){arguments.length||(a=1);var c=-1;while(++c<a)V();return b},b.relax=function(){return h.relaxToTemperature(),b},b.start=function(){return b.resume()},b.resume=function(){return j=!1,d3.timer(V),b},b.stop=function(){return j=!0,b},b.ke=function(){return y?y.KE:undefined},b.ave_ke=function(){return y?y.KE/N[0].length:undefined},b.pe=function(){return y?y.PE:undefined},b.ave_pe=function(){return y?y.PE/N[0].length:undefined},b.speed=function(){return S()},b.pressure=function(){return Z()},b.temperature=function(a){return arguments.length?(bb(a),b):u},b.size=function(a){return arguments.length?(h.setSize(a),b):h.getSize()},b.set=function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&(P["set_"+b]?P["set_"+b](a[b]):P[b]&&(P[b]=a[b]),O[b]&&(c=c.concat(O[b])));Q(c)},b.get=function(a){return P[a]},b.addPropertiesListener=function(a,b){var c,d,e;for(c=0,d=a.length;c<d;c++)e=a[c],O[e]||(O[e]=[]),O[e].push(b)},b.serialize=function(){return JSON.stringify(P)},b}}();