var require=function(a,b){var c=require.resolve(a,b||"/"),d=require.modules[c];if(!d)throw new Error("Failed to resolve module "+a+", tried "+c);var e=d._cached?d._cached:d();return e};require.paths=[],require.modules={},require.extensions=[".js",".coffee"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(a,b){function g(a){if(require.modules[a])return a;for(var b=0;b<require.extensions.length;b++){var c=require.extensions[b];if(require.modules[a+c])return a+c}}function h(a){a=a.replace(/\/+$/,"");var b=a+"/package.json";if(require.modules[b]){var d=require.modules[b](),e=d.browserify;if(typeof e=="object"&&e.main){var f=g(c.resolve(a,e.main));if(f)return f}else if(typeof e=="string"){var f=g(c.resolve(a,e));if(f)return f}else if(d.main){var f=g(c.resolve(a,d.main));if(f)return f}}return g(a+"/index")}function i(a,b){var c=j(b);for(var d=0;d<c.length;d++){var e=c[d],f=g(e+"/"+a);if(f)return f;var i=h(e+"/"+a);if(i)return i}var f=g(a);if(f)return f}function j(a){var b;a==="/"?b=[""]:b=c.normalize(a).split("/");var d=[];for(var e=b.length-1;e>=0;e--){if(b[e]==="node_modules")continue;var f=b.slice(0,e+1).join("/")+"/node_modules";d.push(f)}return d}b||(b="/");if(require._core[a])return a;var c=require.modules.path();b=c.resolve("/",b);var d=b||"/";if(a.match(/^(?:\.\.?\/|\/)/)){var e=g(c.resolve(d,a))||h(c.resolve(d,a));if(e)return e}var f=i(a,d);if(f)return f;throw new Error("Cannot find module '"+a+"'")}}(),require.alias=function(a,b){var c=require.modules.path(),d=null;try{d=require.resolve(a+"/package.json","/")}catch(e){d=require.resolve(a,"/")}var f=c.dirname(d),g=(Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b})(require.modules);for(var h=0;h<g.length;h++){var i=g[h];if(i.slice(0,f.length+1)===f+"/"){var j=i.slice(f.length);require.modules[b+j]=require.modules[f+j]}else i===f&&(require.modules[b]=require.modules[f])}},require.define=function(a,b){var c=require._core[a]?"":require.modules.path().dirname(a),d=function(a){return require(a,c)};d.resolve=function(a){return require.resolve(a,c)},d.modules=require.modules,d.define=require.define;var e={exports:{}};require.modules[a]=function(){return require.modules[a]._cached=e.exports,b.call(e.exports,d,e,e.exports,c,a),require.modules[a]._cached=e.exports,e.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var a=[],b=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return b&&window.addEventListener("message",function(b){if(b.source===window&&b.data==="browserify-tick"){b.stopPropagation();if(a.length>0){var c=a.shift();c()}}},!0),function(c){b?(a.push(c),window.postMessage("browserify-tick","*")):setTimeout(c,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(a){if(a==="evals")return require("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),process.env||(process.env={}),process.argv||(process.argv=[]),require.define("path",function(a,b,c,d,e){function f(a,b){var c=[];for(var d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}function g(a,b){var c=0;for(var d=a.length;d>=0;d--){var e=a[d];e=="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}var h=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;c.resolve=function(){var a="",b=!1;for(var c=arguments.length;c>=-1&&!b;c--){var d=c>=0?arguments[c]:process.cwd();if(typeof d!="string"||!d)continue;a=d+"/"+a,b=d.charAt(0)==="/"}return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),(b?"/":"")+a||"."},c.normalize=function(a){var b=a.charAt(0)==="/",c=a.slice(-1)==="/";return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),!a&&!b&&(a="."),a&&c&&(a+="/"),(b?"/":"")+a},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(f(a,function(a,b){return a&&typeof a=="string"}).join("/"))},c.dirname=function(a){var b=h.exec(a)[1]||"",c=!1;return b?b.length===1||c&&b.length<=3&&b.charAt(1)===":"?b:b.substring(0,b.length-1):"."},c.basename=function(a,b){var c=h.exec(a)[2]||"";return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return h.exec(a)[3]||""}}),require.define("/arrays/arrays.js",function(a,b,c,d,e){var f;f=c.arrays={},f.version="0.0.1",f.webgl=typeof window!="undefined"&&!!window.WebGLRenderingContext,f.typed=!1;try{var g=new Float64Array(0);f.typed=!0}catch(h){}f.create=function(a,b,c){c||(f.webgl||f.typed?c="Float32Array":c="regular"),b=b||0;var d,e;if(c==="regular")d=new Array(a);else switch(c){case"Float64Array":d=new Float64Array(a);break;case"Float32Array":d=new Float32Array(a);break;case"Int32Array":d=new Int32Array(a);break;case"Int16Array":d=new Int16Array(a);break;case"Int8Array":d=new Int8Array(a);break;case"Uint32Array":d=new Uint32Array(a);break;case"Uint16Array":d=new Uint16Array(a);break;case"Uint8Array":d=new Uint8Array(a);break;default:d=new Array(a)}e=-1;while(++e<a)d[e]=b;return d},f.constructor_function=function(a){if(a.buffer&&a.buffer.__proto__.constructor)return a.__proto__.constructor;if(a.constructor===Array)return a.constructor;throw new Error("arrays.constructor_function: must be an Array or Typed Array:   source: "+a+", source.constructor: "+a.constructor+", source.buffer: "+a.buffer+", source.buffer.slice: "+a.buffer.slice+", source.buffer.__proto__: "+a.buffer.__proto__+", source.buffer.__proto__.constructor: "+a.buffer.__proto__.constructor)},f.copy=function(a,b){var c=a.length,d=-1;while(++d<c)b[d]=a[d];return b.length=c,b},f.clone=function(a){var b,c=a.length,d,e;e=f.constructor_function(a);if(e===Array){d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d}if(a.buffer.slice)return d=new e(a.buffer.slice(0)),d;d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d},f.between=function(a,b,c){return c<Math.max(a,b)&&c>Math.min(a,b)},f.max=function(a){return Math.max.apply(Math,a)},f.min=function(a){return Math.min.apply(Math,a)},f.maxTypedArray=function(a){var b,c,d=Number.MIN_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b>d?b:d;return d},f.minTypedArray=function(a){var b,c,d=Number.MAX_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b<d?b:d;return d},f.maxAnyArray=function(a){try{return Math.max.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MIN_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c>e?c:e;return e}}},f.minAnyArray=function(a){try{return Math.min.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MAX_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c<e?c:e;return e}}},f.average=function(a){var b,c=0,d=a.length;for(b=0;b<d;b++)c+=a[b];return c/d}}),require.define("/constants/index.js",function(a,b,c,d,e){var f=a("./units"),g=f.unit,h=f.ratio,i=f.convert,j={ELEMENTARY_CHARGE:{value:1,unit:g.ELEMENTARY_CHARGE},ATOMIC_MASS:{value:1,unit:g.DALTON},BOLTZMANN_CONSTANT:{value:1.380658e-23,unit:g.JOULES_PER_KELVIN},AVAGADRO_CONSTANT:{value:h(g.DALTON,{per:g.GRAM}),unit:g.INVERSE_MOLE},PERMITTIVITY_OF_FREE_SPACE:{value:8.854187e-12,unit:g.FARADS_PER_METER}},k,l;j.COULOMB_CONSTANT={value:1/(4*Math.PI*j.PERMITTIVITY_OF_FREE_SPACE.value),unit:g.METERS_PER_FARAD},c.unit=g,c.ratio=h,c.convert=i;for(k in j)j.hasOwnProperty(k)&&(l=j[k],c[k]=function(a){return{as:function(b){return f.convert(a.value,{from:a.unit,to:b})}}}(l))}),require.define("/constants/units.js",function(a,b,c,d,e){var f=1.66054e-27,g=1.602177e-19,h=g,i=1e-15,j=1e-9,k=10,l=1e3,m={TIME:"time",LENGTH:"length",MASS:"mass",ENERGY:"energy",ENTROPY:"entropy",CHARGE:"charge",INVERSE_QUANTITY:"inverse quantity",FARADS_PER_METER:"farads per meter",METERS_PER_FARAD:"meters per farad",FORCE:"force",VELOCITY:"velocity",AREA:"area",PRESSURE:"pressure"},n,o,p;c.unit=n={FEMTOSECOND:{name:"femtosecond",value:1,type:m.TIME},SECOND:{name:"second",value:i,type:m.TIME},NANOMETER:{name:"nanometer",value:1,type:m.LENGTH},ANGSTROM:{name:"Angstrom",value:1*k,type:m.LENGTH},METER:{name:"meter",value:1*j,type:m.LENGTH},DALTON:{name:"Dalton",value:1,type:m.MASS},GRAM:{name:"gram",value:1*f*l,type:m.MASS},KILOGRAM:{name:"kilogram",value:1*f,type:m.MASS},MW_ENERGY_UNIT:{name:"MW Energy Unit (Dalton * nm^2 / fs^2)",value:1,type:m.ENERGY},JOULE:{name:"Joule",value:f*j*j*(1/i)*(1/i),type:m.ENERGY},EV:{name:"electron volt",value:f*j*j*(1/i)*(1/i)*(1/h),type:m.ENERGY},EV_PER_KELVIN:{name:"electron volts per Kelvin",value:1,type:m.ENTROPY},JOULES_PER_KELVIN:{name:"Joules per Kelvin",value:1*h,type:m.ENTROPY},ELEMENTARY_CHARGE:{name:"elementary charge",value:1,type:m.CHARGE},COULOMB:{name:"Coulomb",value:g,type:m.CHARGE},INVERSE_MOLE:{name:"inverse moles",value:1,type:m.INVERSE_QUANTITY},FARADS_PER_METER:{name:"Farads per meter",value:1,type:m.FARADS_PER_METER},METERS_PER_FARAD:{name:"meters per Farad",value:1,type:m.METERS_PER_FARAD},MW_FORCE_UNIT:{name:"MW force units (Dalton * nm / fs^2)",value:1,type:m.FORCE},NEWTON:{name:"Newton",value:1*f*j*(1/i)*(1/i),type:m.FORCE},MW_VELOCITY_UNIT:{name:"MW velocity units (nm / fs)",value:1,type:m.VELOCITY},METERS_PER_SECOND:{name:"meters per second",value:1*j*(1/i),type:m.VELOCITY}},c.ratio=o=function(a,b){var c=function(a,b){if(a.type!==b.type)throw new Error("Attempt to convert incompatible type '"+a.name+"'' to '"+b.name+"'")};if(b.per)return c(a,b.per),a.value/b.per.value;if(b.as)return c(a,b.as),b.as.value/a.value;throw new Error("units.ratio() received arguments it couldn't understand.")},c.convert=p=function(a,b){var c=b&&b.from,d=b&&b.to;if(!c)throw new Error('units.convert() did not receive a "from" argument');if(!d)throw new Error('units.convert() did not receive a "to" argument');return a*o(d,{per:c})}}),require.define("/math/index.js",function(a,b,c,d,e){c.normal=a("./distributions").normal,c.getWindowedAverager=a("./utils").getWindowedAverager}),require.define("/math/distributions.js",function(a,b,c,d,e){c.normal=function(){var a=null;return function(b,c){b==null&&(b=0),c==null&&(c=1);var d,e,f,g,h;return a?(e=a,a=null,e):(g=Math.random(),h=Math.random(),f=2*Math.PI*g,d=Math.sqrt(-2*Math.log(h)),a=b+c*d*Math.sin(f),b+c*d*Math.cos(f))}}()}),require.define("/math/utils.js",function(a,b,c,d,e){c.getWindowedAverager=function(a){a==null&&(a=1e3);var b=0,c=[],d=0;return function(e){return d-=c[b]||0,d+=e,c[b]=e,++b===a&&(b=0),c.length===a?d/a:NaN}}}),require.define("/potentials/index.js",function(a,b,c,d,e){var f=c.potentials={};c.coulomb=a("./coulomb"),c.makeLennardJonesCalculator=a("./lennard-jones").makeLennardJonesCalculator}),require.define("/potentials/coulomb.js",function(a,b,c,d,e){var f=a("../constants"),g=f.unit,h=f.COULOMB_CONSTANT.as(f.unit.METERS_PER_FARAD),i=f.ratio(g.NANOMETER,{per:g.METER}),j=Math.pow(f.ratio(g.COULOMB,{per:g.ELEMENTARY_CHARGE}),2),k=f.ratio(g.EV,{per:g.JOULE}),l=f.ratio(g.MW_FORCE_UNIT,{per:g.NEWTON}),m=h*j*i*k,n=h*j*i*i*l,o=c.potential=function(a,b,c){return m*(b*c/a)},p=c.forceFromSquaredDistance=function(a,b,c){return-n*(b*c/a)},q=c.forceOverDistanceFromSquaredDistance=function(a,b,c){return p(a,b,c)/Math.sqrt(a)},r=c.force=function(a,b,c){return p(a*a,b,c)}}),require.define("/potentials/lennard-jones.js",function(a,b,c,d,e){var f=a("../constants"),g=f.unit,h=f.ratio(g.NANOMETER,{per:g.METER}),i=f.ratio(g.MW_FORCE_UNIT,{per:g.NEWTON});c.makeLennardJonesCalculator=function(a,b){var c,d,e,j,k,l,m,n=function(a,n){arguments.length&&(c=a,d=n,e=Math.pow(2,1/6)*d,j=4*c*Math.pow(d,12),k=4*c*Math.pow(d,6),l=12*f.convert(j,{from:g.EV,to:g.JOULE})*h*i,m=6*f.convert(k,{from:g.EV,to:g.JOULE})*h*i);var o={epsilon:c,sigma:d,rmin:e};return typeof b=="function"&&b(o,this),o},o=function(a){return j*Math.pow(a,-6)-k*Math.pow(a,-3)+c},p=function(a){var b=1/a,c=b*b*b,d=c*b,e=d*c;return l*e-m*d};return n(a.epsilon,a.sigma),{coefficients:n,setEpsilon:function(a){return n(a,d)},setSigma:function(a){return n(c,a)},potentialFromSquaredDistance:o,potential:function(a){return o(a*a)},forceOverDistanceFromSquaredDistance:p,force:function(a){return a*p(a*a)}}}}),require.define("/md2d.js",function(a,b,c,d,e){typeof window=="undefined"&&(window={});var f=a("./arrays/arrays").arrays,g=a("./constants"),h=g.unit,i=a("./math"),j=a("./potentials").coulomb,k=a("./potentials").makeLennardJonesCalculator,l=!0,m=function(){try{new Float32Array}catch(a){return!1}return!0}(),n=-120*g.BOLTZMANN_CONSTANT.as(h.EV_PER_KELVIN),o=.34,p=39.95,q=g.convert(p,{from:h.DALTON,to:h.KILOGRAM}),r=g.BOLTZMANN_CONSTANT.as(h.JOULES_PER_KELVIN),s,t,u=function(a,b,c,d){return a*d-b*c},v=function(a,b){return a*a+b*b},w=function(){},x=function(a,b){var c=2*b-3,d=2/c*a,e=g.convert(d,{from:h.MW_ENERGY_UNIT,to:h.JOULE});return e/r};c.INDICES=t={RADIUS:0,PX:1,PY:2,X:3,Y:4,VX:5,VY:6,SPEED:7,AX:8,AY:9,MASS:10,CHARGE:11},c.NODE_PROPERTIES_COUNT=s=12,c.makeModel=function(){var a,b=!1,c=!1,d=!1,e=!0,q=!1,r=!1,w=100,y=.001,z=[10,10],A,B,C,D,E=0,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ba,bb,bc,bd,be=window.state={},bf,bg,bh=function(a){bf=a.rmin*5,bg=bf*bf},bi=window.lennardJones=k({epsilon:n,sigma:o},bh),bj,bk=function(){return d?1e3:1e3},bl=function(){r=!0,bj=i.getWindowedAverager(bk())},bm=function(){var a=0,b;for(b=0;b<H;b++)a+=T[b]*(O[b]*O[b]+P[b]*P[b]);return x(a/2,H)},bn=function(a,b){O[a]*=b,P[a]*=b},bo=function(a,b,c){O[a]+=b,P[a]+=c},bp=function(a,b){O[a]-=b*(N[a]-X),P[a]+=b*(M[a]-W)},bq=function(){for(var a=0;a<H;a++)bo(a,-$,-_),bp(a,-bc)},br=function(){for(var a=0;a<H;a++)bo(a,$,_),bp(a,bc)},bs=function(){var a=0,b=0,c=0,d=0,e;for(e=0;e<H;e++)a+=M[e],b+=N[e],c+=K[e],d+=L[e];W=a/H,X=b/H,Y=c,Z=d,$=c/I,_=d/I},bt=function(){var a=0,b=0,c;for(c=0;c<H;c++)a+=T[c]*u(M[c]-W,N[c]-X,O[c]-$,P[c]-_),b+=T[c]*v(M[c]-W,N[c]-X);ba=a,bb=b,bc=ba/bb},bu=function(){bs(),bt()},bv=function(a){M[a]+=O[a]*F+.5*R[a]*G,N[a]+=P[a]*F+.5*S[a]*G},bw=function(a){M[a]<D?(M[a]=D+(D-M[a]),O[a]*=-1):M[a]>B&&(M[a]=B-(M[a]-B),O[a]*=-1),N[a]<C?(N[a]=C+(C-N[a]),P[a]*=-1):N[a]>A&&(N[a]=A-(N[a]-A),P[a]*=-1)},bx=function(a){O[a]+=.5*R[a]*F,K[a]=T[a]*O[a],P[a]+=.5*S[a]*F,L[a]=T[a]*P[a]},by=function(a){var b,c,f,g,h,i,k,l,m=1/T[a],n=U[a];for(b=0;b<a;b++)c=M[b]-M[a],f=N[b]-N[a],g=c*c+f*f,h=0,e&&g<bg&&(h+=bi.forceOverDistanceFromSquaredDistance(g)),d&&(h+=j.forceOverDistanceFromSquaredDistance(g,n,U[b])),h&&(i=h*m,k=i*c,l=i*f,R[a]+=k,S[a]+=l,R[b]-=k,S[b]-=l)},bz=function(){var a,b;bq(),bd=bm(),r&&Math.abs(bj(bd)-w)<=w*y&&(r=!1);if(r||q&&bd>0){a=Math.sqrt(w/bd);for(b=0;b<H;b++)bn(b,a);bd=w}br()};return a={outputState:be,useCoulombInteraction:function(a){a!==d&&(d=a,bl())},useLennardJonesInteraction:function(a){a!==e&&(e=a,e&&bl())},useThermostat:function(a){q=a},setTargetTemperature:function(a){a!==w&&(w=a,bl()),w=a},setSize:function(a){if(b)throw new Error("The molecular model's size has already been set, and cannot be reset.");z=[a[0],a[1]]},getSize:function(){return[z[0],z[1]]},setLJEpsilon:function(a){bi.setEpsilon(a)},getLJEpsilon:function(){return bi.coefficients().epsilon},setLJSigma:function(a){bi.setSigma(a)},getLJSigma:function(){return bi.coefficients().sigma},getLJCalculator:function(){return bi},createNodes:function(d){if(c)throw new Error("md2d: createNodes was called even though the particles have already been created for this model instance.");c=!0,b=!0,d=d||{},H=d.num||50;var e=d.temperature||100,j=bi.coefficients().rmin,k=m&&l?"Float32Array":"regular",n=g.BOLTZMANN_CONSTANT.as(h.JOULES_PER_KELVIN),o,q,r,u=Math.floor(Math.sqrt(H)),v=Math.ceil(H/u),w,x,y,A,B,C,D,E;V=a.nodes=f.create(s,null,"regular"),J=a.radius=V[t.RADIUS]=f.create(H,.5*j,k),K=a.px=V[t.PX]=f.create(H,0,k),L=a.py=V[t.PY]=f.create(H,0,k),M=a.x=V[t.X]=f.create(H,0,k),N=a.y=V[t.Y]=f.create(H,0,k),O=a.vx=V[t.VX]=f.create(H,0,k),P=a.vy=V[t.VY]=f.create(H,0,k),Q=a.speed=V[t.SPEED]=f.create(H,0,k),R=a.ax=V[t.AX]=f.create(H,0,k),S=a.ay=V[t.AY]=f.create(H,0,k),T=a.mass=V[t.MASS]=f.create(H,p,k),U=a.charge=V[t.CHARGE]=f.create(H,0,k),I=a.totalMass=H*p,B=z[0]/(1+v),A=z[1]/(1+u),w=-1;for(x=1;x<=u;x++)for(y=1;y<=v;y++){w++;if(w===H)break;M[w]=y*B,N[w]=x*A,w<Math.floor(H/2)&&(o=g.convert(T[w],{from:h.DALTON,to:h.KILOGRAM}),q=Math.sqrt(2*n*e/o),r=g.convert(q,{from:h.METERS_PER_SECOND,to:h.MW_VELOCITY_UNIT}),C=i.normal(r,r/4),D=2*Math.random()*Math.PI,O[w]=C*Math.cos(D),K[w]=T[w]*O[w],P[w]=C*Math.sin(D),L[w]=T[w]*P[w],O[H-w-1]=-O[w],K[H-w-1]=T[H-w-1]*O[H-w-1],P[H-w-1]=-P[w],L[H-w-1]=T[H-w-1]*P[H-w-1]),R[w]=0,S[w]=0,Q[w]=Math.sqrt(O[w]*O[w]+P[w]*P[w]),U[w]=2*(w%2)-1}bu(),bq(),bd=bm(),E=Math.sqrt(e/bd);for(w=0;w<H;w++)bn(w,E);bd=e,br(),a.computeOutputState()},relaxToTemperature:function(a){a!=null&&(w=a),bl();while(r)this.integrate()},integrate:function(b,d){if(!c)throw new Error("md2d: integrate called before nodes created.");b==null&&(b=250),F=d||5,G=F*F,D=J[0],C=J[0],B=z[0]-J[0],A=z[1]-J[0];var e=E,f=Math.floor(b/F),g,h;for(g=1;g<=f;g++){E=e+g*F;for(h=0;h<H;h++)bv(h),bw(h),bx(h),R[h]=S[h]=0,by(h);for(h=0;h<H;h++)bx(h),Q[h]=Math.sqrt(O[h]*O[h]+P[h]*P[h]);bu(),bz()}a.computeOutputState()},computeOutputState:function(){var a,b,c,f,i,k,l;l=0,k=0;for(a=0;a<H;a++){k+=.5*T[a]*(O[a]*O[a]+P[a]*P[a]);for(b=a+1;b<H;b++)c=M[b]-M[a],f=N[b]-N[a],i=c*c+f*f,e&&(l+=-bi.potentialFromSquaredDistance(i)),d&&(l+=-j.potential(Math.sqrt(i),U[a],U[b]))}be.time=E,be.pressure=0,be.PE=l,be.KE=g.convert(k,{from:h.MW_ENERGY_UNIT,to:h.EV}),be.T=bd,be.pCM=[Y,Z],be.CM=[W,X],be.vCM=[$,_],be.omega_CM=bc}}}}),require("/md2d.js"),function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),molecules_coulomb={},molecules_coulomb={version:"0.0.1"};var a=-50;molecules_coulomb.force=function(b,c,d){return a*(c*d/(b*b))},molecules_coulomb.potential=function(b,c,d){return-a*(c*d/b)},molecules_lennard_jones={},molecules_lennard_jones={version:"0.0.1"};var b=-1,c=4,d=Math.pow(2,1/6)*c,e=4*b*Math.pow(c,12),f=4*b*Math.pow(c,6);molecules_lennard_jones.epsilon=function(a){return molecules_lennard_jones.coefficients(a,c)},molecules_lennard_jones.sigma=function(a){return molecules_lennard_jones.coefficients(b,a)},molecules_lennard_jones.coefficients=function(a,g){arguments.length&&(b=a,c=g,d=Math.pow(2,1/6)*c,e=4*b*Math.pow(c,12),f=4*b*Math.pow(c,6));var h={epsilon:b,sigma:c,rmin:d,alpha:e,beta:f};return h},molecules_lennard_jones.potential=function(a){return(e/Math.pow(a,12)-f/Math.pow(a,6))*-1},molecules_lennard_jones.force=function(a){var b=Math.pow(a,6),c=b*a,d=b*c;return 12*e/d-6*f/c};var g=require("./md2d"),h;modeler={},modeler.VERSION="0.2.0",modeler.model=function(){function N(a){return 5+a*1995/25}function O(){var a,b=0,c=L[0].length;a=-1;while(++a<c)b+=F[a];return b/c}function P(){return m===0}function Q(){var a,b=[],c=K;a=-1;while(++a<c)b[a]=arrays.clone(L[a]);l.length=m,m++,n++,o=!0,l.push({nodes:b,ke:j}),m>1e3&&(l.splice(0,1),m=1e3)}function R(){var a;return P()&&Q(),h.integrate(),r=w.pressure,i=w.PE,s.push(r),s.splice(0,s.length-16),j=w.KE,Q(),k||(a=Date.now(),t?(t=a-t,t&&u.push(t),t=a,u.splice(0,u.length-128)):t=a,c.tick({type:"tick"})),k}function S(){l=[],m=0,n=-1}function T(){l.length=m+1}function U(a){var b,c=K;if(a<0)throw new Error("modeler: request for tick_history_list["+a+"]");if(a>=l.length)throw new Error("modeler: request for tick_history_list["+a+"], tick_history_list.length="+l.length);b=-1;while(++b<c)arrays.copy(l[a].nodes[b],L[b]);j=l[a].ke}function V(){return s.reduce(function(a,b){return a+b})/s.length}function W(a){if(!arguments.length)return W.reduce(function(a,b){return a+b})/s.length;W.push(a),W.splice(0,W.length-100)}function X(){var a,b,c=0,d=u.length;a=-1;while(++a<d)c+=u[a];return b=c/d,b?1/b*1e3:0}function Y(a){v=a,h.setTargetTemperature(N(a))}function _(a){$.unique(a);for(var b=0,c=a.length;b<c;b++)a[b]()}var a={},b=[],c=d3.dispatch("tick"),d,e,f,i,j,k=!0,l=[],m=0,n=0,o=!1,p,q,r,s=[0],t,u=[],v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=12,L,M;a.INDICES={RADIUS:g.INDICES.RADIUS,PX:g.INDICES.PX,PY:g.INDICES.PY,X:g.INDICES.X,Y:g.INDICES.Y,VX:g.INDICES.VX,VY:g.INDICES.VY,SPEED:g.INDICES.SPEED,AX:g.INDICES.AX,AY:g.INDICES.AY,MASS:g.INDICES.MASS,CHARGE:g.INDICES.CHARGE},a.getStats=function(){return{speed:O(),ke:j,temperature:v,pressure:V(),current_step:n,steps:l.length-1}},a.stepCounter=function(){return n},a.steps=function(){return P()?0:l.length-1},a.isNewStep=function(){return o},a.seek=function(a){return arguments.length||(a=0),k=!0,o=!1,m=a,n=a,U(m),n},a.stepBack=function(a){arguments.length||(a=1);var b=-1;k=!0,o=!1;while(++b<a)m>1&&(m--,n--,U(m-1),x&&x());return n},a.stepForward=function(a){arguments.length||(a=1);var b=-1;k=!0;while(++b<a)m<l.length?(U(m),m++,n++,x&&x()):(R(),x&&x());return n},a.set_lj_coefficients=function(a,b){p=a,q=b},a.setEpsilon=function(a){h.setLJEpsilon(a)},a.setSigma=function(a){h.setLJSigma(a)},a.getEpsilon=function(){return h.getLJEpsilon()},a.getSigma=function(){return h.getLJSigma()},a.getLJCalculator=function(){return h.getLJCalculator()},a.set_radius=function(a){},a.get_speed=function(){return arrays.copy(F,[])},a.get_rate=function(){return X()},a.is_stopped=function(){return k},a.set_temperature_control=function(a){d=a,h.useThermostat(a)},a.set_lennard_jones_forces=function(a){e=a,h.useLennardJonesInteraction(a)},a.set_coulomb_forces=function(a){f=a,h.useCoulombInteraction(a)},a.get_nodes=function(){return L},a.get_atoms=function(){return b},a.initialize=function(b){return b=b||{},b.temperature!=null&&(b.temperature=N(b.temperature)),e=b.lennard_jones_forces||!0,f=b.coulomb_forces||!1,d=b.temperature_control||!1,x=b.model_listener||!1,S(),o=!0,h.useLennardJonesInteraction(e),h.useCoulombInteraction(f),h.useThermostat(d),h.setTargetTemperature(b.temperature),a},a.relax=function(){return h.integrate(50),h.relaxToTemperature(),a},a.on=function(b,d){return c.on(b,d),a},a.tickInPlace=function(){return c.tick({type:"tick"}),a},a.tick=function(b){arguments.length||(b=1);var c=-1;while(++c<b)R();return a},a.nodes=function(c){return c=c||{},c.temperature!=null&&(c.temperature=N(c.temperature)),h=g.makeModel(),h.createNodes(c),L=h.nodes,y=h.radius,z=h.px,A=h.py,B=h.x,C=h.y,D=h.vx,E=h.vy,F=h.speed,G=h.ax,H=h.ay,I=h.mass,J=h.charge,w=h.outputState,b.length=L[0].length,a},a.start=function(){return a.initialize(),a.resume()},a.resume=function(){return k=!1,d3.timer(R),a},a.stop=function(){return k=!0,a},a.ke=function(){return w?w.KE:undefined},a.ave_ke=function(){return w?w.KE/L[0].length:undefined},a.pe=function(){return w?w.PE:undefined},a.ave_pe=function(){return w?w.PE/L[0].length:undefined},a.speed=function(){return O()},a.pressure=function(){return V()},a.temperature=function(b){return arguments.length?(Y(b),a):v},a.size=function(b){return arguments.length?(h.setSize(b),a):h.getSize()};var Z={};return M={temperature:3,coulomb_forces:!1,epsilon:-0.1,set_temperature:function(a){this.temperature=a,v=a,h.setTargetTemperature(N(a))},set_coulomb_forces:function(a){this.coulomb_forces=a,f=a,h.useCoulombInteraction(a),molecule_container.setup_particles()},set_epsilon:function(a){this.epsilon=a,h.setLJEpsilon(a)}},a.set=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&M["set_"+c]&&M["set_"+c](a[c]),Z[c]&&(b=b.concat(Z[c]));_(b)},a.get=function(a){return M[a]},a.addPropertiesListener=function(a,b){var c,d,e;for(c=0,d=a.length;c<d;c++){var e=a[c];Z[e]||(Z[e]=[]),Z[e].push(b)}},a.serialize=function(){return JSON.stringify(M)},a}}();