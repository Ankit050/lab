var require=function(a,b){var c=require.resolve(a,b||"/"),d=require.modules[c];if(!d)throw new Error("Failed to resolve module "+a+", tried "+c);var e=d._cached?d._cached:d();return e};require.paths=[],require.modules={},require.extensions=[".js",".coffee"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(a,b){function g(a){if(require.modules[a])return a;for(var b=0;b<require.extensions.length;b++){var c=require.extensions[b];if(require.modules[a+c])return a+c}}function h(a){a=a.replace(/\/+$/,"");var b=a+"/package.json";if(require.modules[b]){var d=require.modules[b](),e=d.browserify;if(typeof e=="object"&&e.main){var f=g(c.resolve(a,e.main));if(f)return f}else if(typeof e=="string"){var f=g(c.resolve(a,e));if(f)return f}else if(d.main){var f=g(c.resolve(a,d.main));if(f)return f}}return g(a+"/index")}function i(a,b){var c=j(b);for(var d=0;d<c.length;d++){var e=c[d],f=g(e+"/"+a);if(f)return f;var i=h(e+"/"+a);if(i)return i}var f=g(a);if(f)return f}function j(a){var b;a==="/"?b=[""]:b=c.normalize(a).split("/");var d=[];for(var e=b.length-1;e>=0;e--){if(b[e]==="node_modules")continue;var f=b.slice(0,e+1).join("/")+"/node_modules";d.push(f)}return d}b||(b="/");if(require._core[a])return a;var c=require.modules.path();b=c.resolve("/",b);var d=b||"/";if(a.match(/^(?:\.\.?\/|\/)/)){var e=g(c.resolve(d,a))||h(c.resolve(d,a));if(e)return e}var f=i(a,d);if(f)return f;throw new Error("Cannot find module '"+a+"'")}}(),require.alias=function(a,b){var c=require.modules.path(),d=null;try{d=require.resolve(a+"/package.json","/")}catch(e){d=require.resolve(a,"/")}var f=c.dirname(d),g=(Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b})(require.modules);for(var h=0;h<g.length;h++){var i=g[h];if(i.slice(0,f.length+1)===f+"/"){var j=i.slice(f.length);require.modules[b+j]=require.modules[f+j]}else i===f&&(require.modules[b]=require.modules[f])}},require.define=function(a,b){var c=require._core[a]?"":require.modules.path().dirname(a),d=function(a){return require(a,c)};d.resolve=function(a){return require.resolve(a,c)},d.modules=require.modules,d.define=require.define;var e={exports:{}};require.modules[a]=function(){return require.modules[a]._cached=e.exports,b.call(e.exports,d,e,e.exports,c,a),require.modules[a]._cached=e.exports,e.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var a=[],b=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return b&&window.addEventListener("message",function(b){if(b.source===window&&b.data==="browserify-tick"){b.stopPropagation();if(a.length>0){var c=a.shift();c()}}},!0),function(c){b?(a.push(c),window.postMessage("browserify-tick","*")):setTimeout(c,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(a){if(a==="evals")return require("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),require.define("path",function(a,b,c,d,e){function f(a,b){var c=[];for(var d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}function g(a,b){var c=0;for(var d=a.length;d>=0;d--){var e=a[d];e=="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}var h=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;c.resolve=function(){var a="",b=!1;for(var c=arguments.length;c>=-1&&!b;c--){var d=c>=0?arguments[c]:process.cwd();if(typeof d!="string"||!d)continue;a=d+"/"+a,b=d.charAt(0)==="/"}return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),(b?"/":"")+a||"."},c.normalize=function(a){var b=a.charAt(0)==="/",c=a.slice(-1)==="/";return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),!a&&!b&&(a="."),a&&c&&(a+="/"),(b?"/":"")+a},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(f(a,function(a,b){return a&&typeof a=="string"}).join("/"))},c.dirname=function(a){var b=h.exec(a)[1]||"",c=!1;return b?b.length===1||c&&b.length<=3&&b.charAt(1)===":"?b:b.substring(0,b.length-1):"."},c.basename=function(a,b){var c=h.exec(a)[2]||"";return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return h.exec(a)[3]||""}}),require.define("/arrays/arrays.js",function(a,b,c,d,e){var f;f=c.arrays={},f.version="0.0.1",f.webgl=typeof window!="undefined"&&!!window.WebGLRenderingContext,f.typed=!1;try{var g=new Float64Array(0);f.typed=!0}catch(h){}f.create=function(a,b,c){c||(f.webgl||f.typed?c="Float32Array":c="regular"),b=b||0;var d,e;if(c==="regular")d=new Array(a);else switch(c){case"Float64Array":d=new Float64Array(a);break;case"Float32Array":d=new Float32Array(a);break;case"Int32Array":d=new Int32Array(a);break;case"Int16Array":d=new Int16Array(a);break;case"Int8Array":d=new Int8Array(a);break;case"Uint32Array":d=new Uint32Array(a);break;case"Uint16Array":d=new Uint16Array(a);break;case"Uint8Array":d=new Uint8Array(a);break;default:d=new Array(a)}e=-1;while(++e<a)d[e]=b;return d},f.constructor_function=function(a){if(a.buffer&&a.buffer.__proto__.constructor)return a.__proto__.constructor;if(a.constructor===Array)return a.constructor;throw new Error("arrays.constructor_function: must be an Array or Typed Array:   source: "+a+", source.constructor: "+a.constructor+", source.buffer: "+a.buffer+", source.buffer.slice: "+a.buffer.slice+", source.buffer.__proto__: "+a.buffer.__proto__+", source.buffer.__proto__.constructor: "+a.buffer.__proto__.constructor)},f.copy=function(a,b){var c=a.length,d=-1;while(++d<c)b[d]=a[d];return b.length=c,b},f.clone=function(a){var b,c=a.length,d,e;e=f.constructor_function(a);if(e===Array){d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d}if(a.buffer.slice)return d=new e(a.buffer.slice(0)),d;d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d},f.between=function(a,b,c){return c<Math.max(a,b)&&c>Math.min(a,b)},f.max=function(a){return Math.max.apply(Math,a)},f.min=function(a){return Math.min.apply(Math,a)},f.maxTypedArray=function(a){var b,c,d=Number.MIN_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b>d?b:d;return d},f.minTypedArray=function(a){var b,c,d=Number.MAX_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b<d?b:d;return d},f.maxAnyArray=function(a){try{return Math.max.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MIN_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c>e?c:e;return e}}},f.minAnyArray=function(a){try{return Math.min.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MAX_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c<e?c:e;return e}}},f.average=function(a){var b,c=0,d=a.length;for(b=0;b<d;b++)c+=a[b];return c/d}}),require.define("/constants/index.js",function(a,b,c,d,e){var f=a("./units"),g=f.unit,h=f.ratio,i=f.convert,j={ELEMENTARY_CHARGE:{value:1,unit:g.ELEMENTARY_CHARGE},ATOMIC_MASS:{value:1,unit:g.DALTON},BOLTZMANN_CONSTANT:{value:1.380658e-23,unit:g.JOULES_PER_KELVIN},AVAGADRO_CONSTANT:{value:h(g.DALTON,{per:g.GRAM}),unit:g.INVERSE_MOLE},PERMITTIVITY_OF_FREE_SPACE:{value:8.854187e-12,unit:g.FARADS_PER_METER}},k,l;j.COULOMB_CONSTANT={value:1/(4*Math.PI*j.PERMITTIVITY_OF_FREE_SPACE.value),unit:g.METERS_PER_FARAD},c.unit=g,c.ratio=h,c.convert=i;for(k in j)j.hasOwnProperty(k)&&(l=j[k],c[k]=function(a){return{as:function(b){return f.convert(a.value,{from:a.unit,to:b})}}}(l))}),require.define("/constants/units.js",function(a,b,c,d,e){var f=1.66054e-27,g=1.602177e-19,h=g,i=1e-15,j=1e-9,k=10,l=1e3,m={TIME:"time",LENGTH:"length",MASS:"mass",ENERGY:"energy",ENTROPY:"entropy",CHARGE:"charge",INVERSE_QUANTITY:"inverse quantity",FARADS_PER_METER:"farads per meter",METERS_PER_FARAD:"meters per farad",FORCE:"force",VELOCITY:"velocity",AREA:"area",PRESSURE:"pressure"},n,o,p;c.unit=n={FEMTOSECOND:{name:"femtosecond",value:1,type:m.TIME},SECOND:{name:"second",value:i,type:m.TIME},NANOMETER:{name:"nanometer",value:1,type:m.LENGTH},ANGSTROM:{name:"Angstrom",value:1*k,type:m.LENGTH},METER:{name:"meter",value:1*j,type:m.LENGTH},DALTON:{name:"Dalton",value:1,type:m.MASS},GRAM:{name:"gram",value:1*f*l,type:m.MASS},KILOGRAM:{name:"kilogram",value:1*f,type:m.MASS},MW_ENERGY_UNIT:{name:"MW Energy Unit (Dalton * nm^2 / fs^2)",value:1,type:m.ENERGY},JOULE:{name:"Joule",value:f*j*j*(1/i)*(1/i),type:m.ENERGY},EV:{name:"electron volt",value:f*j*j*(1/i)*(1/i)*(1/h),type:m.ENERGY},EV_PER_KELVIN:{name:"electron volts per Kelvin",value:1,type:m.ENTROPY},JOULES_PER_KELVIN:{name:"Joules per Kelvin",value:1*h,type:m.ENTROPY},ELEMENTARY_CHARGE:{name:"elementary charge",value:1,type:m.CHARGE},COULOMB:{name:"Coulomb",value:g,type:m.CHARGE},INVERSE_MOLE:{name:"inverse moles",value:1,type:m.INVERSE_QUANTITY},FARADS_PER_METER:{name:"Farads per meter",value:1,type:m.FARADS_PER_METER},METERS_PER_FARAD:{name:"meters per Farad",value:1,type:m.METERS_PER_FARAD},MW_FORCE_UNIT:{name:"MW force units (Dalton * nm / fs^2)",value:1,type:m.FORCE},NEWTON:{name:"Newton",value:1*f*j*(1/i)*(1/i),type:m.FORCE},MW_VELOCITY_UNIT:{name:"MW velocity units (nm / fs)",value:1,type:m.VELOCITY},METERS_PER_SECOND:{name:"meters per second",value:1*j*(1/i),type:m.VELOCITY}},c.ratio=o=function(a,b){var c=function(a,b){if(a.type!==b.type)throw new Error("Attempt to convert incompatible type '"+a.name+"'' to '"+b.name+"'")};if(b.per)return c(a,b.per),a.value/b.per.value;if(b.as)return c(a,b.as),b.as.value/a.value;throw new Error("units.ratio() received arguments it couldn't understand.")},c.convert=p=function(a,b){var c=b&&b.from,d=b&&b.to;if(!c)throw new Error('units.convert() did not receive a "from" argument');if(!d)throw new Error('units.convert() did not receive a "to" argument');return a*o(d,{per:c})}}),require.define("/math/index.js",function(a,b,c,d,e){c.normal=a("./distributions").normal,c.getWindowedAverager=a("./utils").getWindowedAverager}),require.define("/math/distributions.js",function(a,b,c,d,e){c.normal=function(){var a=null;return function(b,c){b==null&&(b=0),c==null&&(c=1);var d,e,f,g,h;return a?(e=a,a=null,e):(g=Math.random(),h=Math.random(),f=2*Math.PI*g,d=Math.sqrt(-2*Math.log(h)),a=b+c*d*Math.sin(f),b+c*d*Math.cos(f))}}()}),require.define("/math/utils.js",function(a,b,c,d,e){c.getWindowedAverager=function(a){a==null&&(a=1e3);var b=0,c=[],d=0;return function(e){return d-=c[b]||0,d+=e,c[b]=e,++b===a&&(b=0),c.length===a?d/a:NaN}}}),require.define("/potentials/index.js",function(a,b,c,d,e){var f=c.potentials={};c.coulomb=a("./coulomb"),c.getLennardJonesCalculator=a("./lennard-jones").getLennardJonesCalculator}),require.define("/potentials/coulomb.js",function(a,b,c,d,e){var f=a("../constants"),g=f.unit,h=f.COULOMB_CONSTANT.as(f.unit.METERS_PER_FARAD),i=f.ratio(g.NANOMETER,{per:g.METER}),j=Math.pow(f.ratio(g.COULOMB,{per:g.ELEMENTARY_CHARGE}),2),k=f.ratio(g.EV,{per:g.JOULE}),l=f.ratio(g.MW_FORCE_UNIT,{per:g.NEWTON}),m=h*j*i*k,n=h*j*i*i*l,o=c.potential=function(a,b,c){return-m*(b*c/a)},p=c.forceFromSquaredDistance=function(a,b,c){return-n*(b*c/a)},q=c.force=function(a,b,c){return p(a*a)}}),require.define("/potentials/lennard-jones.js",function(a,b,c,d,e){var f=a("../constants"),g=f.unit,h=f.ratio(g.NANOMETER,{per:g.METER}),i=f.ratio(g.MW_FORCE_UNIT,{per:g.NEWTON});c.getLennardJonesCalculator=function(a){var b=-1,c=4,d,e,j,k,l,m=function(m,n){arguments.length&&(b=m,c=n,d=Math.pow(2,1/6)*c,e=4*b*Math.pow(c,12),j=4*b*Math.pow(c,6),k=12*f.convert(e,{from:g.EV,to:g.JOULE})*h*i,l=6*f.convert(j,{from:g.EV,to:g.JOULE})*h*i);var o={epsilon:b,sigma:c,rmin:d};return typeof a=="function"&&a(o),o},n=function(a){return e*Math.pow(a,-6)+j*Math.pow(a,-3)-b},o=function(a){var b=1/a,c=b*b*b,d=c*b,e=d*c;return k*e-l*d};return m(b,c),{coefficients:m,setEpsilon:function(a){return m(a,c)},setSigma:function(a){return m(b,a)},potentialFromSquaredDistance:n,potential:function(a){return n(a*a)},forceOverDistanceFromSquaredDistance:o,force:function(a){return a*o(a*a)}}}}),require.define("/md2d.js",function(a,b,c,d,e){typeof window=="undefined"&&(window={});var f=c.model={},g=a("./arrays/arrays").arrays,h=a("./constants"),i=h.unit,j=a("./math"),k=a("./potentials").coulomb,l=window.lennardJones=a("./potentials").getLennardJonesCalculator(),m=-120*h.BOLTZMANN_CONSTANT.as(i.EV_PER_KELVIN),n=.34,o=39.95,p=h.convert(o,{from:i.DALTON,to:i.KILOGRAM}),q=h.BOLTZMANN_CONSTANT.as(i.JOULES_PER_KELVIN),r,s=!0,t,u,v=!0,w=function(){try{new Float32Array}catch(a){return!1}return!0}(),x=-Infinity,y,z=[10,10],A,B,C,D,E,F,G,H,I,J,K,L,M,N=12,O,P=0,Q=1,R=2,S=3,T=4,U=5,V=6,W=7,X=8,Y=9,Z=10,$=11;f.INDICES={RADIUS:P,PX:Q,PY:R,X:S,Y:T,VX:U,VY:V,SPEED:W,AX:X,AY:Y,MASS:Z,CHARGE:$},l.setEpsilon(m),l.setSigma(n),f.setSize=function(a){},f.setLJEpsilon=function(a){l.setEpsilon(a),s=!0},f.setLJSigma=function(a){l.setSigma(a),s=!0},f.getLJEpsilon=function(){return l.coefficients().epsilon},f.getLJSigma=function(){return l.coefficients().sigma},f.getLJCalculator=function(){return l},t=function(){y=l.coefficients().rmin*5,s=!1},u=function(){},f.createNodes=function(a){a=a||{};var b=a.num||50,c=a.temperature||100,d=l.coefficients().rmin,e=.5,k=w&&v?"Float32Array":"regular",m=h.BOLTZMANN_CONSTANT.as(i.JOULES_PER_KELVIN),n,p,q,r,s,t,u,x,y,P,Q,R,S=0,T=0,U,V;u=Math.floor(Math.sqrt(b)),x=Math.ceil(b/u),f.nodes=O=g.create(N,null,"regular"),O[f.INDICES.RADIUS]=g.create(b,d*e,k),f.radius=A=O[f.INDICES.RADIUS],O[f.INDICES.PX]=g.create(b,0,k),f.px=B=O[f.INDICES.PX],O[f.INDICES.PY]=g.create(b,0,k),f.py=C=O[f.INDICES.PY],O[f.INDICES.X]=g.create(b,0,k),f.x=D=O[f.INDICES.X],O[f.INDICES.Y]=g.create(b,0,k),f.y=E=O[f.INDICES.Y],O[f.INDICES.VX]=g.create(b,0,k),f.vx=F=O[f.INDICES.VX],O[f.INDICES.VY]=g.create(b,0,k),f.vy=G=O[f.INDICES.VY],O[f.INDICES.SPEED]=g.create(b,0,k),f.speed=H=O[f.INDICES.SPEED],O[f.INDICES.AX]=g.create(b,0,k),f.ax=I=O[f.INDICES.AX],O[f.INDICES.AY]=g.create(b,0,k),f.ay=J=O[f.INDICES.AY],O[f.INDICES.MASS]=g.create(b,o,k),f.mass=K=O[f.INDICES.MASS],M=f.totalMass=o*b,O[f.INDICES.CHARGE]=g.create(b,0,k),f.charge=L=O[f.INDICES.CHARGE],P=z[0]/(1+x),y=z[1]/(1+u),console.log("initializing to temp",c),r=-1;for(s=1;s<=u;s++)for(t=1;t<=x;t++){r++;if(r===b)break;D[r]=t*P,E[r]=s*y,r<Math.floor(b/2)&&(n=h.convert(K[r],{from:i.DALTON,to:i.KILOGRAM}),p=Math.sqrt(2*m*c/n),q=h.convert(p,{from:i.METERS_PER_SECOND,to:i.MW_VELOCITY_UNIT}),Q=j.normal(q,q/4),R=2*Math.random()*Math.PI,F[r]=Q*Math.cos(R),G[r]=Q*Math.sin(R),F[b-r-1]=-F[r],G[b-r-1]=-G[r]),S+=F[r]*K[r],T+=G[r]*K[r],I[r]=0,J[r]=0,H[r]=Math.sqrt(F[r]*F[r]+G[r]*G[r]),L[r]=2*(r%2)-1}U=S/M,V=T/M},r=function(a){var b=0,c=a.setOnceState,d=a.readWriteState,e=a.settableState||{},f=window.state={},g=c.size,m=d.ax,n=d.ay,o=d.charge,p=d.nodes,r=d.radius,u=d.speed,v=d.vx,w=d.vy,z=d.x,A=d.y,B=e.useCoulombInteraction,C=e.useLennardJonesInteraction,D=e.useThermostat,E=e.targetTemperature,F=!1,G=!1,H=function(){var a=0,b,c=p[0].length;for(b=0;b<c;b++)a+=K[b]*u[b]*u[b];return a}(),I=function(){var a=[0,0],b,c=p[0].length;for(b=0;b<c;b++)a[0]+=z[b]*K[b],a[1]+=A[b]*K[b];return a[0]=a[0]/M,a[1]=a[1]/M,a}(),J=0,L=0,N=.1,O=.001,P,Q=function(){return B?1e3:1e3},R=function(a){a==null&&(a={});var b=a.windowSize||Q();F=!0,P=j.getWindowedAverager(b)},S=function(a){var b=a/p[0].length,c=h.convert(b,{from:i.MW_ENERGY_UNIT,to:i.JOULE});return c/q};return f.time=b,{useCoulombInteraction:function(a){a!==B&&(B=a,R())},useLennardJonesInteraction:function(a){a!==C&&(C=a,C&&R())},useThermostat:function(a){D=a},setTargetTemperature:function(a){console.log("target temp = ",a),a!==E&&(E=a,R()),E=a},relaxToTemperature:function(a){a!=null&&(E=a),R(),G=!0;while(F)this.integrate();G=!1},getOutputState:function(){return f},integrate:function(a,c){a==null&&(a=500),c==null&&(c=10),s&&t();var d=b,e=Math.floor(a/c),j=c*c,q=p[0].length,Q,R,T,U,V=y*y,W=x*x,X,Y,Z,$,_,ba,bb,bc,bd=r[0],be=r[0],bf=g[0]-r[0],bg=g[1]-r[0],bh,bi,bj,bk,bl,bm,bn=S(H/2),bo;for(bc=1;bc<=e;bc++){b=d+bc*c;if(F&&Math.abs(P(bn)-E)<=E*O){F=!1;if(G)break}bo=1;if(F||D&&bn>0)bo=Math.sqrt(1+N*(E/bn-1));H=0,bi=[0,0];for(Q=0;Q<q;Q++)bo!==1&&(v[Q]*=bo,w[Q]*=bo),z[Q]+=v[Q]*c+.5*m[Q]*j,A[Q]+=w[Q]*c+.5*n[Q]*j,T=v[Q]*v[Q]+w[Q]*w[Q],u[Q]=Math.sqrt(T),z[Q]<bd?(z[Q]=bd+(bd-z[Q]),v[Q]*=-1):z[Q]>bf&&(z[Q]=bf-(z[Q]-bf),v[Q]*=-1),A[Q]<be?(A[Q]=be+(be-A[Q]),w[Q]*=-1):A[Q]>bg&&(A[Q]=bg-(A[Q]-bg),w[Q]*=-1),bi[0]+=z[Q]*K[Q],bi[1]+=A[Q]*K[Q],v[Q]+=.5*m[Q]*c,w[Q]+=.5*n[Q]*c;bi[0]/=M,bi[1]/=M;for(Q=0;Q<q;Q++)m[Q]=0,n[Q]=0;if(C||B)for(Q=0;Q<q;Q++)for(R=Q+1;R<q;R++)ba=z[R]-z[Q],bb=A[R]-A[Q],U=ba*ba+bb*bb,C&&U<V&&(Y=l.forceOverDistanceFromSquaredDistance(U),Y*Y*U>W&&(Y=x/Math.sqrt(U)),Z=Y/K[Q],$=Z*ba,_=Z*bb,m[Q]+=$,n[Q]+=_,m[R]-=$,n[R]-=_),B&&(X=k.forceFromSquaredDistance(U,o[Q],o[R]),Y=X/Math.sqrt(U),Z=Y/K[Q],$=Z*ba,_=Z*bb,m[Q]+=$,n[Q]+=_,m[R]-=$,n[R]-=_);bj=0,bk=0;for(Q=0;Q<q;Q++)v[Q]+=.5*m[Q]*c,w[Q]+=.5*n[Q]*c,bj+=K[Q]*v[Q],bk+=K[Q]*w[Q],T=v[Q]*v[Q]+w[Q]*w[Q],H+=K[Q]*T,u[Q]=Math.sqrt(T);bl=bj/M,bm=bk/M,J+=bl*c,L+=bm*c,bn=S(H/2)}bh=0;for(Q=0;Q<q;Q++)for(R=Q+1;R<q;R++)ba=z[R]-z[Q],bb=A[R]-A[Q],U=ba*ba+bb*bb,C&&(bh+=l.potentialFromSquaredDistance(U)),B&&(bh+=k.potential(Math.sqrt(U),o[Q],o[R]));f.time=b,f.pressure=0,f.PE=bh,f.KE=.5*h.convert(H,{from:i.MW_ENERGY_UNIT,to:i.EV}),f.T=bn,f.CM=bi||I,f.vCM=[bl,bm],f.driftCM=[J,L]}}},f.getIntegrator=function(a,b){a=a||{};var c=a.lennard_jones_forces||!0,d=a.coulomb_forces||!1,e=a.temperature_control||!1,f=a.temperature||1,g;return u(),g=r({setOnceState:{size:z},settableState:{useLennardJonesInteraction:c,useCoulombInteraction:d,useThermostat:e,targetTemperature:f},readWriteState:{ax:I,ay:J,charge:L,nodes:O,px:B,py:C,radius:A,speed:H,vx:F,vy:G,x:D,y:E},outputState:b}),g.integrate(0),g}}),require("/md2d.js"),function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),molecules_coulomb={},molecules_coulomb={version:"0.0.1"};var a=-50;molecules_coulomb.force=function(b,c,d){return a*(c*d/(b*b))},molecules_coulomb.potential=function(b,c,d){return-a*(c*d/b)},molecules_lennard_jones={},molecules_lennard_jones={version:"0.0.1"};var b=-1,c=4,d=Math.pow(2,1/6)*c,e=4*b*Math.pow(c,12),f=4*b*Math.pow(c,6);molecules_lennard_jones.epsilon=function(a){return molecules_lennard_jones.coefficients(a,c)},molecules_lennard_jones.sigma=function(a){return molecules_lennard_jones.coefficients(b,a)},molecules_lennard_jones.coefficients=function(a,g){arguments.length&&(b=a,c=g,d=Math.pow(2,1/6)*c,e=4*b*Math.pow(c,12),f=4*b*Math.pow(c,6));var h={epsilon:b,sigma:c,rmin:d,alpha:e,beta:f};return h},molecules_lennard_jones.potential=function(a){return(e/Math.pow(a,12)-f/Math.pow(a,6))*-1},molecules_lennard_jones.force=function(a){var b=Math.pow(a,6),c=b*a,d=b*c;return 12*e/d-6*f/c};var g=require("./md2d").model;modeler={},modeler.VERSION="0.2.0",modeler.model=function(){function N(a){return 5+a*2495/25}function O(){var a,b=0,c=M[0].length;a=-1;while(++a<c)b+=G[a];return b/c}function P(){return m===0}function Q(){var a,b=[],c=L;a=-1;while(++a<c)b[a]=arrays.clone(M[a]);l.length=m,m++,n++,o=!0,l.push({nodes:b,ke:j}),m>1e3&&(l.splice(0,1),m=1e3)}function R(){var a;return P()&&Q(),w.integrate(),r=x.pressure,i=x.PE,s.push(r),s.splice(0,s.length-16),j=x.KE,Q(),k||(a=Date.now(),t?(t=a-t,t&&u.push(t),t=a,u.splice(0,u.length-128)):t=a,c.tick({type:"tick"})),k}function S(){l=[],m=0,n=-1}function T(){l.length=m+1}function U(a){var b,c=L;if(a<0)throw new Error("modeler: request for tick_history_list["+a+"]");if(a>=l.length)throw new Error("modeler: request for tick_history_list["+a+"], tick_history_list.length="+l.length);b=-1;while(++b<c)arrays.copy(l[a].nodes[b],M[b]);j=l[a].ke}function V(){return s.reduce(function(a,b){return a+b})/s.length}function W(a){if(!arguments.length)return W.reduce(function(a,b){return a+b})/s.length;W.push(a),W.splice(0,W.length-100)}function X(){var a,b,c=0,d=u.length;a=-1;while(++a<d)c+=u[a];return b=c/d,b?1/b*1e3:0}function Y(a){v=a,w&&w.setTargetTemperature(N(a))}var a={},b=[],c=d3.dispatch("tick"),d=[100,100],e,f,h,i,j,k=!0,l=[],m=0,n=0,o=!1,p,q,r,s=[0],t,u=[],v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=12,M;return a.INDICES={RADIUS:g.INDICES.RADIUS,PX:g.INDICES.PX,PY:g.INDICES.PY,X:g.INDICES.X,Y:g.INDICES.Y,VX:g.INDICES.VX,VY:g.INDICES.VY,SPEED:g.INDICES.SPEED,AX:g.INDICES.AX,AY:g.INDICES.AY,MASS:g.INDICES.MASS,CHARGE:g.INDICES.CHARGE},g.setSize(d),a.getStats=function(){return{speed:O(),ke:j,temperature:v,pressure:V(),current_step:n,steps:l.length-1}},a.stepCounter=function(){return n},a.steps=function(){return P()?0:l.length-1},a.isNewStep=function(){return o},a.seek=function(a){return arguments.length||(a=0),k=!0,o=!1,m=a,n=a,U(m),n},a.stepBack=function(a){arguments.length||(a=1);var b=-1;k=!0,o=!1;while(++b<a)m>1&&(m--,n--,U(m-1),y&&y());return n},a.stepForward=function(a){arguments.length||(a=1);var b=-1;k=!0;while(++b<a)m<l.length?(U(m),m++,n++,y&&y()):(R(),y&&y());return n},a.set_lj_coefficients=function(a,b){p=a,q=b},a.setEpsilon=function(a){g.setLJEpsilon(a)},a.setSigma=function(a){g.setLJSigma(a)},a.getEpsilon=function(){return g.getLJEpsilon()},a.getSigma=function(){return g.getLJSigma()},a.getLJCalculator=function(){return g.getLJCalculator()},a.set_radius=function(a){},a.get_speed=function(){return arrays.copy(G,[])},a.get_rate=function(){return X()},a.set_temperature_control=function(a){e=a,w&&w.useThermostat(a)},a.set_lennard_jones_forces=function(a){f=a,w&&w.useLennardJonesInteraction(a)},a.set_coulomb_forces=function(a){h=a,w&&w.useCoulombInteraction(a)},a.get_nodes=function(){return M},a.get_atoms=function(){return b},a.initialize=function(b){return b=b||{},b.temperature!=null&&(b.temperature=N(b.temperature)),f=b.lennard_jones_forces||!0,h=b.coulomb_forces||!1,e=b.temperature_control||!1,y=b.model_listener||!1,S(),o=!0,w=g.getIntegrator(b),x=w.getOutputState(),a},a.relax=function(){return a},a.on=function(b,d){return c.on(b,d),a},a.tickInPlace=function(){return c.tick({type:"tick"}),a},a.tick=function(b){arguments.length||(b=1);var c=-1;while(++c<b)R();return a},a.nodes=function(c){return c=c||{},c.temperature!=null&&(c.temperature=N(c.temperature)),g.createNodes(c),M=g.nodes,z=g.radius,A=g.px,B=g.py,C=g.x,D=g.y,E=g.vx,F=g.vy,G=g.speed,H=g.ax,I=g.ay,halfMass=g.halfMass,K=g.charge,b.length=M[0].length,a},a.start=function(){return a.initialize(),a.resume()},a.resume=function(){return k=!1,d3.timer(R),a},a.stop=function(){return k=!0,a},a.ke=function(){return x?x.KE:undefined},a.ave_ke=function(){return x?x.KE/M[0].length:undefined},a.pe=function(){return x?x.PE:undefined},a.ave_pe=function(){return x?x.PE/M[0].length:undefined},a.speed=function(){return O()},a.pressure=function(){return V()},a.temperature=function(b){return arguments.length?(Y(b),a):v},a.size=function(b){return arguments.length?(d=b,g.setSize(b),a):d},a}}();