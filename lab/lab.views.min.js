(function(){function u(){var e=+s.value;s.type==="range"&&(o.innerText=d3.format("4.1f")(e)+" K"),model.set({temperature:e})}typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),views={version:"0.0.1"},layout.appletContainer=function(e,t){function x(e,t){return arguments.length?(s=t,i=e):(s=n.property("clientHeight"),i=n.property("clientWidth")),o&&(a=+o.runMwScript("mw2d:1:get %width"),f=+o.runMwScript("mw2d:1:get %height"),l=a/f,s=i*1/l*1.25),r.style.width=i+"px",r.style.height=s+"px",p=layout.screen_factor,layout.screen_factor_width&&layout.screen_factor_height&&(p=Math.min(layout.screen_factor_width,layout.screen_factor_height)),p=i/600,d={top:5,right:5,bottom:5,left:5},h=s-d.top-d.bottom,c=i-d.left-d.right,v={width:c,height:h},[i,s]}function T(){function e(){var e,n,r;r=['<applet id="'+t.appletID+'", codebase="'+t.codebase+'", code="'+t.code+'"','     width="'+t.width+'" height="'+t.height+'" MAYSCRIPT="true"','     archive="'+t.archive+'">','     MAYSCRIPT="true">'];for(e=0;e<t.params.length;e++)n=t.params[e],r.push('  <param name="'+n[0]+'" value="'+n[1]+'"/>');return r.push('  <param name="MAYSCRIPT" value="true"/>'),r.push("  Your browser is completely ignoring the applet tag!"),r.push("</applet>"),r.join("\n")}o===undefined?(u=e(),r.innerHTML=u,o=document.getElementById(t.appletID)):(o.style.width=v.width,o.style.height=v.height,o.width=v.width,o.height=v.height),T.node=r,T.scale=x,T.applet=o}var n=d3.select(e),r=n.node(),i=n.property("clientWidth"),s=n.property("clientHeight"),o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E={appletID:"mw-applet",codebase:"/jnlp",code:"org.concord.modeler.MwApplet",width:"100%",height:"100%",archive:"org/concord/modeler/unsigned/mw.jar",align:"left",hspace:"5",vspace:"5",params:[["script","page:0:import /imports/legacy-mw-content/potential-tests/two-atoms-two-elements/two-atoms-two-elements.cml"]]};if(t)for(var S in E)t[S]===undefined&&(t[S]=E[S]);else t=E;return x(i,s),T.resize=function(e,t){T.scale(e,t)},r&&T(),T},typeof layout=="undefined"&&(layout={}),typeof Lab=="undefined"&&(Lab={}),Lab.moleculeContainer=layout.moleculeContainer=function(e,t){function dt(e){e&&(t=e);if(t)for(var n in pt)t[n]===undefined&&(t[n]=pt[n]);else t=pt;et=t.get_nodes,Z=et(),Y=t.get_num_atoms,G.length=Y(),it=t.get_obstacles,lt=t.get_radial_bonds,ct=t.get_vdw_pairs,tt=t.set_atom_properties,nt=t.is_stopped}function vt(e,f){var l=model.size(),c=l[0]/l[1];a=layout.screen_factor,d={top:t.title?40*layout.screen_factor:20,right:25,bottom:10,left:t.ylabel?60*layout.screen_factor:25},t.xlabel&&(d.bottom+=35*a),t.controlButtons?d.bottom+=40*a:d.bottom+=15*a,t.fit_to_parent?(i=500,o=i-d.left-d.right,u=o/c,s=u+d.top+d.bottom):arguments.length?(o=e,u=f,i=o+d.left+d.right,s=u+d.top+d.bottom,r.style.height=s+"px",r.style.width=i+"px"):(s=n.property("clientHeight"),u=s-d.top-d.bottom,o=u*c,i=o+d.left+d.right,r.style.width=i+"px"),v={width:o,height:u},z=r.offsetTop+d.top,U=r.offsetLeft+d.left;switch(t.controlButtons){case"play":O=d.left+(v.width-75*a)/2;break;case"play_reset":O=d.left+(v.width-140*a)/2;break;case"play_reset_step":O=d.left+(v.width-230*a)/2;break;default:O=d.left+(v.width-230*a)/2}return M=s-42*a,m=v.width,g=v.height,E=d3.scale.linear().domain([t.xmin,t.xmax]).range([0,m]),S=E.copy(),x=Math.NaN,T=d3.scale.linear().domain([t.ymax,t.ymin]).range([0,g]),k=d3.scale.linear().domain([t.ymin,t.ymax]).nice().range([0,g]).nice(),N=T.copy(),C=Math.NaN,L=null,[i,s]}function mt(){return D+_(model.getTime())+P}function gt(e){return Z[model.INDICES.ELEMENT][e]}function yt(e){return Z[model.INDICES.X][e]}function bt(e){return Z[model.INDICES.Y][e]}function wt(e,t,n,r,i){return tt(e,{x:t,y:n},r,i)}function Et(e,t){Z[model.INDICES.Y][e]=t}function St(e){return Z[model.INDICES.RADIUS][e]}function xt(e){return Z[model.INDICES.SPEED][e]}function Tt(e){return Z[model.INDICES.VX][e]}function Nt(e){return Z[model.INDICES.VY][e]}function Ct(e){return Z[model.INDICES.AX][e]}function kt(e){return Z[model.INDICES.AY][e]}function Lt(e){return Z[model.INDICES.CHARGE][e]}function At(e){return Z[model.INDICES.VISIBLE][e]}function Ot(e){return obstacles[model.OBSTACLE_INDICES.X][e]}function Mt(e){return obstacles[model.OBSTACLE_INDICES.Y][e]}function _t(e){return obstacles[model.OBSTACLE_INDICES.WIDTH][e]}function Dt(e){return obstacles[model.OBSTACLE_INDICES.HEIGHT][e]}function Pt(e){return"rgb("+obstacles[model.OBSTACLE_INDICES.COLOR_R][e]+","+obstacles[model.OBSTACLE_INDICES.COLOR_G][e]+","+obstacles[model.OBSTACLE_INDICES.COLOR_B][e]+")"}function Ht(e){return obstacles[model.OBSTACLE_INDICES.VISIBLE][e]}function Bt(e){return radialBonds[model.RADIAL_INDICES.ATOM1][e]}function jt(e){return radialBonds[model.RADIAL_INDICES.ATOM2][e]}function Ft(e){return radialBonds[model.RADIAL_INDICES.LENGTH][e]}function It(e){return radialBonds[model.RADIAL_INDICES.STRENGTH][e]}function qt(e){return vdwPairs[model.VDW_INDICES.ATOM1][e]}function Rt(e){return vdwPairs[model.VDW_INDICES.ATOM2][e]}function Ut(){return model.get("chargeShading")?!0:!1}function zt(){return model.get("showVDWLines")?!0:!1}function Wt(){function o(){d3.event&&d3.event.transform&&isNaN(x)&&isNaN(C)&&d3.event.transform(E,T);var e=E.tickFormat(10),n=T.tickFormat(10);if(t.xunits){var r=l.selectAll("g.x").data(E.ticks(10),String).attr("transform",y);r.select("text").text(e);var i=r.enter().insert("svg:g","a").attr("class","x").attr("transform",y);t.grid_lines&&i.append("svg:line").attr("stroke",w).attr("y1",0).attr("y2",v.height),i.append("svg:text").attr("y",v.height).attr("dy","1em").attr("text-anchor","middle").text(e),r.exit().remove()}if(t.xunits){var s=l.selectAll("g.y").data(T.ticks(10),String).attr("transform",b);s.select("text").text(n);var o=s.enter().insert("svg:g","a").attr("class","y").attr("transform",b).attr("background-fill","#FFEEB6");t.grid_lines&&o.append("svg:line").attr("stroke",w).attr("x1",0).attr("x2",v.width),o.append("svg:text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").text(n),t.modelTimeLabel&&p.text(mt()),s.exit().remove()}}function u(){B=l.append("g"),B.attr("class","VDWLines_container"),H=l.append("svg").attr("class","container").attr("top",0).attr("left",0).attr("width",v.width).attr("height",v.height).attr("viewBox","0 0 "+v.width+" "+v.height),m("neg-grad","#ffefff","#fdadad","#e95e5e",H),m("pos-grad","#dfffff","#9abeff","#767fbf",H),m("green-grad","#dfffef","#75a643","#2a7216",H),m("purple-grad","#EED3F0","#D941E0","#84198A",H),m("aqua-grad","#DCF5F4","#41E0D8","#12827C",H),m("orange-grad","#F0E6D1","#E0A21B","#AD7F1C",H),m("custom-grad","#FFFFFF","#f2f2f2","#A4A4A4",H),q=["green-grad","purple-grad","aqua-grad","orange-grad"],ht=["#538f2f","#aa2bb1","#2cb6af","#b3831c","#7781c2","#ee7171"]}function m(e,t,n,r,i){gradient=i.append("defs").append("radialGradient").attr("id",e).attr("cx","50%").attr("cy","47%").attr("r","53%").attr("fx","35%").attr("fy","30%"),gradient.append("stop").attr("stop-color",t).attr("offset","0%"),gradient.append("stop").attr("stop-color",n).attr("offset","40%"),gradient.append("stop").attr("stop-color",r).attr("offset","80%"),gradient.append("stop").attr("stop-color",n).attr("offset","100%")}function g(){var e=model.get("temperature_control");e?d3.select("#heat_bath").style("display",""):d3.select("#heat_bath").style("display","none")}function S(){l.selectAll("circle").data(G).attr("r",function(e,t){return E(St(t))})}function N(e){e.enter().append("circle").attr("class","draggable").attr("r",function(e,t){return E(St(t))}).attr("cx",function(e,t){return E(yt(t))}).attr("cy",function(e,t){return T(bt(t))}).style("fill",function(e,t){return At(t)?Ut()?Lt(t)>0?"url(#pos-grad)":Lt(t)<0?"url(#neg-grad)":(element=gt(t)%4,grad=q[element],"url(#custom-grad)"):(element=gt(t)%4,grad=q[element],"url('#"+grad+"')"):"#eeeeee"}).on("mousedown",ft).on("mouseout",Xt).call(d3.behavior.drag().on("dragstart",Kt).on("drag",Qt).on("dragend",Gt))}function L(e){e.enter().append("rect").attr("x",function(e,t){return E(Ot(t))}).attr("y",function(e,t){return T(Mt(t)+Dt(t))}).attr("width",function(e,t){return E(_t(t))}).attr("height",function(e,t){return k(Dt(t))}).style("fill",function(e,t){return Ht(t)?Pt(t):"rgba(128,128,128, 0)"}).style("stroke-width",function(e,t){return Ht(t)?.2:0}).style("stroke","black")}function _(e){e.enter().append("line").attr("x1",function(e,t){return E(yt(Bt(t)))}).attr("y1",function(e,t){return T(bt(Bt(t)))}).attr("x2",function(e,t){return(E(yt(Bt(t)))+E(yt(jt(t))))/2}).attr("y2",function(e,t){return(T(bt(Bt(t)))+T(bt(jt(t))))/2}).attr("class","radialbond").style("stroke-width",function(e,t){return E(St(Bt(t)))*.75}).style("stroke",function(e,t){return Math.ceil(Ft(t)>.3)&&It(t)<2e3?"#000000":Ut()?Lt(Bt(t))>0?ht[4]:Lt(Bt(t))<0?ht[5]:"#A4A4A4":(element=gt(Bt(t))%4,grad=ht[element],grad)}).style("stroke-dasharray",function(e,t){return Math.ceil(Ft(t)>.3)&&It(t)<2e3?"5 5":""}),e.enter().append("line").attr("x2",function(e,t){return(E(yt(Bt(t)))+E(yt(jt(t))))/2}).attr("y2",function(e,t){return(T(bt(Bt(t)))+T(bt(jt(t))))/2}).attr("x1",function(e,t){return E(yt(jt(t)))}).attr("y1",function(e,t){return T(bt(jt(t)))}).attr("class","radialbond1").style("stroke-width",function(e,t){return E(St(jt(t)))*.75}).style("stroke",function(e,t){return Math.ceil(Ft(t)>.3)&&It(t)<2e3?"#000000":Ut()?Lt(jt(t))>0?ht[4]:Lt(jt(t))<0?ht[5]:"#A4A4A4":(element=gt(jt(t))%4,grad=ht[element],grad)}).style("stroke-dasharray",function(e,t){return Math.ceil(Ft(t)>.3)&&It(t)<2e3?"5 5":""})}function D(){var e=ut.length,t,n;for(var r=0;r<e;r++)t=qt(r),n=Rt(r),(t!=0||n!=0)&&B.append("line").attr("class","attractionforce").attr("x1",E(yt(t))).attr("y1",T(bt(t))).attr("x2",E(yt(n))).attr("y2",T(bt(n)))}function P(){F(),zt&&$(),I(),j()}function j(){et=t.get_nodes,Z=et(),Y=t.get_num_atoms,G.length=Y();var e=model.getLJCalculator()[0][0].coefficients();H.selectAll("circle").remove(),H.selectAll("g").remove(),W=H.selectAll("circle").data(G),N(W);var n=E(e.rmin*.5*1.5);model.get("mol_number")>100&&(n*=.9),X=H.selectAll("g.label").data(G),V=X.enter().append("g").attr("class","label").attr("transform",function(e,t){return"translate("+E(yt(t))+","+T(bt(t))+")"}),t.atom_mubers?V.append("text").attr("class","index").attr("font-size",n).attr("style","font-weight: bold; opacity: .7").attr("x",0).attr("y","0.31em").attr("pointer-events","none").text(function(e){return e.index}):V.append("text").attr("class","index").attr("font-size",n).attr("style","font-weight: bold; opacity: .7").attr("x","-0.31em").attr("y","0.31em").attr("pointer-events","none").text(function(e,t){if(Ut()){if(Lt(t)>0)return"+";if(Lt(t)<0)return"-";return}})}function F(){H.selectAll("rect").remove(),obstacles=it();if(!obstacles)return;st.length=obstacles[0].length,rt=H.selectAll("rect").data(st),L(rt)}function I(){H.selectAll("line.radialbond").remove(),H.selectAll("line.radialbond1").remove(),radialBonds=lt();if(!radialBonds)return;ot.length=radialBonds[0].length,at=H.selectAll("line.radialbond").data(ot),_(at)}function $(){B.selectAll("line.attractionforce").remove(),vdwPairs=ct();if(!vdwPairs)return;ut.length=vdwPairs[0].length,D()}function J(){r.focus()}function tt(e){}function ft(e,n){r.focus(),t.enableAtomTooltips&&(R!==!1?(K.style("opacity",1e-6),K.style("display","none"),R=!1):(d3.event.shiftKey?R=n:R=!1,pt(n)))}function pt(e){K.style("opacity",1).style("display","inline").style("background","rgba(100%, 100%, 100%, 0.7)").style("left",E(Z[model.INDICES.X][e])+U+16+"px").style("top",T(Z[model.INDICES.Y][e])+z-30+"px").style("zIndex",100).transition().duration(250),Q.text("atom: "+e+"\n"+"time: "+mt()+"\n"+"speed: "+d3.format("+6.3e")(xt(e))+"\n"+"vx:    "+d3.format("+6.3e")(Tt(e))+"\n"+"vy:    "+d3.format("+6.3e")(Nt(e))+"\n"+"ax:    "+d3.format("+6.3e")(Ct(e))+"\n"+"ay:    "+d3.format("+6.3e")(kt(e))+"\n")}function Et(e){}function Xt(){R===!1&&K.style("opacity",1e-6).style(NaN)}function Vt(){F(),zt&&$(),Jt(),$t()}function $t(){var e=H.selectAll("circle")[0].length;G.length=Y(),Z=et(),t.modelTimeLabel&&p.text(mt()),X=n.selectAll("g.label").data(G),X.attr("transform",function(e,t){return"translate("+E(yt(t))+","+T(bt(t))+")"}),W=H.selectAll("circle").data(G),G.length!==e&&N(W),W.attr("cx",function(e,t){return E(Z[model.INDICES.X][t])}).attr("cy",function(e,t){return T(Z[model.INDICES.Y][t])}).attr("r",function(e,t){return E(Z[model.INDICES.RADIUS][t])}),(R===0||R>0)&&pt(R)}function Jt(){H.selectAll("line.radialbond").attr("x1",function(e,t){return E(yt(Bt(t)))}).attr("y1",function(e,t){return T(bt(Bt(t)))}).attr("x2",function(e,t){return(E(yt(Bt(t)))+E(yt(jt(t))))/2}).attr("y2",function(e,t){return(T(bt(Bt(t)))+T(bt(jt(t))))/2}),H.selectAll("line.radialbond1").attr("x2",function(e,t){return(E(yt(Bt(t)))+E(yt(jt(t))))/2}).attr("y2",function(e,t){return(T(bt(Bt(t)))+T(bt(jt(t))))/2}).attr("x1",function(e,t){return E(yt(jt(t)))}).attr("y1",function(e,t){return T(bt(jt(t)))})}function Kt(e,t){nt()?A=[yt(t),bt(t)]:model.addSpringForce(t,yt(t),bt(t),20)}function Qt(e,t){if(!nt()){var n=E.invert(d3.event.x),r=T.invert(d3.event.y);model.updateSpringForce(0,n,r);return}var i=d3.select(this),s,o;i.attr("cx",function(){return d3.event.x}).attr("cy",function(){return d3.event.y}),K.style("left",E(Z[model.INDICES.X][t])+U+16+"px").style("top",T(Z[model.INDICES.Y][t])+z-30+"px"),s=E.invert(i.attr("cx")),o=T.invert(i.attr("cy")),wt(t,s,o,!1,!0),Vt()}function Gt(e,t){if(!nt()){model.removeSpringForce(0);return}var n=d3.select(this),r,i;r=E.invert(n.attr("cx")),i=T.invert(n.attr("cy")),wt(t,r,i,!0,!0)||(alert("You can't drop the atom there"),wt(t,A[0],A[1],!1,!0)),Vt()}function Yt(e){e=e?e:window.event?event:null;if(e)switch(e.keyCode){case 32:model.is_stopped()?h.action("play"):h.action("stop"),e.preventDefault();break;case 13:h.action("play"),e.preventDefault()}}function Zt(){r.onkeydown=Yt}vt(),l===undefined?(t.fit_to_parent?(n=d3.select(e).append("div").attr("class","positioning-container").append("div").attr("class","molecules-view-aspect-container").attr("style","padding-top: "+Math.round(s/i*100)+"%").append("div").attr("class","molecules-view-svg-container"),r=n.node(),f=d3.select(r).append("svg").attr("viewBox","0 0 "+i+" "+s).attr("preserveAspectRatio","xMinYMin meet")):f=d3.select(r).append("svg").attr("width",i).attr("height",s),l=f.append("g").attr("transform","translate("+d.left+","+d.top+")"),c=l.append("rect").attr("class","plot").attr("width",v.width).attr("height",v.height).style("fill","#EEEEEE"),t.title&&l.append("text").attr("class","title").text(t.title).attr("x",v.width/2).attr("dy","-1em").style("text-anchor","middle"),t.xlabel&&l.append("text").attr("class","xlabel").text(t.xlabel).attr("x",v.width/2).attr("y",v.height).attr("dy","2.4em").style("text-anchor","middle"),t.ylabel&&l.append("g").append("text").attr("class","ylabel").text(t.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+v.height/2+") rotate(-90)"),t.modelTimeLabel&&(p=l.append("text").attr("class","modelTimeLabel").text(mt()).attr("x",10).attr("y",v.height-35).attr("dy","2.4em").style("text-anchor","start")),l.append("image").attr("x",5).attr("id","heat_bath").attr("y",5).attr("width","3%").attr("height","3%").attr("xlink:href","../../resources/heatbath.gif"),model.addPropertiesListener(["temperature_control"],g),g(),K=d3.select("#viz").append("div").attr("class","tooltip").style("opacity",1e-6),Q=K.append("pre"),d3.select(r).attr("tabindex",0).on("mousedown",J),Zt(),o(),u()):(t.fit_to_parent||d3.select(r).select("svg").attr("width",i).attr("height",s),l.select("svg").attr("width",i).attr("height",s),l.select("rect.plot").attr("width",v.width).attr("height",v.height).style("fill","#EEEEEE"),l.select("svg.container").attr("top",0).attr("left",0).attr("width",v.width).attr("height",v.height).attr("viewBox","0 0 "+v.width+" "+v.height),t.title&&l.select("text.title").attr("x",v.width/2).attr("dy","-1em"),t.xlabel&&l.select("text.xlabel").attr("x",v.width/2).attr("y",v.height),t.ylabel&&l.select("text.ylabel").attr("transform","translate(-40 "+v.height/2+") rotate(-90)"),t.modelTimeLabel&&p.text(mt()).attr("x",10).attr("y",v.height-35),l.selectAll("g.x").remove(),l.selectAll("g.y").remove(),W&&(S(),W.attr("cx",function(e,t){return E(yt(t))}).attr("cy",function(e,t){return T(bt(t))}).attr("r",function(e,t){return E(St(t))}),X.attr("transform",function(e,t){return"translate("+E(yt(t))+","+T(bt(t))+")"})),rt&&rt.attr("x",function(e,t){return E(Ot(t))}).attr("y",function(e,t){return T(Mt(t)+Dt(t))}).attr("width",function(e,t){return E(_t(t))}).attr("height",function(e,t){return k(Dt(t))}),!at,t.playback_controller&&h.position(O,M,a),o()),d3.select(".model-controller").remove();switch(t.controlButtons){case"play":h=new PlayOnlyComponentSVG(f,model_player,O,M,a);break;case"play_reset":h=new PlayResetComponentSVG(f,model_player,O,M,a);break;case"play_reset_step":h=new PlaybackComponentSVG(f,model_player,O,M,a);break;default:h=null}Wt.node=r,Wt.updateMoleculeRadius=S,Wt.setup_drawables=P,Wt.update_drawable_positions=Vt,Wt.scale=vt,Wt.playback_component=h,Wt.options=t,Wt.processOptions=dt}var n=d3.select(e),r=n.node(),i=n.property("clientWidth"),s=n.property("clientHeight"),o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_=d3.format("5.0f"),D="",P=" (fs)",H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G=[],Y,Z,et,tt,nt,rt,it,st=[],ot=[],ut=[],at,ft,lt,ct,ht,pt={fit_to_parent:!1,title:!1,xlabel:!1,ylabel:!1,controlButtons:"play",modelTimeLabel:!1,grid_lines:!1,xunits:!1,yunits:!1,atom_mubers:!1,enableAtomTooltips:!1,xmin:0,xmax:10,ymin:0,ymax:10};return dt(),t.fit_to_parent||vt(i,s),y=function(e,t){return"translate("+E(e)+",0)"},b=function(e,t){return"translate(0,"+T(e)+")"},w=function(e,t){return e?"#ccc":"#666"},Wt.resize=function(e,n){t.fit_to_parent||Wt.scale(e,n),Wt(),Wt.setup_drawables()},Wt.reset=function(e){Wt.processOptions(e),Wt(),Wt.setup_drawables(),Wt.updateMoleculeRadius()},r&&Wt(),Wt},layout.potentialChart=function(e,t,n){function A(){var e,n,r,i,s,o;T=t.getLJCalculator()[0][0],N.coefficients=T.coefficients(),e=N.coefficients.sigma,n=N.coefficients.epsilon,r=N.coefficients.rmin,N.xmax=e*3,N.xmin=Math.floor(e/2),N.ymax=.4,N.ymin=Math.ceil(n*1)-1,N.variables[0].x=r,N.variables[0].y=n,N.variables[1].x=e,N.variables[1].y=0,C.length=0;for(s=e*.5;s<N.xmax*3;s+=.001)i=-T.potential(s,0,0),Math.abs(i)<100&&C.push([s,i])}function O(e,t){s=e,o=t,i.style.width=s+"px",i.style.height=o+"px",u={top:n.title?40:20,right:35,bottom:n.xlabel?56:30,left:n.ylabel?60:25},width=s-u.left-u.right,height=o-u.top-u.bottom,a={width:width,height:height},f=a.width,l=a.height,d=d3.scale.linear().domain([N.xmin,N.xmax]).range([0,f]),m=d3.scale.linear().domain([N.ymax,N.ymin]).range([0,l]),v=Math.NaN,g=Math.NaN,b=null}function M(){function e(){d3.event&&d3.event.transform&&isNaN(v)&&isNaN(g)&&d3.event.transform(x,y);var t=d.tickFormat(5),n=m.tickFormat(5),r=E.selectAll("g.x").data(d.ticks(5),String).attr("transform",c);r.select("text").text(t);var i=r.enter().insert("g","a").attr("class","x").attr("transform",c);i.append("line").attr("stroke",p).attr("y1",0).attr("y2",a.height),i.append("text").attr("y",a.height).attr("dy","1em").attr("text-anchor","middle").style("cursor","ew-resize").text(t).on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown",function(e){var t=d3.svg.mouse(E[0][0]);v=d.invert(t[0])}),r.exit().remove();var s=E.selectAll("g.y").data(m.ticks(10),String).attr("transform",h);s.select("text").text(n);var o=s.enter().insert("g","a").attr("class","y").attr("transform",h).attr("background-fill","#FFEEB6");o.append("line").attr("stroke",p).attr("x1",0).attr("x2",a.width),o.append("text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(n).on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown",function(e){var t=d3.svg.mouse(E[0][0]);g=m.invert(t[1])}),s.exit().remove(),S.call(d3.behavior.zoom().x(d).y(m).scaleExtent([1,8]).on("zoom",e)),f()}function f(){var e=E.selectAll("circle").data(N.variables,function(e){return e}),t=E.select("path").attr("d",line(C)),n=d.domain()[1]-d.domain()[0];e.enter().append("circle").attr("class",function(e){return e===w?"selected":null}).attr("cx",function(e){return d(e.x)}).attr("cy",function(e){return m(e.y)}).style("cursor",function(e){return e.cursorStyle}).attr("r",8).on("mousedown",function(e){e.coefficient=="epsilon"?e.x=N.coefficients.rmin:e.y=0,coefficient_selected=w=e,f()}),e.attr("class",function(e){return e===coefficient_selected?"selected":null}).attr("cx",function(e){return d(e.x)}).attr("cy",function(e){return m(e.y)}),e.exit().remove(),d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function l(){r.style("cursor","move")}function b(){var r=d3.svg.mouse(E[0][0]),s,o,u,l=d3.event.changedTouches;if(w){i.onselectstart=function(){return!1};var c=d3.svg.mouse(E.node()),h,p;w.coefficient=="epsilon"?(h=N.coefficients.rmin,p=m.invert(Math.max(0,Math.min(a.height,c[1]))),p>n.epsilon_max&&(p=n.epsilon_max),p<n.epsilon_min&&(p=n.epsilon_min),t.set({epsilon:p})):(p=0,h=d.invert(Math.max(0,Math.min(a.width,c[0]))),h<n.sigma_min&&(h=n.sigma_min),h>n.sigma_max&&(h=n.sigma_max),t.set({sigma:h})),w.x=h,w.y=p,f()}isNaN(v)||(d3.select("body").style("cursor","ew-resize"),d.domain(grapher.axis.axisProcessDrag(v,d.invert(r[0]),d.domain())),e(),d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(g)||(d3.select("body").style("cursor","ns-resize"),m.domain(grapher.axis.axisProcessDrag(g,m.invert(r[1]),m.domain())),e(),d3.event.preventDefault(),d3.event.stopPropagation())}function T(){isNaN(v)||(i.onselectstart=function(){return!0},e(),v=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(g)||(e(),g=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),w=null}O(s,o),E===undefined?(E=d3.select(i).append("svg").attr("width",s).attr("height",o).append("svg:g").attr("transform","translate("+u.left+","+u.top+")"),S=E.append("rect").attr("class","plot").attr("width",a.width).attr("height",a.height).style("fill","#EEEEEE").attr("pointer-events","all"),S.call(d3.behavior.zoom().x(d).y(m).scaleExtent([1,8]).on("zoom",e)),E.append("svg").attr("class","linebox").attr("top",0).attr("left",0).attr("width",a.width).attr("height",a.height).attr("viewBox","0 0 "+a.width+" "+a.height).append("path").attr("class","line").attr("d",line(C)),n.title&&E.append("text").attr("class","title").text(n.title).attr("x",a.width/2).attr("dy","-1em").style("text-anchor","middle"),n.xlabel&&E.append("text").attr("class","xlabel").text(n.xlabel).attr("x",a.width/2).attr("y",a.height).attr("dy","2.4em").style("text-anchor","middle"),n.ylabel&&E.append("g").append("text").attr("class","ylabel").text(n.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+a.height/2+") rotate(-90)"),E.on("mousemove",b).on("mouseup",T),e()):(d3.select(i).select("svg").attr("width",s).attr("height",o),E.select("svg").attr("width",s).attr("height",o),E.select("rect.plot").attr("width",a.width).attr("height",a.height).style("fill","#EEEEEE"),E.select("svg.container").attr("top",0).attr("left",0).attr("width",a.width).attr("height",a.height).attr("viewBox","0 0 "+a.width+" "+a.height),E.select("svg.linebox").attr("top",0).attr("left",0).attr("width",a.width).attr("height",a.height).attr("viewBox","0 0 "+a.width+" "+a.height),n.title&&E.select("text.title").attr("x",a.width/2).attr("dy","-1em"),n.xlabel&&E.select("text.xlabel").attr("x",a.width/2).attr("y",a.height),n.ylabel&&E.select("text.ylabel").attr("transform","translate(-40 "+a.height/2+") rotate(-90)"),E.selectAll("g.x").remove(),E.selectAll("g.y").remove(),d3.select(this).on("mousemove.drag",b).on("touchmove.drag",b).on("mouseup.drag",T).on("touchend.drag",T),e()),r.on("mousemove",function(t){document.onselectstart=function(){return!0};var n=d3.svg.mouse(E[0][0]);isNaN(v)||(d.domain(grapher.axis.axisProcessDrag(v,d.invert(n[0]),d.domain())),e(),d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(g)||(m.domain(grapher.axis.axisProcessDrag(g,m.invert(n[0]),m.domain())),e(),d3.event.preventDefault(),d3.event.stopPropagation())}).on("mouseup",function(t){document.onselectstart=function(){return!0},isNaN(v)||(e(),v=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(g)||(e(),g=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation())}),M.node=i,M.scale=O,M.updateLJData=A,M.update=f,M.redraw=e}var r=d3.select(e),i=r.node(),s=r.property("clientWidth"),o=r.property("clientHeight"),u,a,f,l,c,h,p,d=d3.scale.linear(),v,m=d3.scale.linear(),g,b,w,E,S,T,N={},C=[],k={title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy"};if(n)for(var L in k)n[L]===undefined&&(n[L]=k[L]);else n=k;return N.variables=[],N.variables[0]={coefficient:"epsilon",cursorStyle:"ns-resize"},N.variables[1]={coefficient:"sigma",cursorStyle:"ew-resize"},A(),w=!1,coefficient_selected=N.variables[0],O(s,o),c=function(e,t){return"translate("+d(e)+",0)"},h=function(e,t){return"translate(0,"+m(e)+")"},p=function(e,t){return Math.abs(e)>1e-4?"#ccc":"#666"},line=d3.svg.line().x(function(e,t){return d(C[t][0])}).y(function(e,t){return m(C[t][1])}),M.resize=function(e,t){M.scale(e,t),M()},M.ljUpdate=function(){M.updateLJData(),M.redraw()},i&&M(),M},layout.speedDistributionChart=function(e,t){function H(){O=model.get_speed(),t.xmax=d3.max(O),t.xmin=d3.min(O),t.quantile=d3.quantile(O,.1),T=t.ymax,p=d3.scale.linear().domain([t.xmin,t.xmax]).range([0,a]),m=d3.scale.linear().domain([t.ymax,t.ymin]).nice().range([0,f])}function B(){if(O.length>2){try{_=d3.layout.histogram().frequency(!1).bins(p.ticks(60))(O)}catch(e){return}w=(u.width-_.length)/_.length,S=(t.xmax-t.xmin)/_.length,N=d3.max(_,function(e){return e.y})}}function j(e,n){i=e,s=n,r.style.width=i+"px",r.style.height=s+"px",o={top:t.title?40:20,right:35,bottom:t.xlabel?56:30,left:t.ylabel?60:25},width=i-o.left-o.right,height=s-o.top-o.bottom,u={width:width,height:height},a=u.width,f=u.height,p=d3.scale.linear().domain([t.xmin,t.xmax]).range([0,a]),m=d3.scale.linear().domain([t.ymax,t.ymin]).nice().range([0,f]).nice(),H(),B()}function F(){function e(){d3.event&&d3.event.transform&&isNaN(v)&&isNaN(b)&&d3.event.transform(x,y);var e=m.tickFormat(10),t=C.selectAll("g.y").data(m.ticks(5),String).attr("transform",c);t.select("text").text(e);var r=t.enter().insert("g","a").attr("class","y").attr("transform",c).attr("background-fill","#FFEEB6");r.append("line").attr("stroke",h).attr("x1",0).attr("x2",u.width),r.append("text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(e).on("mouseover",function(e){d3.select(this).style("font-weight","bold")}).on("mouseout",function(e){d3.select(this).style("font-weight","normal")}).on("mousedown",function(e){var t=d3.svg.mouse(C[0][0]);b=y.invert(t[1])}),t.exit().remove(),n()}function n(){H();if(O.length>2){kde=science.stats.kde().sample(O),p.domain([t.xmin,t.xmax]);try{_=d3.layout.histogram().frequency(!0).bins(p.ticks(60))(O)}catch(e){return}w=(u.width-_.length)/_.length,S=(t.xmax-t.xmin)/_.length,N=d3.max(_,function(e){return e.y}),C.selectAll("g.bar").remove(),L=C.selectAll("g.bar").data(_),L.enter().append("g").attr("class","bar").attr("transform",function(e,t){return"translate("+p(e.x)+","+(f-m(T-e.y))+")"}).append("rect").attr("class","bar").attr("fill","steelblue").attr("width",w).attr("height",function(e){return m(T-e.y)})}}j(i,s),C===undefined?(C=d3.select(r).append("svg").attr("width",i).attr("height",s).append("g").attr("transform","translate("+o.left+","+o.top+")"),k=C.append("rect").attr("class","plot").attr("width",u.width).attr("height",u.height).style("fill","#EEEEEE"),t.title&&C.append("text").attr("class","title").text(t.title).attr("x",u.width/2).attr("dy","-1em").style("text-anchor","middle"),t.xlabel&&C.append("text").attr("class","xlabel").text(t.xlabel).attr("x",u.width/2).attr("y",u.height).attr("dy","2.4em").style("text-anchor","middle"),t.ylabel&&C.append("g").append("text").attr("class","ylabel").text(t.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+u.height/2+") rotate(-90)"),e()):(d3.select(r).select("svg").attr("width",i).attr("height",s),C.select("rect.plot").attr("width",u.width).attr("height",u.height).style("fill","#EEEEEE"),t.title&&C.select("text.title").attr("x",u.width/2).attr("dy","-1em"),t.xlabel&&C.select("text.xlabel").attr("x",u.width/2).attr("y",u.height),t.ylabel&&C.select("text.ylabel").attr("transform","translate(-40 "+u.height/2+") rotate(-90)"),C.selectAll("g.x").remove(),C.selectAll("g.y").remove(),e()),F.node=r,F.scale=j,F.update=n,F.redraw=e}var n=d3.select(e),r=n.node(),i=n.property("clientWidth"),s=n.property("clientHeight"),o,u,a,f,l,c,h,p,d,v,m,g,b,w,E,S,T,N,C,k,L,A,O,M,_,D={title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01};if(t)for(var P in D)t[P]===undefined&&(t[P]=D[P]);else t=D;return j(i,s),l=function(e,t){return"translate("+p(e)+",0)"},c=function(e,t){return"translate(0,"+m(e)+")"},h=function(e,t){return e?"#ccc":"#666"},F.resize=function(e,t){F.scale(e,t),F()},r&&F(),F};var e=document.getElementById("start-benchmarks"),t=document.getElementById("benchmarks-table"),n=[{name:"molecules",run:function(){return model.get_num_atoms()}},{name:"temperature",run:function(){return model.get("temperature")}},{name:"100 Steps (steps/s)",run:function(){controller.modelStop();var e=+Date.now(),t=-1;while(t++<100)model.tick(1,{dontDispatchTickEvent:!0});return elapsed=Date.now()-e,d3.format("5.1f")(100/elapsed*1e3)}},{name:"100 Steps w/graphics",run:function(){controller.modelStop();var e=+Date.now(),t=-1;while(t++<100)model.tick();return elapsed=Date.now()-e,d3.format("5.1f")(100/elapsed*1e3)}}];e&&(e.onclick=function(){benchmark.run(t,n)}),layout.datatable_visible=!1;var r=document.getElementById("toggle-datatable"),i=document.getElementById("datatable-table");layout.hide_datatable=function(){i&&(i.style.display="none")},layout.render_datatable=function(e){function h(){return i.getElementsByTagName("tr").length==0}function p(e){e=e||"data";var t=i.appendChild(document.createElement("tr"));return t.className=e,t}function d(e,t,n,r){n=n||"td",r=r||1;var i=e.appendChild(document.createElement(n));i.textContent=t,r>1&&(i.colSpan=r)}function v(e,t,n){n=n||"td";var r;r=-1;while(++r<t.length)d(e,t[r])}function m(e,t,r){r=r||"td";var i=e.getElementsByTagName(r),s=0;if(i.length>0){i[0].textContent=t;while(++s<i.length)i[s].textContent=c[s](n[model.INDICES[u[s]]][t])}s--;while(++s<u.length)d(e,c[s](n[model.INDICES[u[s]]][t]))}function g(e,t){h()&&d(p("title"),e,"th"),d(results_row,t)}function y(e,t,n){n=n||1;var r;r=-1;while(++r<t.length)d(e,t[r],"th",n)}function b(e){var t=-1,n=o.length;while(++t<e)t>=o.length&&p();while(--n>=t)i.removeChild(o[t]);return i.getElementsByClassName("data")}function w(e,t){var n=-1;while(++n<t.length)d(e,t[n])}function E(e,t,n,r){var i;i=-1;while(++i<r.length)w(t[i],r[i])}i.style.display="";var t,n=model.get_nodes(),r=[],s=i.getElementsByClassName("title"),o=i.getElementsByClassName("data"),u=["PX","PY","X","Y","VX","VY","AX","AY","SPEED","CHARGE","RADIUS","ELEMENT"],a=d3.format(" 2d"),f=d3.format(" 1.1f"),l=d3.format(" 3.4f"),c=[l,l,l,l,l,l,l,l,l,f,l,a];r.length=n[0].length,e=e||!1;if(s.length==0){var S=p("title");y(S,u),o=b(r.length)}e&&(o=b(model.get_num_atoms())),t=-1;while(++t<r.length)m(o[t],t)},r&&(r.onclick=function(){layout.datatable_visible?(layout.datatable_visible=!1,r.textContent="Show Data Table",i.style.display="none"):(layout.datatable_visible=!0,r.textContent="Hide Data Table",layout.render_datatable(),i.style.display="")});var s=document.getElementById("select-temperature"),o=document.createElement("span");layout.setupTemperature=function(e){if(s){if(Modernizr.inputtypes.range){var t=document.createElement("input");t.type="range",t.min="0",t.max="5000",t.step="20",t.value=e.get("temperature"),s.parentNode.replaceChild(t,s),t.id="select-temperature",s=t,o.id="select-temperature-display",o.innerText=t.value+" K",s.parentNode.appendChild(o),s=document.getElementById("select-temperature")}s.onchange=u}},layout.temperature_control_checkbox=document.getElementById("temperature-control-checkbox"),layout.temperatureControlHandler=function(){layout.temperature_control_checkbox.checked?model.set({temperature_control:!0}):model.set({temperature_control:!1})},layout.temperatureControlUpdate=function(){var e=model.get("temperature_control");layout.temperature_control_checkbox.checked=e,s.disabled=!e,o.hidden=!e},layout.temperature_control_checkbox&&(layout
.temperature_control_checkbox.onchange=layout.temperatureControlHandler);var a=document.getElementById("stats");layout.displayStats=function(){var e=model.ke(),t=model.pe(),n=e+t;a&&(a.textContent="Time: "+d3.format("5.2f")(model.getTime()/1e3)+" (ps), "+"KE: "+d3.format("1.4f")(e)+", "+"PE: "+d3.format("1.4f")(t)+", "+"TE: "+d3.format("1.4f")(n)+", "+"Pressure: "+d3.format("6.3f")(model.pressure())+", "+"Rate: "+d3.format("5.1f")(model.get_rate())+" (steps/s)")},layout.heatCoolButtons=function(e,t,n,r,i,s){var o=new ButtonComponent(e,"circlesmall-plus"),u=new ButtonComponent(t,"circlesmall-minus");o.add_action(function(){var n=i.get("temperature");n<r?($(e).removeClass("inactive"),$(t).removeClass("inactive"),n=Math.floor(n*2)/2+100,i.set({temperature:n}),typeof s=="function"&&s(n)):$(e).addClass("inactive")}),u.add_action(function(){var r=i.get("temperature");r>n?($(e).removeClass("inactive"),$(t).removeClass("inactive"),r=Math.floor(r*2)/2-100,i.set({temperature:r}),typeof s=="function"&&s(r)):$(t).addClass("inactive")})}})();